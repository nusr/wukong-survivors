{"version":3,"file":"index-DQDxBYHn.js","sources":["../../src/constant/characters.ts","../../src/constant/enemies.ts","../../src/constant/rewards.ts","../../src/components/Language/index.tsx","../../src/components/Toast/index.tsx","../../src/util/fullScreen.ts","../../src/util/index.ts","../../src/constant/map.ts","../../src/constant/index.ts","../../src/store/app.ts","../../src/store/save.ts","../../src/store/setting.ts","../../src/i18n.ts","../../src/pages/CharacterSelect/index.tsx","../../src/pages/MapSelect/index.tsx","../../src/pages/Shop/index.tsx","../../src/game/ScaleManager.ts","../../src/game/player.ts","../../src/game/enemy.ts","../../src/game/weapon.ts","../../src/game/experience.ts","../../src/game/AudioManager.ts","../../src/game/VirtualJoystick.ts","../../src/game/RewardSelectionUI.ts","../../src/game/eventBus.ts","../../src/game/GameScene.ts","../../src/pages/Game/index.tsx","../../src/pages/Home/index.tsx","../../src/pages/Settings/index.tsx","../../src/pages/Stats/index.tsx","../../src/pages/Wiki/index.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["import type { CharacterData, CharacterType, CharacterRankType } from \"../types\";\n\n// Wukong character configuration (organized by chapter)\nexport const CHARACTERS_DATA: Record<CharacterType, CharacterData> = {\n  // ===== Protagonist =====\n  destined_one: {\n    id: \"destined_one\",\n    name: \"天命人\",\n    rank: \"hero\",\n    unlockCondition: { type: \"default\", value: 0 },\n    stats: {\n      baseHealth: 100,\n      baseSpeed: 150,\n      baseDamage: 10,\n      baseArmor: 5,\n      baseLuck: 5,\n    },\n    startingWeapon: \"golden_staff\",\n    color: \"#FFD700\",\n  },\n\n  // ===== Journey to the West Party =====\n  tang_monk: {\n    id: \"tang_monk\",\n    name: \"唐僧\",\n    rank: \"hero\",\n\n    unlockCondition: { type: \"default\", value: 0 },\n    stats: {\n      baseHealth: 80,\n      baseSpeed: 130,\n      baseDamage: 8,\n      baseArmor: 3,\n      baseLuck: 20,\n    },\n    startingWeapon: \"nine_ring_staff\",\n    color: \"#FFA500\",\n  },\n\n  sha_monk: {\n    id: \"sha_monk\",\n    name: \"沙僧\",\n    rank: \"hero\",\n\n    unlockCondition: { type: \"default\", value: 0 },\n    stats: {\n      baseHealth: 140,\n      baseSpeed: 135,\n      baseDamage: 14,\n      baseArmor: 10,\n      baseLuck: 8,\n    },\n    startingWeapon: \"crescent_blade\",\n    color: \"#8B4513\",\n  },\n\n  zhu_bajie: {\n    id: \"zhu_bajie\",\n    name: \"猪八戒\",\n    rank: \"hero\",\n\n    unlockCondition: { type: \"default\", value: 0 },\n    stats: {\n      baseHealth: 160,\n      baseSpeed: 125,\n      baseDamage: 16,\n      baseArmor: 12,\n      baseLuck: 6,\n    },\n    startingWeapon: \"nine_tooth_rake\",\n    color: \"#FF69B4\",\n  },\n\n  white_dragon_horse: {\n    id: \"white_dragon_horse\",\n    name: \"白龙马\",\n    rank: \"hero\",\n\n    unlockCondition: { type: \"default\", value: 0 },\n    stats: {\n      baseHealth: 110,\n      baseSpeed: 180,\n      baseDamage: 12,\n      baseArmor: 6,\n      baseLuck: 12,\n    },\n    startingWeapon: \"dragon_scale_sword\",\n    color: \"#FFFFFF\",\n  },\n\n  // ===== Chapter 1 - Black Wind Mountain =====\n  black_bear_guai: {\n    id: \"black_bear_guai\",\n    name: \"黑熊精\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 1 },\n    stats: {\n      baseHealth: 150,\n      baseSpeed: 120,\n      baseDamage: 15,\n      baseArmor: 12,\n      baseLuck: 3,\n    },\n    startingWeapon: \"mace\",\n    color: \"#1a1a1a\",\n  },\n\n  lingxuzi: {\n    id: \"lingxuzi\",\n    name: \"灵虚子\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 1 },\n    stats: {\n      baseHealth: 110,\n      baseSpeed: 140,\n      baseDamage: 12,\n      baseArmor: 7,\n      baseLuck: 8,\n    },\n    startingWeapon: \"golden_rope\",\n    color: \"#87CEEB\",\n  },\n\n  wandering_wight: {\n    id: \"wandering_wight\",\n    name: \"赤发鬼\",\n    rank: \"boss\",\n\n    unlockCondition: { type: \"chapter\", value: 1 },\n    stats: {\n      baseHealth: 200,\n      baseSpeed: 110,\n      baseDamage: 25,\n      baseArmor: 10,\n      baseLuck: 5,\n    },\n    startingWeapon: \"fire_lance\",\n    color: \"#8B0000\",\n  },\n\n  // ===== Chapter 2 - Yellow Wind Ridge =====\n  yellow_wind_sage: {\n    id: \"yellow_wind_sage\",\n    name: \"黄风大王\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 2 },\n    stats: {\n      baseHealth: 90,\n      baseSpeed: 140,\n      baseDamage: 20,\n      baseArmor: 5,\n      baseLuck: 10,\n    },\n    startingWeapon: \"wind_tamer\",\n    color: \"#DAA520\",\n  },\n\n  tiger_vanguard: {\n    id: \"tiger_vanguard\",\n    name: \"虎先锋\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 2 },\n    stats: {\n      baseHealth: 120,\n      baseSpeed: 160,\n      baseDamage: 18,\n      baseArmor: 8,\n      baseLuck: 5,\n    },\n    startingWeapon: \"twin_blades\",\n    color: \"#FF8C00\",\n  },\n\n  stone_vanguard: {\n    id: \"stone_vanguard\",\n    name: \"石先锋\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 2 },\n    stats: {\n      baseHealth: 140,\n      baseSpeed: 100,\n      baseDamage: 16,\n      baseArmor: 15,\n      baseLuck: 2,\n    },\n    startingWeapon: \"thunder_drum\",\n    color: \"#808080\",\n  },\n\n  king_of_flowing_sand: {\n    id: \"king_of_flowing_sand\",\n    name: \"沙大王\",\n    rank: \"boss\",\n\n    unlockCondition: { type: \"chapter\", value: 2 },\n    stats: {\n      baseHealth: 220,\n      baseSpeed: 115,\n      baseDamage: 28,\n      baseArmor: 12,\n      baseLuck: 6,\n    },\n    startingWeapon: \"mace\",\n    color: \"#CD853F\",\n  },\n\n  // ===== Chapter 3 - Little Western Heaven =====\n  yellow_brow_king: {\n    id: \"yellow_brow_king\",\n    name: \"黄眉大王\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 3 },\n    stats: {\n      baseHealth: 110,\n      baseSpeed: 145,\n      baseDamage: 22,\n      baseArmor: 10,\n      baseLuck: 12,\n    },\n    startingWeapon: \"violet_bell\",\n    color: \"#F4A460\",\n  },\n\n  hundred_eyed: {\n    id: \"hundred_eyed\",\n    name: \"百眼魔君\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 3 },\n    stats: {\n      baseHealth: 80,\n      baseSpeed: 130,\n      baseDamage: 25,\n      baseArmor: 3,\n      baseLuck: 20,\n    },\n    startingWeapon: \"ice_needle\",\n    color: \"#9370DB\",\n  },\n\n  mad_tiger: {\n    id: \"mad_tiger\",\n    name: \"疯虎\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 3 },\n    stats: {\n      baseHealth: 130,\n      baseSpeed: 170,\n      baseDamage: 20,\n      baseArmor: 6,\n      baseLuck: 4,\n    },\n    startingWeapon: \"thunder_drum\",\n    color: \"#FF4500\",\n  },\n\n  kang_jin_loong: {\n    id: \"kang_jin_loong\",\n    name: \"亢金星君\",\n    rank: \"boss\",\n\n    unlockCondition: { type: \"chapter\", value: 3 },\n    stats: {\n      baseHealth: 250,\n      baseSpeed: 120,\n      baseDamage: 32,\n      baseArmor: 14,\n      baseLuck: 8,\n    },\n    startingWeapon: \"golden_staff\",\n    color: \"#FFD700\",\n  },\n\n  // ===== Chapter 4 - Silk Cave =====\n  spider_celestial: {\n    id: \"spider_celestial\",\n    name: \"紫蛛\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 4 },\n    stats: {\n      baseHealth: 95,\n      baseSpeed: 155,\n      baseDamage: 18,\n      baseArmor: 7,\n      baseLuck: 15,\n    },\n    startingWeapon: \"ice_needle\",\n    color: \"#800080\",\n  },\n\n  hundred_eyed_daoist: {\n    id: \"hundred_eyed_daoist\",\n    name: \"百眼道人\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 4 },\n    stats: {\n      baseHealth: 85,\n      baseSpeed: 135,\n      baseDamage: 24,\n      baseArmor: 4,\n      baseLuck: 18,\n    },\n    startingWeapon: \"ice_needle\",\n    color: \"#4B0082\",\n  },\n\n  elder_jinchi: {\n    id: \"elder_jinchi\",\n    name: \"金池长老\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 4 },\n    stats: {\n      baseHealth: 100,\n      baseSpeed: 125,\n      baseDamage: 14,\n      baseArmor: 9,\n      baseLuck: 10,\n    },\n    startingWeapon: \"mace\",\n    color: \"#FFD700\",\n  },\n\n  hundred_eyed_daoist_master: {\n    id: \"hundred_eyed_daoist_master\",\n    name: \"多目金蜈蚣\",\n    rank: \"boss\",\n\n    unlockCondition: { type: \"chapter\", value: 4 },\n    stats: {\n      baseHealth: 280,\n      baseSpeed: 125,\n      baseDamage: 35,\n      baseArmor: 15,\n      baseLuck: 10,\n    },\n    startingWeapon: \"ice_needle\",\n    color: \"#FFD700\",\n  },\n\n  // ===== Chapter 5 - Flaming Mountains =====\n  bull_king: {\n    id: \"bull_king\",\n    name: \"牛魔王\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 5 },\n    stats: {\n      baseHealth: 180,\n      baseSpeed: 110,\n      baseDamage: 30,\n      baseArmor: 15,\n      baseLuck: 5,\n    },\n    startingWeapon: \"bull_horns\",\n    color: \"#8B4513\",\n  },\n\n  red_boy: {\n    id: \"red_boy\",\n    name: \"红孩儿\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 5 },\n    stats: {\n      baseHealth: 90,\n      baseSpeed: 150,\n      baseDamage: 22,\n      baseArmor: 6,\n      baseLuck: 8,\n    },\n    startingWeapon: \"wind_fire_wheels\",\n    color: \"#DC143C\",\n  },\n\n  rakshasa: {\n    id: \"rakshasa\",\n    name: \"罗刹女\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 5 },\n    stats: {\n      baseHealth: 85,\n      baseSpeed: 145,\n      baseDamage: 19,\n      baseArmor: 7,\n      baseLuck: 12,\n    },\n    startingWeapon: \"plantain_fan\",\n    color: \"#FF1493\",\n  },\n\n  yaksha_king: {\n    id: \"yaksha_king\",\n    name: \"夜叉王\",\n    rank: \"boss\",\n\n    unlockCondition: { type: \"chapter\", value: 5 },\n    stats: {\n      baseHealth: 310,\n      baseSpeed: 130,\n      baseDamage: 38,\n      baseArmor: 16,\n      baseLuck: 7,\n    },\n    startingWeapon: \"thunder_drum\",\n    color: \"#8B0000\",\n  },\n\n  // ===== Chapter 6 - Mount Sumeru =====\n  erlang_shen: {\n    id: \"erlang_shen\",\n    name: \"二郎神\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 6 },\n    stats: {\n      baseHealth: 160,\n      baseSpeed: 155,\n      baseDamage: 28,\n      baseArmor: 12,\n      baseLuck: 8,\n    },\n    startingWeapon: \"twin_blades\",\n    color: \"#4169E1\",\n  },\n\n  great_sage_heaven: {\n    id: \"great_sage_heaven\",\n    name: \"齐天大圣\",\n    rank: \"king\",\n\n    unlockCondition: { type: \"chapter\", value: 6 },\n    stats: {\n      baseHealth: 200,\n      baseSpeed: 170,\n      baseDamage: 35,\n      baseArmor: 10,\n      baseLuck: 15,\n    },\n    startingWeapon: \"ruyi_staff\",\n    color: \"#FFD700\",\n  },\n\n  golden_cicada: {\n    id: \"golden_cicada\",\n    name: \"金蝉子\",\n    rank: \"lord\",\n\n    unlockCondition: { type: \"chapter\", value: 6 },\n    stats: {\n      baseHealth: 120,\n      baseSpeed: 140,\n      baseDamage: 20,\n      baseArmor: 8,\n      baseLuck: 25,\n    },\n    startingWeapon: \"mace\",\n    color: \"#FFD700\",\n  },\n\n  stone_monkey: {\n    id: \"stone_monkey\",\n    name: \"石猴\",\n    rank: \"boss\",\n\n    unlockCondition: { type: \"chapter\", value: 6 },\n    stats: {\n      baseHealth: 350,\n      baseSpeed: 140,\n      baseDamage: 42,\n      baseArmor: 18,\n      baseLuck: 10,\n    },\n    startingWeapon: \"ruyi_staff\",\n    color: \"#A9A9A9\",\n  },\n} as const;\n\nexport const CHARACTER_SIZE: Record<CharacterRankType, number> = {\n  hero: 48,\n  king: 56,\n  lord: 44,\n  boss: 64,\n};\n","import type { EnemyData, EnemyType, EnemyRank } from \"../types/characters\";\n\n// Wukong enemy configuration (organized by chapter and rank)\nexport const ENEMIES_DATA: Record<EnemyType, EnemyData> = {\n  // ===== Chapter 1 - Black Wind Mountain =====\n  // Minions\n  wolf_minion: {\n    id: \"wolf_minion\",\n    name: \"狼妖\",\n    chapter: \"chapter1\",\n    rank: \"minion\",\n    health: 30,\n    damage: 5,\n    speed: 120,\n    xpValue: 10,\n    goldValue: 5,\n    color: \"#696969\",\n  },\n\n  ghost_minion: {\n    id: \"ghost_minion\",\n    name: \"阴兵\",\n    chapter: \"chapter1\",\n    rank: \"minion\",\n    health: 25,\n    damage: 6,\n    speed: 100,\n    xpValue: 10,\n    goldValue: 5,\n    color: \"#2F4F4F\",\n  },\n\n  // Elites\n  bear_elite: {\n    id: \"bear_elite\",\n    name: \"熊罴精\",\n    chapter: \"chapter1\",\n    rank: \"elite\",\n    health: 150,\n    damage: 15,\n    speed: 80,\n    xpValue: 50,\n    goldValue: 30,\n    color: \"#4B3621\",\n  },\n\n  snake_elite: {\n    id: \"snake_elite\",\n    name: \"蛇将军\",\n    chapter: \"chapter1\",\n    rank: \"elite\",\n    health: 120,\n    damage: 20,\n    speed: 110,\n    xpValue: 50,\n    goldValue: 30,\n    color: \"#228B22\",\n  },\n\n  // ===== Chapter 2 - Yellow Wind Ridge =====\n  // Minions\n  rat_minion: {\n    id: \"rat_minion\",\n    name: \"鼠妖\",\n    chapter: \"chapter2\",\n    rank: \"minion\",\n    health: 40,\n    damage: 8,\n    speed: 140,\n    xpValue: 15,\n    goldValue: 8,\n    color: \"#A9A9A9\",\n  },\n\n  sand_minion: {\n    id: \"sand_minion\",\n    name: \"沙怪\",\n    chapter: \"chapter2\",\n    rank: \"minion\",\n    health: 35,\n    damage: 7,\n    speed: 90,\n    xpValue: 15,\n    goldValue: 8,\n    color: \"#DEB887\",\n  },\n\n  // Elites\n  tiger_elite: {\n    id: \"tiger_elite\",\n    name: \"虎力士\",\n    chapter: \"chapter2\",\n    rank: \"elite\",\n    health: 180,\n    damage: 22,\n    speed: 130,\n    xpValue: 70,\n    goldValue: 40,\n    color: \"#FF6347\",\n  },\n\n  wind_elite: {\n    id: \"wind_elite\",\n    name: \"风妖统领\",\n    chapter: \"chapter2\",\n    rank: \"elite\",\n    health: 140,\n    damage: 25,\n    speed: 150,\n    xpValue: 70,\n    goldValue: 40,\n    color: \"#87CEEB\",\n  },\n\n  // ===== Chapter 3 - Little Western Heaven =====\n  // Minions\n  monk_minion: {\n    id: \"monk_minion\",\n    name: \"妖僧\",\n    chapter: \"chapter3\",\n    rank: \"minion\",\n    health: 50,\n    damage: 10,\n    speed: 100,\n    xpValue: 20,\n    goldValue: 10,\n    color: \"#D2691E\",\n  },\n\n  spider_minion: {\n    id: \"spider_minion\",\n    name: \"小蜘蛛精\",\n    chapter: \"chapter3\",\n    rank: \"minion\",\n    health: 45,\n    damage: 12,\n    speed: 130,\n    xpValue: 20,\n    goldValue: 10,\n    color: \"#8B008B\",\n  },\n\n  // Elites\n  centipede_elite: {\n    id: \"centipede_elite\",\n    name: \"蜈蚣统领\",\n    chapter: \"chapter3\",\n    rank: \"elite\",\n    health: 200,\n    damage: 28,\n    speed: 110,\n    xpValue: 90,\n    goldValue: 50,\n    color: \"#B8860B\",\n  },\n\n  scorpion_elite: {\n    id: \"scorpion_elite\",\n    name: \"蝎子精\",\n    chapter: \"chapter3\",\n    rank: \"elite\",\n    health: 160,\n    damage: 32,\n    speed: 140,\n    xpValue: 90,\n    goldValue: 50,\n    color: \"#DC143C\",\n  },\n\n  // ===== Chapter 4 - Silk Cave =====\n  // Minions\n  spider_woman_minion: {\n    id: \"spider_woman_minion\",\n    name: \"蜘蛛女妖\",\n    chapter: \"chapter4\",\n    rank: \"minion\",\n    health: 55,\n    damage: 14,\n    speed: 120,\n    xpValue: 25,\n    goldValue: 12,\n    color: \"#9370DB\",\n  },\n\n  centipede_minion: {\n    id: \"centipede_minion\",\n    name: \"小蜈蚣\",\n    chapter: \"chapter4\",\n    rank: \"minion\",\n    health: 60,\n    damage: 11,\n    speed: 100,\n    xpValue: 25,\n    goldValue: 12,\n    color: \"#556B2F\",\n  },\n\n  // Elites\n  violet_spider_elite: {\n    id: \"violet_spider_elite\",\n    name: \"紫蜘蛛\",\n    chapter: \"chapter4\",\n    rank: \"elite\",\n    health: 220,\n    damage: 30,\n    speed: 140,\n    xpValue: 110,\n    goldValue: 60,\n    color: \"#9400D3\",\n  },\n\n  poison_centipede_elite: {\n    id: \"poison_centipede_elite\",\n    name: \"毒蜈蚣\",\n    chapter: \"chapter4\",\n    rank: \"elite\",\n    health: 250,\n    damage: 26,\n    speed: 90,\n    xpValue: 110,\n    goldValue: 60,\n    color: \"#006400\",\n  },\n\n  // ===== Chapter 5 - Flaming Mountains =====\n  // Minions\n  fire_demon_minion: {\n    id: \"fire_demon_minion\",\n    name: \"火妖\",\n    chapter: \"chapter5\",\n    rank: \"minion\",\n    health: 65,\n    damage: 16,\n    speed: 110,\n    xpValue: 30,\n    goldValue: 15,\n    color: \"#FF4500\",\n  },\n\n  bull_soldier_minion: {\n    id: \"bull_soldier_minion\",\n    name: \"牛兵\",\n    chapter: \"chapter5\",\n    rank: \"minion\",\n    health: 70,\n    damage: 15,\n    speed: 90,\n    xpValue: 30,\n    goldValue: 15,\n    color: \"#8B4513\",\n  },\n\n  // Elites\n  fire_general_elite: {\n    id: \"fire_general_elite\",\n    name: \"火将军\",\n    chapter: \"chapter5\",\n    rank: \"elite\",\n    health: 280,\n    damage: 35,\n    speed: 120,\n    xpValue: 130,\n    goldValue: 70,\n    color: \"#FF8C00\",\n  },\n\n  bull_captain_elite: {\n    id: \"bull_captain_elite\",\n    name: \"牛魔统领\",\n    chapter: \"chapter5\",\n    rank: \"elite\",\n    health: 320,\n    damage: 32,\n    speed: 100,\n    xpValue: 130,\n    goldValue: 70,\n    color: \"#A0522D\",\n  },\n\n  // ===== Chapter 6 - Mount Sumeru =====\n  // Minions\n  celestial_guard_minion: {\n    id: \"celestial_guard_minion\",\n    name: \"天兵\",\n    chapter: \"chapter6\",\n    rank: \"minion\",\n    health: 80,\n    damage: 18,\n    speed: 120,\n    xpValue: 35,\n    goldValue: 18,\n    color: \"#4169E1\",\n  },\n\n  thunder_minion: {\n    id: \"thunder_minion\",\n    name: \"雷妖\",\n    chapter: \"chapter6\",\n    rank: \"minion\",\n    health: 75,\n    damage: 20,\n    speed: 130,\n    xpValue: 35,\n    goldValue: 18,\n    color: \"#9370DB\",\n  },\n\n  // Elites\n  celestial_general_elite: {\n    id: \"celestial_general_elite\",\n    name: \"天将\",\n    chapter: \"chapter6\",\n    rank: \"elite\",\n    health: 350,\n    damage: 40,\n    speed: 130,\n    xpValue: 150,\n    goldValue: 80,\n    color: \"#4682B4\",\n  },\n\n  dragon_guardian_elite: {\n    id: \"dragon_guardian_elite\",\n    name: \"龙卫\",\n    chapter: \"chapter6\",\n    rank: \"elite\",\n    health: 380,\n    damage: 38,\n    speed: 140,\n    xpValue: 150,\n    goldValue: 80,\n    color: \"#00CED1\",\n  },\n};\n\nexport const ENEMY_SIZE: Record<EnemyRank, number> = {\n  minion: 32,\n  elite: 40,\n};\n","import type {\n  WeaponType,\n  WeaponData,\n  ElixirType,\n  ElixirData,\n  WeaponRarity,\n} from \"../types/\";\n\n// Weapon configuration data\nexport const WEAPONS: Record<WeaponType, WeaponData> = {\n  // ===== 基础武器 =====\n  golden_staff: {\n    id: \"golden_staff\",\n    name: \"金箍棒\",\n    description: \"天命人的如意神兵，可大可小，重达一万三千五百斤\",\n    rarity: \"common\",\n    baseDamage: 15,\n    attackSpeed: 1000,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 稀有武器 =====\n  fire_lance: {\n    id: \"fire_lance\",\n    name: \"火尖枪\",\n    description: \"红孩儿的火焰长枪，烈焰缠绕，灼烧敌人\",\n    rarity: \"rare\",\n    baseDamage: 20,\n    attackSpeed: 1200,\n    level: 1,\n    maxLevel: 5,\n  },\n  fireproof_cloak: {\n    id: \"fireproof_cloak\",\n    name: \"避火罩\",\n    description: \"红孩儿的护体神光，抵御伤害并反弹火焰\",\n    rarity: \"rare\",\n    baseDamage: 10,\n    attackSpeed: 3000,\n    level: 1,\n    maxLevel: 5,\n  },\n  twin_blades: {\n    id: \"twin_blades\",\n    name: \"双刃刀\",\n    description: \"虎先锋的双刀，快速连击，势如猛虎\",\n    rarity: \"rare\",\n    baseDamage: 18,\n    attackSpeed: 800,\n    level: 1,\n    maxLevel: 5,\n  },\n  thunder_drum: {\n    id: \"thunder_drum\",\n    name: \"雷公凿\",\n    description: \"引动雷霆之力，天雷滚滚，震慑群妖\",\n    rarity: \"rare\",\n    baseDamage: 22,\n    attackSpeed: 1600,\n    level: 1,\n    maxLevel: 5,\n  },\n  ice_needle: {\n    id: \"ice_needle\",\n    name: \"冰魄银针\",\n    description: \"蜘蛛精的寒冰银针，千针万刺，冻结敌人\",\n    rarity: \"rare\",\n    baseDamage: 16,\n    attackSpeed: 900,\n    level: 1,\n    maxLevel: 5,\n  },\n  golden_rope: {\n    id: \"golden_rope\",\n    name: \"金绳索\",\n    description: \"束缚敌人的仙家法宝，困锁无双，无人可逃\",\n    rarity: \"rare\",\n    baseDamage: 12,\n    attackSpeed: 1400,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 史诗武器 =====\n  wind_tamer: {\n    id: \"wind_tamer\",\n    name: \"定风珠\",\n    description: \"黄风大王的定风神珠，控制风暴，范围攻击\",\n    rarity: \"epic\",\n    baseDamage: 25,\n    attackSpeed: 2000,\n    level: 1,\n    maxLevel: 5,\n  },\n  violet_bell: {\n    id: \"violet_bell\",\n    name: \"紫金铃\",\n    description: \"黄眉大王的紫金铃，发出致命音波，震慑妖魔\",\n    rarity: \"epic\",\n    baseDamage: 30,\n    attackSpeed: 1500,\n    level: 1,\n    maxLevel: 5,\n  },\n  mace: {\n    id: \"mace\",\n    name: \"降魔杵\",\n    description: \"佛门重器，降妖除魔，一杵定乾坤\",\n    rarity: \"epic\",\n    baseDamage: 35,\n    attackSpeed: 1800,\n    level: 1,\n    maxLevel: 5,\n  },\n  bull_horns: {\n    id: \"bull_horns\",\n    name: \"牛魔双角\",\n    description: \"牛魔王的巨角，冲撞无敌，势不可挡\",\n    rarity: \"epic\",\n    baseDamage: 40,\n    attackSpeed: 2500,\n    level: 1,\n    maxLevel: 5,\n  },\n  wind_fire_wheels: {\n    id: \"wind_fire_wheels\",\n    name: \"风火轮\",\n    description: \"红孩儿的风火轮，脚踏风火，疾驰如电\",\n    rarity: \"epic\",\n    baseDamage: 28,\n    attackSpeed: 1000,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 传说武器 =====\n  ruyi_staff: {\n    id: \"ruyi_staff\",\n    name: \"如意金箍棒\",\n    description: \"金箍棒的终极形态，定海神针，威力无穷\",\n    rarity: \"legendary\",\n    baseDamage: 50,\n    attackSpeed: 800,\n    level: 1,\n    maxLevel: 5,\n  },\n  jade_purity_bottle: {\n    id: \"jade_purity_bottle\",\n    name: \"玉净瓶\",\n    description: \"观音菩萨的玉净瓶，收妖降魔，净化万物\",\n    rarity: \"legendary\",\n    baseDamage: 32,\n    attackSpeed: 2200,\n    level: 1,\n    maxLevel: 5,\n  },\n  plantain_fan: {\n    id: \"plantain_fan\",\n    name: \"芭蕉扇\",\n    description: \"铁扇公主的法宝，一扇熄火，二扇生风，三扇下雨\",\n    rarity: \"legendary\",\n    baseDamage: 45,\n    attackSpeed: 3000,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 扩展武器 =====\n  three_pointed_blade: {\n    id: \"three_pointed_blade\",\n    name: \"三尖两刃刀\",\n    description: \"二郎神的神兵，三尖锋利，刀刃如电\",\n    rarity: \"legendary\",\n    baseDamage: 42,\n    attackSpeed: 1100,\n    level: 1,\n    maxLevel: 5,\n  },\n  nine_ring_staff: {\n    id: \"nine_ring_staff\",\n    name: \"九环锡杖\",\n    description: \"唐僧的禅杖，九环鸣响，震慑妖魔\",\n    rarity: \"epic\",\n    baseDamage: 30,\n    attackSpeed: 1700,\n    level: 1,\n    maxLevel: 5,\n  },\n  crescent_blade: {\n    id: \"crescent_blade\",\n    name: \"月牙铲\",\n    description: \"沙僧的降妖宝杖，月牙如钩，破甲无双\",\n    rarity: \"epic\",\n    baseDamage: 33,\n    attackSpeed: 1500,\n    level: 1,\n    maxLevel: 5,\n  },\n  iron_cudgel: {\n    id: \"iron_cudgel\",\n    name: \"混铁棍\",\n    description: \"牛魔王的巨棍，重逾千斤，力拔山兮\",\n    rarity: \"epic\",\n    baseDamage: 38,\n    attackSpeed: 2200,\n    level: 1,\n    maxLevel: 5,\n  },\n  seven_star_sword: {\n    id: \"seven_star_sword\",\n    name: \"七星剑\",\n    description: \"道家仙剑，七星连珠，剑气纵横\",\n    rarity: \"rare\",\n    baseDamage: 24,\n    attackSpeed: 1300,\n    level: 1,\n    maxLevel: 5,\n  },\n  ginseng_fruit: {\n    id: \"ginseng_fruit\",\n    name: \"人参果\",\n    description: \"镇元大仙的仙果，闻一闻活三百六十岁，吃一个活四万七千年\",\n    rarity: \"legendary\",\n    baseDamage: 15,\n    attackSpeed: 5000,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 高级扩展武器 =====\n  heaven_earth_circle: {\n    id: \"heaven_earth_circle\",\n    name: \"乾坤圈\",\n    description: \"哪吒的神器，金光万丈，飞出攻击后自动返回\",\n    rarity: \"legendary\",\n    baseDamage: 40,\n    attackSpeed: 1800,\n    level: 1,\n    maxLevel: 5,\n  },\n  red_armillary_sash: {\n    id: \"red_armillary_sash\",\n    name: \"混天绫\",\n    description: \"哪吒的法宝，长达七尺二寸，束缚和鞭打攻击\",\n    rarity: \"epic\",\n    baseDamage: 28,\n    attackSpeed: 1400,\n    level: 1,\n    maxLevel: 5,\n  },\n  purple_gold_gourd: {\n    id: \"purple_gold_gourd\",\n    name: \"紫金葫芦\",\n    description: \"金角银角的法宝，呼名答应，吸收敌人\",\n    rarity: \"legendary\",\n    baseDamage: 35,\n    attackSpeed: 3500,\n    level: 1,\n    maxLevel: 5,\n  },\n  golden_rope_immortal: {\n    id: \"golden_rope_immortal\",\n    name: \"幌金绳\",\n    description: \"太上老君的法宝，束缚更强版本，捆仙索\",\n    rarity: \"epic\",\n    baseDamage: 26,\n    attackSpeed: 1600,\n    level: 1,\n    maxLevel: 5,\n  },\n  demon_revealing_mirror: {\n    id: \"demon_revealing_mirror\",\n    name: \"照妖镜\",\n    description: \"识破敌人弱点，大幅增加暴击率和暴击伤害\",\n    rarity: \"rare\",\n    baseDamage: 18,\n    attackSpeed: 2500,\n    level: 1,\n    maxLevel: 5,\n  },\n  sea_calming_needle: {\n    id: \"sea_calming_needle\",\n    name: \"定海神针\",\n    description: \"金箍棒的另一形态，天河镇海之宝，范围更大威力更强\",\n    rarity: \"legendary\",\n    baseDamage: 55,\n    attackSpeed: 2000,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 未来扩展武器 =====\n  eight_trigrams_furnace: {\n    id: \"eight_trigrams_furnace\",\n    name: \"八卦炉\",\n    description: \"太上老君的炼丹炉，八卦烈焰，持续灼烧敌人\",\n    rarity: \"legendary\",\n    baseDamage: 32,\n    attackSpeed: 2800,\n    level: 1,\n    maxLevel: 5,\n  },\n  dragon_staff: {\n    id: \"dragon_staff\",\n    name: \"盘龙杖\",\n    description: \"观音座下的神兵，召唤龙卷风暴，席卷群敌\",\n    rarity: \"epic\",\n    baseDamage: 36,\n    attackSpeed: 2300,\n    level: 1,\n    maxLevel: 5,\n  },\n  seven_treasure_tree: {\n    id: \"seven_treasure_tree\",\n    name: \"七宝妙树\",\n    description: \"准提道人的法宝，刷新万物，净化邪祟\",\n    rarity: \"legendary\",\n    baseDamage: 38,\n    attackSpeed: 3200,\n    level: 1,\n    maxLevel: 5,\n  },\n  immortal_slaying_blade: {\n    id: \"immortal_slaying_blade\",\n    name: \"斩仙飞刀\",\n    description: \"陆压道人的飞刀，锁定必杀，请宝贝转身\",\n    rarity: \"legendary\",\n    baseDamage: 48,\n    attackSpeed: 4000,\n    level: 1,\n    maxLevel: 5,\n  },\n  diamond_snare: {\n    id: \"diamond_snare\",\n    name: \"金刚琢\",\n    description: \"太上老君的法宝，破防神器，无坚不摧\",\n    rarity: \"epic\",\n    baseDamage: 34,\n    attackSpeed: 1900,\n    level: 1,\n    maxLevel: 5,\n  },\n  exquisite_pagoda: {\n    id: \"exquisite_pagoda\",\n    name: \"玲珑宝塔\",\n    description: \"托塔天王李靖的宝塔，镇压万魔，禁锢邪祟\",\n    rarity: \"legendary\",\n    baseDamage: 40,\n    attackSpeed: 3600,\n    level: 1,\n    maxLevel: 5,\n  },\n\n  // ===== 西游记师徒武器 =====\n  nine_tooth_rake: {\n    id: \"nine_tooth_rake\",\n    name: \"九齿钉耙\",\n    description: \"猪八戒的上宝沁金钯，九齿神锋，能耙能筑\",\n    rarity: \"epic\",\n    baseDamage: 35,\n    attackSpeed: 1600,\n    level: 1,\n    maxLevel: 5,\n  },\n  dragon_scale_sword: {\n    id: \"dragon_scale_sword\",\n    name: \"龙鳞剑\",\n    description: \"白龙马的龙族神剑，剑气如虹，龙威凛然\",\n    rarity: \"rare\",\n    baseDamage: 26,\n    attackSpeed: 1200,\n    level: 1,\n    maxLevel: 5,\n  },\n};\n\n// Elixir configuration data\n// Effects are implemented in Player and GameScene classes\nexport const ELIXIRS: Record<ElixirType, ElixirData> = {\n  peach_of_immortality: {\n    id: \"peach_of_immortality\",\n    name: \"蟠桃\",\n    description: \"增加20点最大生命值\",\n    rarity: \"epic\",\n    effect: {\n      type: \"health\",\n      value: 20,\n    },\n  },\n  golden_elixir: {\n    id: \"golden_elixir\",\n    name: \"金丹\",\n    description: \"提升10%攻击力\",\n    rarity: \"rare\",\n    effect: {\n      type: \"attack\",\n      value: 0.1,\n    },\n  },\n  jade_dew: {\n    id: \"jade_dew\",\n    name: \"玉露\",\n    description: \"恢复50%生命值\",\n    rarity: \"common\",\n    effect: {\n      type: \"health\",\n      value: 0.5,\n    },\n  },\n  tiger_bone_wine: {\n    id: \"tiger_bone_wine\",\n    name: \"虎骨酒\",\n    description: \"增加5点护甲\",\n    rarity: \"rare\",\n    effect: {\n      type: \"armor\",\n      value: 5,\n    },\n  },\n  phoenix_feather: {\n    id: \"phoenix_feather\",\n    name: \"凤凰羽\",\n    description: \"增加10点移动速度\",\n    rarity: \"rare\",\n    effect: {\n      type: \"speed\",\n      value: 10,\n    },\n  },\n  dragon_scale: {\n    id: \"dragon_scale\",\n    name: \"龙鳞\",\n    description: \"增加8点防御\",\n    rarity: \"epic\",\n    effect: {\n      type: \"armor\",\n      value: 8,\n    },\n  },\n  spirit_mushroom: {\n    id: \"spirit_mushroom\",\n    name: \"灵芝\",\n    description: \"增加20%经验获取\",\n    rarity: \"rare\",\n    effect: {\n      type: \"expBonus\",\n      value: 0.2,\n    },\n  },\n  soul_bead: {\n    id: \"soul_bead\",\n    name: \"舍利子\",\n    description: \"增加10%暴击率\",\n    rarity: \"epic\",\n    effect: {\n      type: \"critRate\",\n      value: 0.1,\n    },\n  },\n  inner_elixir: {\n    id: \"inner_elixir\",\n    name: \"内丹\",\n    description: \"全属性提升5%\",\n    rarity: \"legendary\",\n    effect: {\n      type: \"all\",\n      value: 0.05,\n    },\n  },\n  resurrection_pill: {\n    id: \"resurrection_pill\",\n    name: \"还魂丹\",\n    description: \"死亡时自动复活一次\",\n    rarity: \"legendary\",\n    effect: {\n      type: \"revive\",\n      value: 1,\n    },\n  },\n  universe_bag: {\n    id: \"universe_bag\",\n    name: \"乾坤袋\",\n    description: \"显著增加金币和宝石的磁吸范围\",\n    rarity: \"epic\",\n    effect: {\n      type: \"magnetBonus\",\n      value: 1.5, // 50%磁吸范围加成\n    },\n  },\n};\n\n// Weapon crafting recipes (based on Journey to the West setting)\nexport const WEAPON_RECIPES: Record<\n  string,\n  { materials: WeaponType[]; result: WeaponType }\n> = {\n  // Ruyi Golden Cudgel: Golden Staff + Thunder Drum + Demon Mace (Heavenly weapon, requires fusion of powerful weapons)\n  ruyi_staff: {\n    materials: [\"golden_staff\", \"thunder_drum\", \"mace\"],\n    result: \"ruyi_staff\",\n  },\n  // Jade Purity Bottle: Violet Bell + Wind Tamer + Fireproof Cloak (Guanyin's treasure, requires multiple divine artifacts)\n  jade_purity_bottle: {\n    materials: [\"violet_bell\", \"wind_tamer\", \"fireproof_cloak\"],\n    result: \"jade_purity_bottle\",\n  },\n  // Plantain Fan: Wind Tamer + Fire Lance + Bull Horns (related to Iron Fan Princess and Bull Demon King)\n  plantain_fan: {\n    materials: [\"wind_tamer\", \"fire_lance\", \"bull_horns\"],\n    result: \"plantain_fan\",\n  },\n  // Wind Fire Wheels: Fire Lance + Wind Tamer (Nezha/Red Boy's wind and fire power)\n  wind_fire_wheels: {\n    materials: [\"fire_lance\", \"wind_tamer\"],\n    result: \"wind_fire_wheels\",\n  },\n  // Violet Bell: Golden Rope + Thunder Drum (Yellow Eyebrow King's treasure, requires binding and sonic power)\n  violet_bell: {\n    materials: [\"golden_rope\", \"thunder_drum\"],\n    result: \"violet_bell\",\n  },\n  // Bull Horns: Demon Mace + Fire Lance (Bull Demon King's strength and fire)\n  bull_horns: {\n    materials: [\"mace\", \"fire_lance\"],\n    result: \"bull_horns\",\n  },\n  // Ice Needle: Golden Rope + Twin Blades (fast and precise attacks)\n  ice_needle: {\n    materials: [\"golden_rope\", \"twin_blades\"],\n    result: \"ice_needle\",\n  },\n  // Thunder Drum: Twin Blades + Golden Rope (fast attacks + thunder power)\n  thunder_drum: {\n    materials: [\"twin_blades\", \"golden_rope\"],\n    result: \"thunder_drum\",\n  },\n  // Three Pointed Blade: Twin Blades + Golden Staff (weapon fusion)\n  three_pointed_blade: {\n    materials: [\"twin_blades\", \"golden_staff\"],\n    result: \"three_pointed_blade\",\n  },\n  // Nine Ring Staff: Demon Mace + Golden Rope (Buddhist artifact)\n  nine_ring_staff: {\n    materials: [\"mace\", \"golden_rope\"],\n    result: \"nine_ring_staff\",\n  },\n  // Crescent Blade: Demon Mace + Twin Blades (armor-piercing weapon)\n  crescent_blade: {\n    materials: [\"mace\", \"twin_blades\"],\n    result: \"crescent_blade\",\n  },\n  // Iron Cudgel: Bull Horns + Demon Mace (strength-based weapon)\n  iron_cudgel: {\n    materials: [\"bull_horns\", \"mace\"],\n    result: \"iron_cudgel\",\n  },\n  // Seven Star Sword: Golden Rope + Ice Needle (Taoist sword energy, precise and fast)\n  seven_star_sword: {\n    materials: [\"golden_rope\", \"ice_needle\"],\n    result: \"seven_star_sword\",\n  },\n  // Heaven Earth Circle: Golden Staff + Fire Lance (Nezha's divine weapon)\n  heaven_earth_circle: {\n    materials: [\"golden_staff\", \"fire_lance\"],\n    result: \"heaven_earth_circle\",\n  },\n  // Red Armillary Sash: Golden Rope + Wind Fire Wheels (Nezha's treasure)\n  red_armillary_sash: {\n    materials: [\"golden_rope\", \"wind_fire_wheels\"],\n    result: \"red_armillary_sash\",\n  },\n  // Purple Gold Gourd: Jade Purity Bottle + Golden Rope (absorbing treasure)\n  purple_gold_gourd: {\n    materials: [\"jade_purity_bottle\", \"golden_rope\"],\n    result: \"purple_gold_gourd\",\n  },\n  // Golden Rope Immortal: Golden Rope + Nine Ring Staff (Taishang Laojun's treasure)\n  golden_rope_immortal: {\n    materials: [\"golden_rope\", \"nine_ring_staff\"],\n    result: \"golden_rope_immortal\",\n  },\n  // Demon Revealing Mirror: Seven Star Sword + Ice Needle (reveals weaknesses)\n  demon_revealing_mirror: {\n    materials: [\"seven_star_sword\", \"ice_needle\"],\n    result: \"demon_revealing_mirror\",\n  },\n  // Sea Calming Needle: Ruyi Golden Cudgel + Bull Horns (ultimate form)\n  sea_calming_needle: {\n    materials: [\"ruyi_staff\", \"bull_horns\"],\n    result: \"sea_calming_needle\",\n  },\n  // Eight Trigrams Furnace: Violet Bell + Fire Lance + Demon Mace (Taishang Laojun's alchemy furnace)\n  eight_trigrams_furnace: {\n    materials: [\"violet_bell\", \"fire_lance\", \"mace\"],\n    result: \"eight_trigrams_furnace\",\n  },\n  // Dragon Staff: Demon Mace + Wind Tamer (Guanyin's weapon, tornado storm)\n  dragon_staff: {\n    materials: [\"mace\", \"wind_tamer\"],\n    result: \"dragon_staff\",\n  },\n  // Seven Treasure Tree: Jade Purity Bottle + Violet Bell + Wind Tamer (Zhunti Taoist's treasure)\n  seven_treasure_tree: {\n    materials: [\"jade_purity_bottle\", \"violet_bell\", \"wind_tamer\"],\n    result: \"seven_treasure_tree\",\n  },\n  // Immortal Slaying Blade: Three Pointed Blade + Ruyi Golden Cudgel (Luya Taoist's divine weapon)\n  immortal_slaying_blade: {\n    materials: [\"three_pointed_blade\", \"ruyi_staff\"],\n    result: \"immortal_slaying_blade\",\n  },\n  // Diamond Snare: Bull Horns + Thunder Drum (Taishang Laojun's armor-breaking artifact)\n  diamond_snare: {\n    materials: [\"bull_horns\", \"thunder_drum\"],\n    result: \"diamond_snare\",\n  },\n  // Exquisite Pagoda: Jade Purity Bottle + Demon Mace + Nine Ring Staff (Pagoda Bearer Li Jing's suppression treasure)\n  exquisite_pagoda: {\n    materials: [\"jade_purity_bottle\", \"mace\", \"nine_ring_staff\"],\n    result: \"exquisite_pagoda\",\n  },\n  // Nine Tooth Rake: Demon Mace + Three Pointed Blade (Pigsy's divine weapon)\n  nine_tooth_rake: {\n    materials: [\"mace\", \"three_pointed_blade\"],\n    result: \"nine_tooth_rake\",\n  },\n  // Dragon Scale Sword: Ice Needle + Twin Blades (White Dragon Horse's dragon sword energy)\n  dragon_scale_sword: {\n    materials: [\"ice_needle\", \"twin_blades\"],\n    result: \"dragon_scale_sword\",\n  },\n};\n\n// Rarity color mapping\nexport const RARITY_COLORS: Record<WeaponRarity, number> = {\n  common: 0xcccccc,\n  rare: 0x4169e1,\n  epic: 0x9932cc,\n  legendary: 0xffd700,\n};\nexport const RARITY_SIZE: Record<WeaponRarity, number> = {\n  common: 24,\n  rare: 28,\n  epic: 32,\n  legendary: 36,\n};\n\nexport const RARITY_DURATION: Record<WeaponRarity, number> = {\n  common: 1400,\n  rare: 1600,\n  epic: 1800,\n  legendary: 2000,\n};\n\nexport const RARITY_SPEED: Record<WeaponRarity, number> = {\n  common: 250,\n  rare: 300,\n  epic: 350,\n  legendary: 400,\n};\n\nexport const RARITY_DAMAGE: Record<WeaponRarity, number> = {\n  common: 4,\n  rare: 9,\n  epic: 15,\n  legendary: 22,\n};\n\nexport const RARITY_MAX_LEVEL: Record<WeaponRarity, number> = {\n  common: 5,\n  rare: 6,\n  epic: 7,\n  legendary: 8,\n};\n\nexport const GEM_MAP = {\n  gemLow: \"gem-low\",\n  gemMedium: \"gem-medium\",\n  gemHigh: \"gem-high\",\n  coin: \"coin\",\n};\n\nexport const DEFAULT_COLLECT_RADIUS = 30;\nexport const DEFAULT_MAGNET_RADIUS = 150;\n\nexport const DEFAULT_SPRITE_SIZE = 32;\n\nexport const COLLECT_RANGE_BONUS = 0.5;\n","import styles from \"./index.module.css\";\nimport { SupportLanguageCodes } from \"../../i18n\";\nimport { useTranslation } from \"react-i18next\";\nimport i18n from \"../../i18n\";\nimport { useLanguage } from \"../../store\";\nimport type { Language } from \"../../types\";\n\nconst LanguageSelect = () => {\n  const [t] = useTranslation();\n  const language = useLanguage();\n\n  return (\n    <select\n      value={language}\n      className={styles.languageSelector}\n      onChange={(e) => {\n        i18n.changeLanguage(e.target.value as Language);\n      }}\n      id=\"select-language\"\n    >\n      {SupportLanguageCodes.map((lang) => (\n        <option key={lang} value={lang}>\n          {t(`languages.${lang}`)}\n        </option>\n      ))}\n    </select>\n  );\n};\n\nexport default LanguageSelect;\n","import React from \"react\";\nimport { createRoot, type Root } from \"react-dom/client\";\nimport styles from \"./index.module.css\";\nimport { MessageType } from \"../../types\";\n\ntype Props = {\n  message: string;\n  type: MessageType;\n  duration?: number; // second\n  testId: string;\n};\n\nexport const Toast: React.FC<Omit<Props, \"duration\">> = React.memo(\n  ({ message, type, testId }) => {\n    return (\n      <div\n        className={`${styles[\"toast\"]} ${styles[type]}`}\n        data-testid={testId}\n      >\n        <div className={styles[\"content\"]}>{message}</div>\n      </div>\n    );\n  },\n);\n\nToast.displayName = \"Toast\";\n\nexport function toast(props: Props) {\n  const { duration = 3, ...rest } = props;\n  let container: HTMLDivElement | null = document.createElement(\"div\");\n  container.className = styles[\"container\"];\n  document.body.appendChild(container);\n  const root: Root = createRoot(container);\n  root.render(<Toast {...rest} />);\n\n  function close() {\n    if (!container) {\n      return;\n    }\n    root.unmount();\n    if (container.parentNode) {\n      document.body.removeChild(container);\n    }\n    container = null;\n  }\n\n  const timer = setTimeout(close, duration * 1000);\n\n  // Return enhanced close function that also clears timer\n  return () => {\n    clearTimeout(timer);\n    close();\n  };\n}\n\ntoast.error = function (message: string, testId = \"error-toast\") {\n  return toast({ message, type: \"error\", testId });\n};\n\ntoast.info = function (message: string, testId = \"info-toast\") {\n  return toast({ message, type: \"info\", testId });\n};\n\ntoast.warning = function (message: string, testId = \"warning-toast\") {\n  return toast({ message, type: \"warning\", testId });\n};\n\ntoast.success = function (message: string, testId = \"success-toast\") {\n  return toast({ message, type: \"success\", testId });\n};\n","import { toast } from \"../components\";\nimport i18n from \"../i18n\";\n\nexport const confirmModal = (message: string): boolean => {\n  const res = window.confirm(message);\n\n  if (res) {\n    toast.success(i18n.t(\"settings.resetSuccess\"));\n  }\n  return res;\n};\n\nfunction requestFullscreen(element: any) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    // webkit\n    element.webkitRequestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    // Firefox\n    element.mozRequestFullScreen();\n  } else if (element.msRequestFullscreen) {\n    // IE/Edge\n    element.msRequestFullscreen();\n  }\n}\n\nfunction exitFullscreen() {\n  const element = document as any;\n\n  if (element.exitFullscreen) {\n    element.exitFullscreen();\n  } else if (element.webkitExitFullscreen) {\n    element.webkitExitFullscreen();\n  } else if (element.mozCancelFullScreen) {\n    element.mozCancelFullScreen();\n  } else if (element.msExitFullscreen) {\n    element.msExitFullscreen();\n  }\n}\n\nexport function isFullScreen() {\n  const element = document as any;\n\n  const res =\n    !!element.fullscreenElement ||\n    !!element.webkitFullscreenElement ||\n    !!element.mozFullScreenElement ||\n    !!element.msFullscreenElement;\n\n  return res;\n}\n\nexport const toggleFullScreen = (enable: boolean) => {\n  const isOn = isFullScreen();\n\n  if (isOn === enable) {\n    return;\n  }\n\n  if (enable) {\n    requestFullscreen(document.documentElement);\n  } else {\n    exitFullscreen();\n  }\n};\n","import type {\n  WeaponType,\n  ElixirType,\n  WeaponRarity,\n  CharacterType,\n  EnemyType,\n  MapType,\n} from \"../types\";\nimport { WEAPONS, ELIXIRS, WEAPON_RECIPES } from \"../constant\";\n\nexport const formatTime = (seconds: number): string => {\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins.toString().padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}`;\n};\n\n// ===== Weapon and Elixir Utility Functions =====\n\n// Get weight by rarity\nexport function getRarityWeight(rarity: WeaponRarity): number {\n  const weights: Record<WeaponRarity, number> = {\n    common: 50,\n    rare: 30,\n    epic: 15,\n    legendary: 5,\n  };\n  return weights[rarity];\n}\n\n// Helper function for weighted random selection with uniqueness\nfunction getRandomItemsWithWeight<T extends string>(\n  items: Record<T, { rarity: WeaponRarity }>,\n  count: number,\n): T[] {\n  // Create weighted items array\n  const weightedItems = Object.entries(items).map(([id, item]) => ({\n    id: id as T,\n    weight: getRarityWeight((item as { rarity: WeaponRarity }).rarity),\n  }));\n\n  const selected: T[] = [];\n  const availableItems = [...weightedItems];\n\n  // Select random items with guaranteed uniqueness\n  while (selected.length < count && availableItems.length > 0) {\n    // Calculate total weight\n    const totalWeight = availableItems.reduce(\n      (sum, item) => sum + item.weight,\n      0,\n    );\n\n    // Weighted random selection\n    let random = Math.random() * totalWeight;\n    let selectedIndex = -1;\n\n    for (let i = 0; i < availableItems.length && random > 0; i++) {\n      random -= availableItems[i].weight;\n      if (random <= 0) {\n        selectedIndex = i;\n        break;\n      }\n    }\n\n    if (selectedIndex >= 0) {\n      selected.push(availableItems[selectedIndex].id);\n      availableItems.splice(selectedIndex, 1); // Remove to prevent duplicates\n    }\n  }\n\n  return selected;\n}\n\n// Image path utility functions\nexport const getWeaponImagePath = (id: WeaponType): string => {\n  return `assets/weapons/${id}.svg`;\n};\n\nexport const getCharacterImagePath = (id: CharacterType): string => {\n  return `assets/characters/${id}.svg`;\n};\n\nexport const getEnemyImagePath = (id: EnemyType): string => {\n  return `assets/enemies/${id}.svg`;\n};\n\nexport const getMapImagePath = (id: MapType): string => {\n  return `assets/maps/${id}.svg`;\n};\n\n// Randomly get weapons (considering rarity weight)\nexport function getRandomWeapons(count: number): WeaponType[] {\n  return getRandomItemsWithWeight(WEAPONS, count);\n}\n\n// Randomly get elixirs\nexport function getRandomElixirs(count: number): ElixirType[] {\n  return getRandomItemsWithWeight(ELIXIRS, count);\n}\n\n// ===== Weapon Crafting Functions =====\n\n// Check if weapon can be crafted\nfunction canCraftWeapon(\n  ownedWeapons: WeaponType[],\n  recipeKey: string,\n): boolean {\n  const recipe = WEAPON_RECIPES[recipeKey];\n  if (!recipe) return false;\n\n  return recipe.materials.every((material) => ownedWeapons.includes(material));\n}\n\n// Get list of craftable weapons\nexport function getAvailableCrafts(ownedWeapons: WeaponType[]): WeaponType[] {\n  const available: WeaponType[] = [];\n\n  Object.entries(WEAPON_RECIPES).forEach(([key, recipe]) => {\n    if (\n      canCraftWeapon(ownedWeapons, key) &&\n      !ownedWeapons.includes(recipe.result)\n    ) {\n      available.push(recipe.result);\n    }\n  });\n\n  return available;\n}\n\nexport const upgradeLevelGold = (level: number) => level * 100 + 100;\n\nexport * from \"./fullScreen\";\n","import type { GameMap, PermanentUpgrade, GameSave } from \"../types\";\nimport { upgradeLevelGold } from \"../util\";\n\nexport const DEFAULT_GAME_TIME = 30 * 60; // 30 minutes in seconds\n// Map data - Wukong chapters\nexport const MAPS: GameMap[] = [\n  {\n    id: \"chapter1\",\n    chapter: 1,\n    unlockCondition: {\n      type: \"default\",\n      value: 0,\n    },\n    difficulty: 1,\n    availableEnemies: [\n      \"wolf_minion\",\n      \"ghost_minion\",\n      \"bear_elite\",\n      \"snake_elite\",\n    ],\n  },\n  {\n    id: \"chapter2\",\n    chapter: 2,\n    unlockCondition: {\n      type: \"chapter\",\n      value: 1,\n    },\n    difficulty: 2,\n    availableEnemies: [\n      \"rat_minion\",\n      \"sand_minion\",\n      \"tiger_elite\",\n      \"wind_elite\",\n    ],\n  },\n  {\n    id: \"chapter3\",\n    chapter: 3,\n    unlockCondition: {\n      type: \"chapter\",\n      value: 2,\n    },\n    difficulty: 3,\n    availableEnemies: [\n      \"monk_minion\",\n      \"spider_minion\",\n      \"centipede_elite\",\n      \"scorpion_elite\",\n    ],\n  },\n  {\n    id: \"chapter4\",\n    chapter: 4,\n    unlockCondition: {\n      type: \"chapter\",\n      value: 3,\n    },\n    difficulty: 4,\n    availableEnemies: [\n      \"spider_woman_minion\",\n      \"centipede_minion\",\n      \"violet_spider_elite\",\n      \"poison_centipede_elite\",\n    ],\n  },\n  {\n    id: \"chapter5\",\n    chapter: 5,\n    unlockCondition: {\n      type: \"chapter\",\n      value: 4,\n    },\n    difficulty: 5,\n    availableEnemies: [\n      \"fire_demon_minion\",\n      \"bull_soldier_minion\",\n      \"fire_general_elite\",\n      \"bull_captain_elite\",\n    ],\n  },\n  {\n    id: \"chapter6\",\n    chapter: 6,\n    unlockCondition: {\n      type: \"chapter\",\n      value: 5,\n    },\n    difficulty: 6,\n    availableEnemies: [\n      \"celestial_guard_minion\",\n      \"thunder_minion\",\n      \"celestial_general_elite\",\n      \"dragon_guardian_elite\",\n    ],\n  },\n];\n// Permanent upgrade configuration\n\nexport const BASE_UPGRADE_PERCENTAGE = 0.02;\nexport const MAX_UPGRADE_LEVEL = 10;\n\nexport const PERMANENT_UPGRADES: PermanentUpgrade[] = [\n  {\n    id: \"attack\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * 3,\n  },\n  {\n    id: \"health\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * 10,\n  },\n  {\n    id: \"armor\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * 2,\n  },\n  {\n    id: \"luck\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * 2,\n  },\n  {\n    id: \"speed\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * 5,\n  },\n  {\n    id: \"expBonus\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * BASE_UPGRADE_PERCENTAGE,\n  },\n  {\n    id: \"critRate\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * BASE_UPGRADE_PERCENTAGE,\n  },\n  {\n    id: \"magnetBonus\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * BASE_UPGRADE_PERCENTAGE,\n  },\n  {\n    id: \"collectRange\",\n    maxLevel: MAX_UPGRADE_LEVEL,\n    cost: upgradeLevelGold,\n    effect: (level) => level * BASE_UPGRADE_PERCENTAGE,\n  },\n];\n// Default save data\n\nexport const DEFAULT_SAVE: GameSave = {\n  totalGold: 0,\n  totalKills: 0,\n  bestSurvivalTime: 0,\n  totalPlayTime: 0,\n  completedChapters: [],\n  attack: 0,\n  health: 0,\n  armor: 0,\n  luck: 0,\n  speed: 0,\n  expBonus: 0,\n  critRate: 0,\n  magnetBonus: 0,\n  collectRange: 0,\n};\n\nexport const WORLD_SIZE = 4000;\n","export const EVENT_MAP = Object.freeze({\n  BACK_TO_HOME: \"BACK_TO_HOME\",\n  SHOW_END_GAME_MODAL: \"SHOW_END_GAME_MODAL\",\n  GAME_INITIALIZED: \"GAME_INITIALIZED\",\n} as const);\n\nexport const START_Z_INDEX = 2;\n\nexport const MAX_SELECT_SIZE = 3;\n\nexport const ENABLE_DEBUG = Boolean(localStorage.getItem(\"debug\"));\n\nexport * from \"./characters\";\nexport * from \"./enemies\";\nexport * from \"./rewards\";\nexport * from \"./map\";\n","import { create } from \"zustand\";\nimport type {\n  CharacterType,\n  MapType,\n  CharacterData,\n  GameMap,\n  WeaponType,\n} from \"../types\";\nimport { useSaveStore } from \"./save\";\nimport { useShallow } from \"zustand/react/shallow\";\nimport { CHARACTERS_DATA } from \"../constant\";\nimport { MAPS } from \"../constant/map\";\n\ntype States = {\n  selectedCharacterId: CharacterType;\n  selectedMapId: MapType;\n  unlockedCharacterIds: CharacterType[];\n  unlockedMapIds: MapType[];\n  ownedWeapons: WeaponType[];\n};\n\ntype Actions = {\n  selectCharacter: (characterId: CharacterType) => void;\n  selectMap: (mapId: MapType) => void;\n  getSelectCharacter: () => CharacterData;\n  getSelectMap: () => GameMap;\n  checkUnlocks: () => void;\n  addWeapon: (weaponId: WeaponType) => void;\n  resetAll: () => void;\n};\n\ntype Store = States & Actions;\n\nconst checkUnlocks = (): Partial<States> => {\n  const state = useSaveStore.getState();\n  const { completedChapters } = state;\n\n  const unlockedMapIds: MapType[] = [];\n  const unlockedCharacterIds: CharacterType[] = [];\n\n  const chapters = completedChapters.map((c) => {\n    const item = MAPS.find((m) => m.id === c);\n    return item?.chapter ?? 0;\n  });\n\n  // Check map unlock\n  MAPS.forEach((map) => {\n    if (!unlockedMapIds.includes(map.id)) {\n      let unlocked = false;\n\n      switch (map.unlockCondition.type) {\n        case \"default\":\n          unlocked = true;\n          break;\n        case \"chapter\":\n          unlocked = chapters.includes(map.unlockCondition.value);\n          break;\n      }\n\n      if (unlocked) {\n        unlockedMapIds.push(map.id);\n      }\n    }\n  });\n\n  // Check character unlock\n  Object.values(CHARACTERS_DATA).forEach((char) => {\n    if (!unlockedCharacterIds.includes(char.id)) {\n      let unlocked = false;\n\n      switch (char.unlockCondition.type) {\n        case \"default\":\n          unlocked = true;\n          break;\n        case \"kills\":\n          unlocked = state.totalKills >= char.unlockCondition.value;\n          break;\n        case \"time\":\n          unlocked = state.bestSurvivalTime >= char.unlockCondition.value;\n          break;\n        case \"gold\":\n          unlocked = state.totalGold >= char.unlockCondition.value;\n          break;\n        case \"chapter\": {\n          unlocked = chapters.includes(char.unlockCondition.value);\n          break;\n        }\n      }\n\n      if (unlocked) {\n        unlockedCharacterIds.push(char.id);\n      }\n    }\n  });\n\n  return {\n    unlockedCharacterIds,\n    unlockedMapIds,\n  };\n};\n\nexport const useAppStore = create<Store>((set, get) => {\n  return {\n    selectedCharacterId: \"destined_one\",\n    selectedMapId: \"chapter1\",\n    unlockedCharacterIds: [],\n    unlockedMapIds: [],\n    ownedWeapons: [],\n    resetAll() {\n      set({\n        selectedCharacterId: \"destined_one\",\n        selectedMapId: \"chapter1\",\n        unlockedCharacterIds: [],\n        unlockedMapIds: [],\n        ownedWeapons: [],\n      });\n    },\n    addWeapon: (weaponId) => {\n      const { ownedWeapons } = get();\n\n      if (!ownedWeapons.includes(weaponId)) {\n        set({ ownedWeapons: [...ownedWeapons, weaponId] });\n      }\n    },\n    selectCharacter: (characterId: CharacterType) => {\n      const { unlockedCharacterIds } = get();\n      if (unlockedCharacterIds.includes(characterId)) {\n        set({ selectedCharacterId: characterId });\n      }\n    },\n\n    selectMap: (mapId: MapType) => {\n      const { unlockedMapIds } = get();\n      if (unlockedMapIds.includes(mapId)) {\n        set({ selectedMapId: mapId });\n      }\n    },\n    getSelectCharacter() {\n      const { selectedCharacterId: selectedCharacter } = get();\n\n      return (\n        CHARACTERS_DATA[selectedCharacter] || CHARACTERS_DATA[\"destined_one\"]\n      );\n    },\n    getSelectMap() {\n      const { selectedMapId: selectedMap } = get();\n\n      return MAPS.find((map) => map.id === selectedMap) || MAPS[0];\n    },\n\n    checkUnlocks: () => {\n      set(checkUnlocks());\n    },\n  };\n});\n\nconst getSelectedCharacter = (state: Store) => state.selectedCharacterId;\nconst getSelectedMap = (state: Store) => state.selectedMapId;\nconst getUnlockedCharacters = (state: Store) => state.unlockedCharacterIds;\nconst getUnlockedMaps = (state: Store) => state.unlockedMapIds;\n\nexport const useSelectedCharacter = () =>\n  useAppStore(useShallow(getSelectedCharacter));\nexport const useSelectedMap = () => useAppStore(useShallow(getSelectedMap));\nexport const useUnlockedCharacters = () =>\n  useAppStore(useShallow(getUnlockedCharacters));\nexport const useUnlockedMaps = () => useAppStore(useShallow(getUnlockedMaps));\n","import { create } from \"zustand\";\nimport { persist, createJSONStorage } from \"zustand/middleware\";\nimport { DEFAULT_SAVE, PERMANENT_UPGRADES } from \"../constant\";\nimport type { GameSave, PermanentUpgradeType, MapType } from \"../types\";\nimport { useShallow } from \"zustand/react/shallow\";\nimport { useAppStore } from \"./app\";\n\nconst SAVE_KEY = \"wu_kong_survivors_save\";\n\n// Zustand Store interface\ninterface SaveStore extends GameSave {\n  // Actions\n  addGold: (amount: number) => void;\n  spendGold: (amount: number) => boolean;\n  addKills: (amount: number) => void;\n  updatePlayTime: (seconds: number) => void;\n  upgradePermanent: (upgradeId: PermanentUpgradeType) => boolean;\n  resetPermanentUpgrades: () => void;\n  resetAll: () => void;\n  completeChapter: (map: MapType[]) => void;\n}\n\n// Create Zustand Store with persist middleware\nexport const useSaveStore = create<SaveStore>()(\n  persist(\n    (set, get) => ({\n      ...DEFAULT_SAVE,\n\n      // Actions\n      addGold: (amount: number) => {\n        set({ totalGold: get().totalGold + amount });\n        useAppStore.getState().checkUnlocks();\n      },\n\n      spendGold: (amount: number) => {\n        const state = get();\n        if (state.totalGold >= amount) {\n          set({ totalGold: state.totalGold - amount });\n          return true;\n        }\n        return false;\n      },\n\n      addKills: (amount: number) => {\n        set({\n          totalKills: get().totalKills + amount,\n        });\n        useAppStore.getState().checkUnlocks();\n      },\n\n      updatePlayTime: (seconds: number) => {\n        seconds = Math.floor(seconds);\n\n        const state = get();\n\n        const newPlayTime = state.totalPlayTime + seconds;\n        const newBestTime =\n          seconds > state.bestSurvivalTime ? seconds : state.bestSurvivalTime;\n        set({\n          totalPlayTime: newPlayTime,\n          bestSurvivalTime: newBestTime,\n        });\n        useAppStore.getState().checkUnlocks();\n      },\n\n      upgradePermanent: (upgradeId: PermanentUpgradeType) => {\n        const state = get();\n        const upgrade = PERMANENT_UPGRADES.find((u) => u.id === upgradeId);\n        if (!upgrade) return false;\n\n        const currentLevel = state[upgradeId] || 0;\n        if (currentLevel >= upgrade.maxLevel) return false;\n\n        const cost = upgrade.cost(currentLevel);\n        if (state.totalGold >= cost) {\n          set({\n            totalGold: state.totalGold - cost,\n            [upgradeId]: currentLevel + 1,\n          });\n          return true;\n        }\n        return false;\n      },\n\n      resetPermanentUpgrades: () => {\n        const state = get();\n        let refund = 0;\n\n        PERMANENT_UPGRADES.forEach((item) => {\n          const level = state[item.id] || 0;\n          for (let i = 0; i < level; i++) {\n            refund += item.cost(i);\n          }\n        });\n\n        refund = Math.floor(refund);\n\n        // Reset all levels\n        const resetUpgrades: Partial<Record<PermanentUpgradeType, number>> = {};\n        PERMANENT_UPGRADES.forEach((item) => {\n          resetUpgrades[item.id] = 0;\n        });\n\n        set({\n          ...resetUpgrades,\n          totalGold: state.totalGold + refund,\n        });\n      },\n\n      resetAll: () => set({ ...DEFAULT_SAVE }),\n\n      // Complete chapter and unlock corresponding characters\n      completeChapter: (chapters) => {\n        const { completedChapters = [] } = get();\n\n        const list = Array.from(new Set([...completedChapters, ...chapters]));\n\n        set({ completedChapters: list });\n\n        useAppStore.getState().checkUnlocks();\n      },\n    }),\n    {\n      name: SAVE_KEY,\n      merge: (persistedState, currentState) => ({\n        ...DEFAULT_SAVE,\n        ...currentState,\n        ...(persistedState as Partial<GameSave>),\n      }),\n      storage: createJSONStorage(() => localStorage),\n    },\n  ),\n);\n\nconst getTotalGold = (state: GameSave) => state.totalGold;\nconst getTotalKills = (state: GameSave) => state.totalKills;\nconst getBestSurvivalTime = (state: GameSave) => state.bestSurvivalTime;\nconst getTotalPlayTime = (state: GameSave) => state.totalPlayTime;\n\nconst getCompletedChapters = (state: GameSave) => state.completedChapters;\n\nconst getShopLevel = (\n  state: GameSave,\n): Record<PermanentUpgradeType, number> => ({\n  attack: state.attack,\n  health: state.health,\n  armor: state.armor,\n  speed: state.speed,\n  luck: state.luck,\n  expBonus: state.expBonus,\n  critRate: state.critRate,\n  magnetBonus: state.magnetBonus,\n  collectRange: state.collectRange,\n});\n\nexport const useTotalGold = () => useSaveStore(useShallow(getTotalGold));\nexport const useTotalKills = () => useSaveStore(useShallow(getTotalKills));\nexport const useBestSurvivalTime = () =>\n  useSaveStore(useShallow(getBestSurvivalTime));\nexport const useTotalPlayTime = () =>\n  useSaveStore(useShallow(getTotalPlayTime));\n\nexport const useCompletedChapters = () =>\n  useSaveStore(useShallow(getCompletedChapters));\n\nexport const useShopLevel = () => useSaveStore(useShallow(getShopLevel));\n","import { create } from \"zustand\";\nimport { persist, createJSONStorage } from \"zustand/middleware\";\nimport { DEFAULT_GAME_TIME, MAPS } from \"../constant\";\nimport type { Language } from \"../types\";\nimport { useShallow } from \"zustand/react/shallow\";\nimport { useSaveStore } from \"./save\";\nimport Phaser from \"phaser\";\n\nexport type SettingState = {\n  language?: Language;\n  musicVolume: number;\n  musicEnabled: boolean;\n  enableAutoSelect: boolean;\n  enableUnlockAll: boolean;\n  gameTime: number;\n  enableFullScreen: boolean;\n};\n\nexport const DEFAULT_SETTING: SettingState = {\n  musicVolume: 0.5,\n  musicEnabled: true,\n  enableAutoSelect: false,\n  enableUnlockAll: false,\n  gameTime: DEFAULT_GAME_TIME,\n  enableFullScreen: false,\n};\n\nconst SAVE_KEY = \"wu_kong_survivors_setting\";\n\n// Zustand Store interface\ninterface SettingStore extends SettingState {\n  setLanguage: (language: Language) => void;\n  resetAll: () => void;\n  setMusicVolume: (volume: number) => void;\n  setMusicEnabled: (enabled: boolean) => void;\n  setAutoSelectEnabled: (enabled: boolean) => void;\n  setUnlockAllEnabled: (enabled: boolean) => void;\n  setGameTime: (gameTime: number) => void;\n  setFullScreenEnabled: (enabled: boolean) => void;\n}\n\nexport const useSettingStore = create<SettingStore>()(\n  persist(\n    (set) => ({\n      ...DEFAULT_SETTING,\n      setFullScreenEnabled(enabled: boolean) {\n        set({ enableFullScreen: enabled });\n      },\n      setGameTime(gameTime: number) {\n        set({ gameTime });\n      },\n      setAutoSelectEnabled(enabled) {\n        set({ enableAutoSelect: enabled });\n      },\n      setUnlockAllEnabled(enabled) {\n        set({ enableUnlockAll: enabled });\n        if (enabled) {\n          useSaveStore.getState().completeChapter(MAPS.map((m) => m.id));\n        }\n      },\n      setMusicVolume(volume) {\n        const t = Phaser.Math.Clamp(volume, 0, 1);\n        set({ musicVolume: t });\n      },\n      setMusicEnabled(enabled) {\n        set({ musicEnabled: enabled });\n      },\n\n      setLanguage: (language) => set({ language }),\n\n      resetAll: () => set({ ...DEFAULT_SETTING }),\n    }),\n    {\n      name: SAVE_KEY,\n      merge: (persistedState, currentState) => ({\n        ...DEFAULT_SETTING,\n        ...currentState,\n        ...(persistedState as Partial<SettingState>),\n      }),\n      storage: createJSONStorage(() => localStorage),\n    },\n  ),\n);\n\nconst getLanguage = (state: SettingState) => state.language;\nconst getEnableAutoSelect = (state: SettingState) => state.enableAutoSelect;\nconst getEnableUnlockAll = (state: SettingState) => state.enableUnlockAll;\nconst getMusicEnabled = (state: SettingState) => state.musicEnabled;\nconst getMusicVolume = (state: SettingState) => state.musicVolume;\nconst getGameTime = (state: SettingState) => state.gameTime;\nconst getEnableFullScreen = (state: SettingState) => state.enableFullScreen;\n\nexport const useLanguage = () => useSettingStore(useShallow(getLanguage));\nexport const useEnableAutoSelect = () =>\n  useSettingStore(useShallow(getEnableAutoSelect));\nexport const useEnableUnlockAll = () =>\n  useSettingStore(useShallow(getEnableUnlockAll));\nexport const useMusicEnabled = () =>\n  useSettingStore(useShallow(getMusicEnabled));\nexport const useMusicVolume = () => useSettingStore(useShallow(getMusicVolume));\nexport const useGameTime = () => useSettingStore(useShallow(getGameTime));\nexport const useEnableFullScreen = () =>\n  useSettingStore(useShallow(getEnableFullScreen));\n","import i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport { useSettingStore } from \"./store\";\nimport type { Language } from \"./types\";\n\n// Import translation files\nimport zhCN from \"./locales/zh-CN.json\";\nimport enUS from \"./locales/en-US.json\";\nimport jaJP from \"./locales/ja-JP.json\";\nimport deDE from \"./locales/de-DE.json\";\nimport esES from \"./locales/es-ES.json\";\nimport frFR from \"./locales/fr-FR.json\";\nimport koKR from \"./locales/ko-KR.json\";\nimport ptBR from \"./locales/pt-BR.json\";\nimport ruRU from \"./locales/ru-RU.json\";\nimport zhTW from \"./locales/zh-TW.json\";\n\nconst resources = {\n  \"zh-CN\": { translation: zhCN },\n  \"en-US\": { translation: enUS },\n  \"ja-JP\": { translation: jaJP },\n  \"de-DE\": { translation: deDE },\n  \"es-ES\": { translation: esES },\n  \"fr-FR\": { translation: frFR },\n  \"ko-KR\": { translation: koKR },\n  \"pt-BR\": { translation: ptBR },\n  \"ru-RU\": { translation: ruRU },\n  \"zh-TW\": { translation: zhTW },\n};\n\nexport const SupportLanguageCodes = Object.keys(resources) as Language[];\n\nfunction I18nConfig() {\n  const defaultLang = \"en-US\";\n\n  let currentLanguage: Language = defaultLang;\n  let initialized = false;\n\n  const getSelectedLang = (lang = \"\") => {\n    const selectedLang: any =\n      lang ||\n      useSettingStore.getState().language ||\n      navigator.language ||\n      defaultLang;\n\n    if (SupportLanguageCodes.includes(selectedLang)) {\n      return selectedLang;\n    }\n\n    const findLang = SupportLanguageCodes.find((item) =>\n      item.toLocaleLowerCase().includes(selectedLang.toLocaleLowerCase()),\n    );\n    if (findLang) return findLang;\n\n    return defaultLang;\n  };\n\n  const initialize = async (lang = \"\") => {\n    initialized = true;\n\n    currentLanguage = getSelectedLang(lang);\n\n    await i18n.use(initReactI18next).init({\n      lng: currentLanguage,\n      fallbackLng: defaultLang,\n      resources,\n      supportedLngs: SupportLanguageCodes,\n      interpolation: {\n        escapeValue: false,\n        prefix: \"{\",\n        suffix: \"}\",\n      },\n      react: {\n        useSuspense: false,\n      },\n    });\n\n    return currentLanguage;\n  };\n\n  return {\n    changeLanguage: async (lang?: Language) => {\n      if (!initialized) {\n        await initialize(lang);\n      } else if (lang && lang !== currentLanguage) {\n        currentLanguage = getSelectedLang(lang);\n        await i18n.changeLanguage(currentLanguage);\n      }\n\n      useSettingStore.getState().setLanguage(currentLanguage);\n\n      return currentLanguage;\n    },\n    t: i18n.t,\n    get language(): Language {\n      return currentLanguage;\n    },\n  };\n}\n\nconst i18nConfig = I18nConfig();\n\nexport default i18nConfig;\n","import React, { useMemo } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { CHARACTERS_DATA } from \"../../constant/characters\";\nimport { getCharacterImagePath } from \"../../util\";\nimport type { CharacterData } from \"../../types\";\nimport {\n  useAppStore,\n  useUnlockedCharacters,\n  useSelectedCharacter,\n} from \"../../store\";\nimport styles from \"./index.module.css\";\n\nconst characterList = Object.values(CHARACTERS_DATA);\n\ninterface CharacterSelectProps {\n  onConfirm: () => void;\n  onBack: () => void;\n}\n\nconst CharacterSelect: React.FC<CharacterSelectProps> = ({\n  onConfirm,\n  onBack,\n}) => {\n  const [t] = useTranslation();\n  const unlockedCharacters = useUnlockedCharacters();\n  const characterId = useSelectedCharacter();\n\n  const selectedCharacter = useMemo(() => {\n    return useAppStore.getState().getSelectCharacter();\n  }, [characterId]);\n\n  const handleCharacterClick = (character: CharacterData) => {\n    if (unlockedCharacters.includes(character.id)) {\n      useAppStore.getState().selectCharacter(character.id);\n    }\n  };\n\n  const handleConfirm = () => {\n    if (selectedCharacter) {\n      useAppStore.getState().selectCharacter(selectedCharacter.id);\n      onConfirm();\n    }\n  };\n\n  return (\n    <div className=\"common-container\">\n      <h1 data-testid=\"page-title\">{t(\"characters.selectCharacter\")}</h1>\n      <div className={styles.charactersGrid} data-testid=\"characters-grid\">\n        {characterList.map((character) => {\n          const isUnlocked = unlockedCharacters.includes(character.id);\n          const isSelected = selectedCharacter?.id === character.id;\n\n          return (\n            <div\n              key={character.id}\n              className={`${styles.characterCard} ${isUnlocked ? styles.unlocked : styles.locked} ${isSelected ? styles.selected : \"\"}`}\n              data-testid={`character-card-${character.id}`}\n              onClick={() => handleCharacterClick(character)}\n            >\n              <div className={styles.characterIcon}>\n                {isUnlocked ? (\n                  <img\n                    src={getCharacterImagePath(character.id)}\n                    alt={t(`characters.${character.id}.name`)}\n                    className={styles.unlockedChar}\n                    style={{\n                      color: character.color,\n                    }}\n                  />\n                ) : (\n                  <div className={styles.lockedIcon}>🔒</div>\n                )}\n              </div>\n\n              <div className={styles.characterName}>\n                {isUnlocked\n                  ? t(`characters.${character.id}.name`)\n                  : t(`unlockConditions.${character.unlockCondition.type}`, {\n                      value: character.unlockCondition.value,\n                    })}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      {selectedCharacter && (\n        <div className={styles.characterDetail} data-testid=\"character-details\">\n          <h2>{t(`characters.${selectedCharacter.id}.name`)}</h2>\n          <p className={styles.description}>\n            {t(`characters.${selectedCharacter.id}.description`)}\n          </p>\n          <div className={styles.stats}>\n            <div className={styles.stat}>\n              {/* eslint-disable-next-line i18next/no-literal-string */}\n              <span className={styles.statName}>❤️ {t(\"stats.level\")}</span>\n              <span className={styles.statValue}>\n                {selectedCharacter.stats.baseHealth}\n              </span>\n            </div>\n            <div className={styles.stat}>\n              <span className={styles.statName}>\n                🏃 {t(\"upgrades.speed.name\")}\n              </span>\n              <span className={styles.statValue}>\n                {selectedCharacter.stats.baseSpeed}\n              </span>\n            </div>\n            <div className={styles.stat}>\n              {/* eslint-disable-next-line i18next/no-literal-string */}\n              <span className={styles.statName}>\n                ⚔️ {t(\"upgrades.attack.name\")}\n              </span>\n              <span className={styles.statValue}>\n                {selectedCharacter.stats.baseDamage}\n              </span>\n            </div>\n            <div className={styles.stat}>\n              {/* eslint-disable-next-line i18next/no-literal-string */}\n              <span className={styles.statName}>\n                🛡️ {t(\"upgrades.armor.name\")}\n              </span>\n              <span className={styles.statValue}>\n                {selectedCharacter.stats.baseArmor}\n              </span>\n            </div>\n            <div className={styles.stat}>\n              <span className={styles.statName}>\n                🍀 {t(\"upgrades.luck.name\")}\n              </span>\n              <span className={styles.statValue}>\n                {selectedCharacter.stats.baseLuck}\n              </span>\n            </div>\n            {selectedCharacter.startingWeapon && (\n              <div className={styles.stat}>\n                {/* eslint-disable-next-line i18next/no-literal-string */}\n                <span className={styles.statName}>\n                  🗡️ {t(\"characters.specialWeapon\")}\n                </span>\n                <span className={styles.statValue}>\n                  {t(`weapons.${selectedCharacter.startingWeapon}.name`)}\n                </span>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      <div className=\"button-group\">\n        <button\n          className=\"confirmButton\"\n          onClick={handleConfirm}\n          disabled={!selectedCharacter}\n          data-testid=\"start-button\"\n        >\n          {t(\"game.start\")}\n        </button>\n\n        <button\n          className=\"backButton\"\n          onClick={onBack}\n          data-testid=\"back-to-home-button\"\n        >\n          {t(\"game.back\")}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default CharacterSelect;\n","import React, { useMemo } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { GameMap, MapType } from \"../../types/types\";\nimport { MAPS } from \"../../constant/map\";\nimport { useUnlockedMaps, useSelectedMap, useAppStore } from \"../../store\";\nimport styles from \"./index.module.css\";\n\ninterface MapSelectProps {\n  onConfirm: () => void;\n  onBack: () => void;\n}\n\nconst MAP_COLORS: Record<MapType, string> = {\n  chapter1: \"#4a6741\",\n  chapter2: \"#c9a227\",\n  chapter3: \"#5b7c99\",\n  chapter4: \"#7b4397\",\n  chapter5: \"#c94b4b\",\n  chapter6: \"#ffd700\",\n};\n\nconst MapSelect: React.FC<MapSelectProps> = ({ onConfirm, onBack }) => {\n  const [t] = useTranslation();\n  const unlockedMaps = useUnlockedMaps();\n\n  const mapId = useSelectedMap();\n\n  const selectedMap = useMemo(() => {\n    return useAppStore.getState().getSelectMap();\n  }, [mapId]);\n\n  const handleMapClick = (map: GameMap) => {\n    if (unlockedMaps.includes(map.id)) {\n      useAppStore.getState().selectMap(map.id);\n    }\n  };\n\n  const handleConfirm = () => {\n    if (selectedMap) {\n      useAppStore.getState().selectMap(selectedMap.id);\n      onConfirm();\n    }\n  };\n\n  return (\n    <div className=\"common-container\">\n      <h1 className={styles.title} data-testid=\"page-title\">\n        {t(\"maps.selectMap\")}\n      </h1>\n\n      <div className={styles.mapsGrid} data-testid=\"maps-grid\">\n        {MAPS.map((map) => {\n          const isUnlocked = unlockedMaps.includes(map.id);\n          const isSelected = selectedMap?.id === map.id;\n          const chapterColor = MAP_COLORS[map.id];\n\n          return (\n            <div\n              key={map.id}\n              className={`${styles.mapCard} ${isUnlocked ? styles.unlocked : styles.locked} ${isSelected ? styles.selected : \"\"}`}\n              data-testid={`map-card-${map.id}`}\n              onClick={() => handleMapClick(map)}\n            >\n              <div\n                className={styles.chapterBadge}\n                style={{ backgroundColor: chapterColor }}\n              >\n                {t(\"maps.selectMap\")} {map.chapter}\n              </div>\n\n              <div className={styles.mapName}>\n                {isUnlocked ? t(`maps.${map.id}.name`) : \"???\"}\n              </div>\n\n              {isUnlocked && (\n                <div className={styles.difficulty}>\n                  {\"★\".repeat(map.difficulty)}\n                </div>\n              )}\n\n              {!isUnlocked && (\n                <div className={styles.unlockCondition}>\n                  {t(`unlockConditions.${map.unlockCondition.type}`, {\n                    value: map.unlockCondition.value,\n                  })}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {selectedMap && (\n        <div className={styles.mapDetail} data-testid=\"map-details\">\n          <h2>{t(`maps.${selectedMap.id}.name`)}</h2>\n          <p className={styles.description}>\n            {t(`maps.${selectedMap.id}.description`)}\n          </p>\n          <div className={styles.difficultyInfo}>\n            <strong>{t(\"maps.difficulty\")}:</strong>{\" \"}\n            {\"★\".repeat(selectedMap.difficulty)}\n          </div>\n        </div>\n      )}\n\n      <div className=\"button-group\">\n        <button\n          className=\"confirmButton\"\n          onClick={handleConfirm}\n          disabled={!selectedMap}\n          data-testid=\"start-game-button\"\n        >\n          {t(\"game.start\")}\n        </button>\n        <button\n          className=\"backButton\"\n          onClick={onBack}\n          data-testid=\"back-to-home-button\"\n        >\n          {t(\"game.back\")}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default MapSelect;\n","import React, { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { PERMANENT_UPGRADES } from \"../../constant\";\nimport { useShopLevel, useTotalGold, useSaveStore } from \"../../store\";\nimport styles from \"./index.module.css\";\nimport type { PermanentUpgradeType } from \"../../types/\";\nimport { confirmModal } from \"../../util\";\n\ninterface ShopProps {\n  onBack: () => void;\n}\n\nconst ICONS_MAP: Record<PermanentUpgradeType, string> = {\n  attack: \"⚔️\",\n  health: \"❤️\",\n  armor: \"🛡️\",\n  luck: \"🍀\",\n  speed: \"⚡\",\n  expBonus: \"📈\",\n  critRate: \"🔫\",\n  magnetBonus: \"🧲\",\n  collectRange: \"🔍\",\n};\n\nconst Shop: React.FC<ShopProps> = ({ onBack }) => {\n  const [t] = useTranslation();\n  const [, setRefresh] = useState(0);\n  const totalGold = useTotalGold();\n\n  const save = useShopLevel();\n\n  const handlePurchase = (upgradeId: PermanentUpgradeType) => {\n    if (useSaveStore.getState().upgradePermanent(upgradeId)) {\n      setRefresh((prev) => prev + 1);\n    }\n  };\n\n  const handleResetUpgrades = () => {\n    if (confirmModal(t(\"shop.resetConfirm\"))) {\n      useSaveStore.getState().resetPermanentUpgrades();\n      setRefresh((prev) => prev + 1);\n    }\n  };\n\n  return (\n    <div className=\"common-container\">\n      <h1 data-testid=\"shop-title\">{t(\"shop.title\")}</h1>\n\n      <div className={styles.goldDisplay} data-testid=\"shop-gold-display\">\n        <span className={styles.goldIcon}>💰</span>\n        <span className={styles.goldAmount}>{totalGold}</span>\n      </div>\n\n      <div className={styles.upgradesGrid} data-testid=\"upgrades-grid\">\n        {PERMANENT_UPGRADES.map((upgrade) => {\n          const currentLevel = save[upgrade.id] || 0;\n          const cost = upgrade.cost(currentLevel);\n          const isMaxLevel = currentLevel >= upgrade.maxLevel;\n          const canAfford = totalGold >= cost;\n          const currentEffect = upgrade.effect(currentLevel);\n          const nextEffect = upgrade.effect(currentLevel + 1);\n\n          return (\n            <div\n              key={upgrade.id}\n              className={styles.upgradeCard}\n              data-testid={`upgrade-card-${upgrade.id}`}\n            >\n              <h3 className={styles.upgradeName}>\n                {ICONS_MAP[upgrade.id]} {t(`upgrades.${upgrade.id}.name`)}\n              </h3>\n              <p className={styles.upgradeDescription}>\n                {t(`upgrades.${upgrade.id}.description`, {\n                  value: upgrade.effect(1),\n                })}\n              </p>\n\n              <div className={styles.upgradeLevel}>\n                <span className={styles.levelLabel}>\n                  {t(\"shop.currentLevel\", { level: currentEffect })}:\n                </span>\n                <span className={styles.levelValue}>\n                  {currentLevel} / {upgrade.maxLevel}\n                </span>\n              </div>\n\n              <div className={styles.upgradeEffect}>\n                <span className={styles.effectLabel}>\n                  {t(\"shop.currentLevel\", { level: currentEffect })}:\n                </span>\n                <span className={styles.effectValue}>+{currentEffect}</span>\n              </div>\n\n              <div className={styles.upgradeNext}>\n                <span className={styles.nextLabel}>{t(\"game.levelUp\")}:</span>\n                <span className={styles.nextValue}>\n                  {isMaxLevel ? t(\"shop.maxLevel\") : `+${nextEffect}`}\n                </span>\n              </div>\n\n              <button\n                className=\"confirmButton\"\n                onClick={() => handlePurchase(upgrade.id)}\n                disabled={!canAfford || isMaxLevel}\n                data-testid={`purchase-button-${upgrade.id}`}\n              >\n                {isMaxLevel ? t(\"shop.maxLevel\") : `${cost} 💰`}\n              </button>\n            </div>\n          );\n        })}\n      </div>\n\n      <div className=\"button-group\">\n        <button\n          className=\"backButton\"\n          onClick={onBack}\n          data-testid=\"shop-back-button\"\n        >\n          {t(\"game.back\")}\n        </button>\n        <button\n          className=\"resetButton\"\n          onClick={handleResetUpgrades}\n          data-testid=\"reset-upgrades-button\"\n        >\n          {t(\"shop.resetUpgrades\")}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Shop;\n","/**\n * ScaleManager - Handles responsive scaling for different screen sizes\n * Following game development best practices for mobile and desktop support\n */\n\nimport { START_Z_INDEX } from \"../constant\";\nimport _ from \"lodash\";\n\nexport interface ScaleConfig {\n  // Base design dimensions (reference screen size)\n  baseWidth: number;\n  baseHeight: number;\n\n  // Calculated scale factors\n  scaleX: number;\n  scaleY: number;\n  scale: number; // Uniform scale (uses minimum to prevent stretching)\n\n  // UI scale (can be different from game object scale)\n  uiScale: number;\n}\n\nclass ScaleManagerClass {\n  private config: ScaleConfig = {\n    baseWidth: 1920,\n    baseHeight: 1080,\n    scaleX: 1,\n    scaleY: 1,\n    scale: 1,\n    uiScale: 1,\n  };\n\n  private minScale = 1;\n  private maxScale = 2;\n  private zIndex = START_Z_INDEX;\n\n  constructor() {\n    this.updateScale();\n\n    const onResize = _.throttle(() => {\n      this.updateScale();\n    }, 100);\n\n    window.addEventListener(\"resize\", onResize);\n    window.addEventListener(\"orientationchange\", () => {\n      this.updateScale();\n    });\n  }\n\n  getZIndex() {\n    this.zIndex = (this.zIndex + 1) % 100;\n    return this.zIndex;\n  }\n\n  public isMobile() {\n    return window.innerWidth < 768;\n  }\n\n  public isSmallMobile() {\n    return window.innerWidth < 480;\n  }\n\n  /**\n   * Update scale factors based on current screen size\n   */\n  public updateScale(): void {\n    // Calculate scale factors\n    this.config.scaleX = window.innerWidth / this.config.baseWidth;\n    this.config.scaleY = window.innerHeight / this.config.baseHeight;\n\n    // Use minimum scale to maintain aspect ratio without stretching\n    const rawScale = Math.min(this.config.scaleX, this.config.scaleY);\n    this.config.scale = Math.max(\n      this.minScale,\n      Math.min(this.maxScale, rawScale),\n    );\n\n    // UI scale can be slightly different for better readability\n    // On very small screens, increase UI scale relative to game objects\n    if (this.isSmallMobile()) {\n      // Small mobile devices\n      this.config.uiScale = this.config.scale * 1;\n    } else if (this.isMobile()) {\n      // Mobile devices\n      this.config.uiScale = this.config.scale * 1;\n    } else if (window.innerWidth < 1024) {\n      // Tablets\n      this.config.uiScale = this.config.scale * 1.1;\n    } else if (window.innerWidth < 1920) {\n      // Desktop\n      this.config.uiScale = this.config.scale * 1.2;\n    } else {\n      // Ultra-wide desktops\n      this.config.uiScale = this.config.scale * 1.4;\n    }\n\n    // Clamp UI scale\n    this.config.uiScale = Math.max(\n      this.minScale,\n      Math.min(this.maxScale, this.config.uiScale),\n    );\n  }\n\n  public getTitleSize(): string {\n    const scaledSize = Math.round(24 * this.config.uiScale);\n    return `${scaledSize}px`;\n  }\n\n  public getDefaultFont(): string {\n    return \"PingFang SC, Microsoft YaHei, SimSun, Arial, sans-serif\";\n  }\n\n  public getNameSize(): string {\n    const scaledSize = Math.round(18 * this.config.uiScale);\n    return `${scaledSize}px`;\n  }\n\n  public getDescSize(): string {\n    const scaledSize = Math.round(14 * this.config.uiScale);\n    return `${scaledSize}px`;\n  }\n\n  public scaleValue(baseSize: number): number {\n    return Math.round(baseSize * this.config.scale);\n  }\n\n  public UIScaleValue(baseSize: number): number {\n    return Math.round(baseSize * this.config.uiScale);\n  }\n\n  public getCameraZoom() {\n    return 1;\n  }\n}\n\n// Export singleton instance\nexport const scaleManager = new ScaleManagerClass();\n","import Phaser from \"phaser\";\nimport { scaleManager } from \"./ScaleManager\";\nimport type { CharacterType, ElixirEffectType } from \"../types\";\nimport type { GameScene } from \"./GameScene\";\n\n/**\n * Interface defining WASD keyboard controls\n */\nexport interface WASDKeys {\n  w?: Phaser.Input.Keyboard.Key;\n  a?: Phaser.Input.Keyboard.Key;\n  s?: Phaser.Input.Keyboard.Key;\n  d?: Phaser.Input.Keyboard.Key;\n}\n\n/**\n * Position interface representing x and y coordinates\n */\nexport interface Position {\n  x: number;\n  y: number;\n}\n\n/**\n * Player class handles player character behavior, stats, and interactions\n */\nexport class Player {\n  public sprite: Phaser.Physics.Arcade.Sprite;\n  public maxHealth: number;\n  public health: number;\n  public speed: number;\n  public level: number;\n  public experience: number;\n  public experienceToNextLevel: number;\n  public armor: number;\n  public critRate: number;\n  public expBonus: number;\n  public reviveCount: number;\n  public collectRange: number;\n  public magnetBonus: number;\n  public luck: number;\n  public scene: GameScene;\n  public attack: number;\n\n  /**\n   * Create a new player instance\n   * @param scene Game scene reference\n   * @param x Initial x position\n   * @param y Initial y position\n   * @param textureKey Character texture identifier\n   */\n  constructor(\n    scene: GameScene,\n    x: number,\n    y: number,\n    textureKey: CharacterType,\n  ) {\n    this.scene = scene;\n\n    // Get scaled sprite size\n    const spriteSize = scaleManager.scaleValue(48);\n\n    // Create player sprite with loaded texture\n    this.sprite = scene.physics.add.sprite(x, y, textureKey);\n    this.sprite.setDisplaySize(spriteSize, spriteSize);\n    // Set collision body to match sprite size\n    this.sprite.body?.setSize(spriteSize, spriteSize);\n\n    // Initialize player attributes\n    this.maxHealth = 100;\n    this.health = this.maxHealth;\n    this.speed = 150;\n    this.level = 1;\n    this.experience = 0;\n    this.experienceToNextLevel = 10;\n    this.armor = 0;\n    this.critRate = 0;\n    this.expBonus = 0;\n    this.reviveCount = 0;\n    this.collectRange = 0;\n    this.magnetBonus = 0;\n    this.luck = 0;\n    this.attack = 0;\n\n    // Set camera to follow with responsive zoom\n    scene.cameras.main.startFollow(this.sprite);\n    scene.cameras.main.setZoom(scaleManager.getCameraZoom());\n  }\n\n  /**\n   * Update player state and handle movement based on input\n   * @param cursors Optional keyboard cursor keys\n   * @param wasd Optional WASD keys\n   * @param joystickInput Optional joystick input values\n   */\n  public update(\n    cursors?: Phaser.Types.Input.Keyboard.CursorKeys,\n    wasd?: WASDKeys,\n    joystickInput?: { x: number; y: number },\n  ): void {\n    // Reset velocity\n    this.sprite.setVelocity(0);\n\n    // Initialize movement velocities\n    let velocityX = 0;\n    let velocityY = 0;\n\n    // Handle joystick input (higher priority for mobile)\n    if (joystickInput && (joystickInput.x !== 0 || joystickInput.y !== 0)) {\n      velocityX = joystickInput.x * this.speed;\n      velocityY = joystickInput.y * this.speed;\n    } else {\n      // Handle keyboard input\n      if (cursors?.left.isDown || wasd?.a?.isDown) {\n        velocityX = -this.speed;\n      } else if (cursors?.right.isDown || wasd?.d?.isDown) {\n        velocityX = this.speed;\n      }\n\n      if (cursors?.up.isDown || wasd?.w?.isDown) {\n        velocityY = -this.speed;\n      } else if (cursors?.down.isDown || wasd?.s?.isDown) {\n        velocityY = this.speed;\n      }\n\n      // Normalize diagonal movement speed to maintain consistent speed\n      if (velocityX !== 0 && velocityY !== 0) {\n        const diagonalFactor = 0.707; // 1/sqrt(2) to maintain same magnitude\n        velocityX *= diagonalFactor;\n        velocityY *= diagonalFactor;\n      }\n    }\n\n    // Apply calculated velocity\n    this.sprite.setVelocity(velocityX, velocityY);\n  }\n\n  /**\n   * Handle player taking damage with armor reduction\n   * @param damage Raw damage amount to apply\n   */\n  public takeDamage(damage: number): void {\n    // Apply armor reduction, minimum 1 damage\n    const actualDamage = Math.max(1, damage - this.armor);\n    this.health -= actualDamage;\n\n    // Apply damage visual feedback\n    this.sprite.setTint(0xff0000);\n    this.scene.time.delayedCall(100, () => {\n      this.sprite.clearTint();\n    });\n\n    // Check for player death\n    if (this.health <= 0) {\n      this.health = 0;\n      this.handleDeath();\n    }\n  }\n\n  /**\n   * Handle player death logic, including revival checks\n   */\n  private handleDeath(): void {\n    // Check if player can revive\n    if (this.reviveCount > 0) {\n      // Consume a revive\n      this.reviveCount -= 1;\n      // Fully restore health\n      this.health = this.maxHealth;\n\n      // Apply revival visual feedback\n      this.sprite.setTint(0xffff00);\n      this.scene.time.delayedCall(500, () => {\n        this.sprite.clearTint();\n      });\n      return;\n    }\n\n    // No revives left, trigger game over\n    this.scene.gameOver();\n  }\n\n  /**\n   * Add experience to player, applying any experience bonuses\n   */\n  public addExperience(amount: number): void {\n    // Apply experience bonus multiplier\n    const actualExp = Math.floor(amount * (1 + this.expBonus));\n    this.experience += actualExp;\n\n    // Check if player should level up\n    if (this.experience >= this.experienceToNextLevel) {\n      this.levelUp();\n    }\n  }\n\n  /**\n   * Handle player level up logic\n   */\n  private levelUp(): void {\n    this.level++;\n\n    // Carry over excess experience\n    this.experience -= this.experienceToNextLevel;\n\n    // Increase experience needed for next level (exponential scaling)\n    this.experienceToNextLevel = Math.floor(this.experienceToNextLevel * 1.5);\n\n    // Restore a portion of health on level up\n    this.health = Math.min(this.health + 20, this.maxHealth);\n\n    // Show level up selection menu\n    this.scene.showLevelUpMenu();\n  }\n\n  public upgrade(type: ElixirEffectType, value: number, value2: number = 0) {\n    switch (type) {\n      case \"health\":\n        this.health += value;\n        this.maxHealth += value2;\n        break;\n      case \"attack\":\n        this.attack += value;\n        break;\n      case \"armor\":\n        this.armor += value;\n        break;\n      case \"luck\":\n        this.luck += value;\n        break;\n      case \"speed\":\n        this.speed += value;\n        break;\n      case \"expBonus\":\n        this.expBonus += value;\n        break;\n      case \"critRate\":\n        this.critRate += value;\n        break;\n      case \"all\": {\n        const radio = 1 + value;\n        this.maxHealth *= radio;\n        this.health += this.maxHealth * value;\n        this.speed *= radio;\n        this.magnetBonus *= radio;\n        this.critRate *= radio;\n        this.expBonus *= radio;\n        this.luck *= radio;\n        this.armor *= radio;\n        this.attack *= radio;\n        break;\n      }\n      case \"revive\":\n        this.reviveCount += value;\n        break;\n      case \"magnetBonus\":\n        this.magnetBonus += value;\n        break;\n      case \"collectRange\":\n        this.collectRange += value;\n        break;\n    }\n  }\n}\n","import Phaser from \"phaser\";\nimport { scaleManager } from \"./ScaleManager\";\nimport { ENEMIES_DATA, ENEMY_SIZE } from \"../constant\";\nimport type { EnemyType } from \"../types\";\nimport type { GameScene } from \"./GameScene\";\nimport type { Position } from \"./player\";\n\n/**\n * Enemy class represents hostile entities in the game that target the player\n */\nexport class Enemy {\n  public sprite: Phaser.Physics.Arcade.Sprite;\n  public type: EnemyType;\n  public maxHealth: number;\n  public health: number;\n  public speed: number;\n  public damage: number;\n  public expValue: number;\n  public goldValue: number;\n  public isDead: boolean;\n  private scene: GameScene;\n\n  /**\n   * Create a new enemy instance\n   * @param scene Game scene reference\n   * @param x Initial x position\n   * @param y Initial y position\n   * @param enemyType Type of enemy to create\n   */\n  constructor(scene: GameScene, x: number, y: number, enemyType: EnemyType) {\n    this.scene = scene;\n    this.type = enemyType;\n    this.isDead = false;\n\n    // Get enemy data from constants\n    const enemyData = ENEMIES_DATA[enemyType];\n\n    // Initialize properties from enemy data\n    this.maxHealth = enemyData.health;\n    this.health = this.maxHealth;\n    this.speed = enemyData.speed;\n    this.damage = enemyData.damage;\n    this.expValue = enemyData.xpValue;\n    this.goldValue = enemyData.goldValue;\n\n    // Create enemy sprite with loaded texture\n    this.sprite = scene.physics.add.sprite(x, y, enemyType);\n\n    // Set display size based on enemy rank with responsive scaling\n    const baseSize = ENEMY_SIZE[enemyData.rank];\n    const displaySize = scaleManager.scaleValue(baseSize);\n    this.sprite.setDisplaySize(displaySize, displaySize);\n\n    // Set collision body to match sprite size\n    this.sprite.body?.setSize(displaySize, displaySize);\n  }\n\n  /**\n   * Update enemy behavior - primarily movement towards player\n   * @param playerPos Current player position\n   */\n  public update(playerPos: Position): void {\n    if (this.isDead) return;\n\n    // Calculate direction vector towards player\n    const dx = playerPos.x - this.sprite.x;\n    const dy = playerPos.y - this.sprite.y;\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    // Normalize direction vector and apply speed\n    if (distance > 0) {\n      this.sprite.setVelocity(\n        (dx / distance) * this.speed,\n        (dy / distance) * this.speed,\n      );\n    }\n  }\n\n  /**\n   * Apply damage to the enemy\n   * @param damage Amount of damage to apply\n   * @returns True if enemy was killed, false otherwise\n   */\n  public takeDamage(damage: number): boolean {\n    if (this.isDead) return false;\n\n    // Reduce health\n    this.health -= damage;\n\n    // Apply hit visual feedback\n    this.sprite.setTint(0xffffff);\n    this.scene.time.delayedCall(50, () => {\n      if (!this.isDead) {\n        this.sprite.clearTint();\n      }\n    });\n\n    // Check if enemy was killed\n    if (this.health <= 0) {\n      this.handleDeath();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Set enemy velocity\n   * @param x X component of velocity\n   * @param y Y component of velocity\n   */\n  public setVelocity(x: number, y: number): void {\n    if (this.sprite.body && \"setVelocity\" in this.sprite.body) {\n      this.sprite.body.setVelocity(x, y);\n    }\n  }\n\n  /**\n   * Handle enemy death logic\n   */\n  private handleDeath(): void {\n    if (this.isDead) return;\n    this.isDead = true;\n\n    // Spawn experience points at enemy position\n    this.scene.spawnExperience(this.sprite.x, this.sprite.y, this.expValue);\n\n    // Clean up sprite\n    this.sprite.destroy();\n  }\n\n  /**\n   * Explicitly destroy the enemy\n   */\n  public destroy(): void {\n    this.sprite?.destroy();\n  }\n}\n\n/**\n * EnemySpawner class handles spawning and managing enemy waves following Vampire Survivors style spawning rules\n */\nexport class EnemySpawner {\n  private scene: GameScene;\n  private enemies: Enemy[];\n  private spawnTimer: number;\n  private spawnInterval: number;\n  private baseSpawnInterval: number;\n  private enemiesPerWave: number;\n  private maxEnemiesOnScreen: number;\n  private difficultyTimer: number;\n  private availableEnemies: EnemyType[];\n  private minSpawnDistance: number;\n  private maxSpawnDistance: number;\n\n  /**\n   * Create a new enemy spawner\n   * @param scene Game scene reference\n   * @param availableEnemies Array of enemy types that can be spawned\n   */\n  constructor(scene: GameScene, availableEnemies: EnemyType[]) {\n    this.scene = scene;\n    this.enemies = [];\n    this.spawnTimer = 0;\n    this.baseSpawnInterval = 1500; // Base spawn interval: 1.5 seconds\n    this.spawnInterval = this.baseSpawnInterval;\n    this.enemiesPerWave = 2; // Start with 2 enemies per wave\n    this.maxEnemiesOnScreen = 100; // Max enemies on screen at once\n    this.difficultyTimer = 0;\n    this.availableEnemies =\n      availableEnemies.length > 0 ? availableEnemies : [\"wolf_minion\"];\n\n    // Spawn distance from player (just outside visible screen)\n    this.minSpawnDistance = 500; // Minimum spawn distance\n    this.maxSpawnDistance = 700; // Maximum spawn distance\n  }\n\n  /**\n   * Update spawner logic and all active enemies\n   * @param _time Current game time\n   * @param delta Time since last update in milliseconds\n   * @param playerPos Current player position\n   */\n  public update(_time: number, delta: number, playerPos: Position): void {\n    // Update all active enemies\n    this.enemies.forEach((enemy) => {\n      if (!enemy.isDead) {\n        enemy.update(playerPos);\n      }\n    });\n\n    // Clean up dead enemies to free resources\n    this.enemies = this.enemies.filter((enemy) => !enemy.isDead);\n\n    // Handle enemy spawning if below max limit\n    if (this.enemies.length < this.maxEnemiesOnScreen) {\n      this.spawnTimer += delta;\n      if (this.spawnTimer >= this.spawnInterval) {\n        this.spawnTimer = 0;\n        this.spawnWave(playerPos);\n      }\n    }\n\n    // Increase difficulty over time (Vampire Survivors style)\n    this.difficultyTimer += delta;\n    if (this.difficultyTimer >= 30000) {\n      // Every 30 seconds\n      this.difficultyTimer = 0;\n      this.increaseDifficulty();\n    }\n  }\n\n  /**\n   * Increase game difficulty by adjusting spawn parameters\n   */\n  private increaseDifficulty(): void {\n    // Increase enemies per wave (capped at 10)\n    this.enemiesPerWave = Math.min(10, this.enemiesPerWave + 1);\n\n    // Decrease spawn interval for faster spawning (minimum 500ms)\n    this.spawnInterval = Math.max(500, this.spawnInterval - 100);\n\n    // Increase max enemies on screen (capped at 300)\n    this.maxEnemiesOnScreen = Math.min(300, this.maxEnemiesOnScreen + 20);\n  }\n\n  /**\n   * Spawn a wave of enemies based on current game state\n   * @param playerPos Current player position\n   */\n  private spawnWave(playerPos: Position): void {\n    // Calculate actual spawn count based on game time (scales with minutes played)\n    const timeBasedMultiplier =\n      1 + Math.floor(this.scene.getPlayTime() / 60000); // +1 per minute\n\n    // Ensure we don't exceed max enemies on screen\n    const spawnCount = Math.min(\n      this.enemiesPerWave * timeBasedMultiplier,\n      this.maxEnemiesOnScreen - this.enemies.length,\n    );\n\n    // Spawn each enemy in the wave\n    for (let i = 0; i < spawnCount; i++) {\n      this.spawnEnemy(playerPos);\n    }\n  }\n\n  /**\n   * Spawn a single enemy at a random position around the player\n   * @param playerPos Current player position\n   */\n  private spawnEnemy(playerPos: Position): void {\n    // Calculate random spawn position outside visible screen\n    const angle = Math.random() * Math.PI * 2; // Random angle around player\n\n    // Random distance between min and max spawn distance\n    const distance =\n      this.minSpawnDistance +\n      Math.random() * (this.maxSpawnDistance - this.minSpawnDistance);\n\n    // Calculate spawn coordinates\n    const x = playerPos.x + Math.cos(angle) * distance;\n    const y = playerPos.y + Math.sin(angle) * distance;\n\n    // Select appropriate enemy type based on game progression\n    const enemyType = this.selectEnemyType();\n\n    // Create and add enemy\n    const enemy = new Enemy(this.scene, x, y, enemyType);\n    this.enemies.push(enemy);\n  }\n\n  /**\n   * Select enemy type based on game time and difficulty\n   * @returns EnemyType to spawn\n   */\n  private selectEnemyType(): EnemyType {\n    // Increase elite spawn chance as game progresses (capped at 30%)\n    const eliteChance = Math.min(0.3, this.scene.getPlayTime() / 300000);\n\n    // Filter enemies by rank for balanced spawning\n    const minions = this.availableEnemies.filter(\n      (type) => ENEMIES_DATA[type].rank === \"minion\",\n    );\n    const elites = this.availableEnemies.filter(\n      (type) => ENEMIES_DATA[type].rank === \"elite\",\n    );\n\n    // Decide whether to spawn elite or minion\n    const spawnElite = elites.length > 0 && Math.random() < eliteChance;\n\n    // Select appropriate enemy pool based on decision\n    const pool = spawnElite\n      ? elites\n      : minions.length > 0\n        ? minions\n        : this.availableEnemies;\n\n    // Randomly select from the determined pool\n    return pool[Math.floor(Math.random() * pool.length)];\n  }\n\n  /**\n   * Get all active (non-dead) enemies\n   * @returns Array of active enemies\n   */\n  public getEnemies(): Enemy[] {\n    return this.enemies.filter((enemy) => !enemy.isDead);\n  }\n\n  /**\n   * Clear all enemies from the spawner\n   */\n  public clear(): void {\n    // Destroy all enemy sprites\n    this.enemies.forEach((enemy) => enemy.destroy());\n    // Clear the enemy array\n    this.enemies = [];\n  }\n}\n","import Phaser from \"phaser\";\nimport { Player } from \"./player\";\nimport { Enemy } from \"./enemy\";\nimport { scaleManager } from \"./ScaleManager\";\nimport type { WeaponType } from \"../types\";\nimport i18n from \"../i18n\";\nimport {\n  MAX_SELECT_SIZE,\n  WEAPONS,\n  COLLECT_RANGE_BONUS,\n  RARITY_SIZE,\n  RARITY_DURATION,\n  RARITY_SPEED,\n  RARITY_DAMAGE,\n  RARITY_MAX_LEVEL,\n  ENABLE_DEBUG,\n} from \"../constant\";\nimport type { GameScene } from \"./GameScene\";\n\n/**\n * Configuration interface for weapon creation\n */\nexport interface WeaponConfig {\n  type: WeaponType;\n  isOrb?: boolean;\n}\n\n/**\n * Extended projectile sprite with additional weapon-related properties\n */\nexport interface ProjectileSprite extends Phaser.Physics.Arcade.Sprite {\n  damage: number;\n  piercing: number;\n  distance: number;\n}\n\n/**\n * Data structure for orb-type weapon projectiles\n */\nexport interface OrbData {\n  sprite: ProjectileSprite;\n  offset: number;\n}\n\n/**\n * Abstract base class for all weapons in the game\n * Provides common functionality and defines the interface for weapon implementations\n */\nexport abstract class Weapon {\n  protected scene: GameScene;\n  protected player: Player;\n  public level: number;\n  public maxLevel: number;\n  private _damage: number;\n  public coolDown: number;\n  private lastFired: number;\n  public type: WeaponType;\n  public orbs: OrbData[] = [];\n  protected projectileGroup: Phaser.Physics.Arcade.Group;\n  private collectRangeBonus: number = 0;\n  public projectileCount: number = 1;\n  public projectileSpeed: number;\n  public piercing: number = 1;\n  public isOrb: boolean = false;\n  public rotationSpeed = 0;\n  public rotationAngle = 0;\n  public rotationRadius = 0;\n  public armorBreak = 0;\n\n  /**\n   * Create a new weapon\n   * @param scene Game scene reference\n   * @param player Player reference\n   * @param config Weapon configuration\n   */\n  constructor(scene: GameScene, player: Player, config: WeaponConfig) {\n    const weaponData = WEAPONS[config.type];\n    if (!scene.textures.exists(config.type) || weaponData) {\n      console.error(\n        `Weapon texture '${config.type}' not found. Please ensure the SVG file is preloaded correctly.`,\n      );\n    }\n\n    this.scene = scene;\n    this.player = player;\n    this.level = 1;\n    this.maxLevel =\n      RARITY_MAX_LEVEL[weaponData.rarity] ?? RARITY_MAX_LEVEL.common;\n    this._damage = weaponData.baseDamage ?? 0;\n    this.coolDown = weaponData.attackSpeed ?? 0;\n    this.lastFired = 0;\n    this.type = config.type;\n    this.projectileGroup = scene.physics.add.group();\n    this.projectileSpeed = RARITY_SPEED[weaponData.rarity] ?? 0;\n    this.isOrb = config.isOrb ?? false;\n  }\n\n  public get projectiles(): ProjectileSprite[] {\n    return (this.projectileGroup?.children?.entries ||\n      []) as ProjectileSprite[];\n  }\n\n  public get damage(): number {\n    const isCrit =\n      this.player.critRate > 0 && Math.random() <= this.player.critRate;\n\n    const damage = this._damage + this.player.attack;\n\n    const finalDamage = isCrit ? damage * 1.5 : damage;\n\n    return finalDamage * (1 + this.armorBreak);\n  }\n\n  public set damage(value: number) {\n    this._damage = value;\n  }\n\n  /**\n   * Update weapon logic and handle firing\n   * @param time Current game time\n   * @param enemies Array of active enemies\n   */\n  public update(time: number, enemies: Enemy[]): void {\n    if (this.isOrb) {\n      this.rotationAngle += this.rotationSpeed * 0.016; // Assuming 60fps\n      const playerPos = this.scene.getPlayerPosition();\n\n      const radius = scaleManager.scaleValue(this.rotationRadius);\n\n      // Update each orb's position around the player\n      this.orbs.forEach((orb) => {\n        const adjustedAngle = this.rotationAngle + orb.offset;\n        orb.sprite.x = playerPos.x + Math.cos(adjustedAngle) * radius;\n        orb.sprite.y = playerPos.y + Math.sin(adjustedAngle) * radius;\n      });\n      return;\n    }\n\n    if (time - this.lastFired >= this.coolDown) {\n      this.scene.playPlayerFireSound();\n      this.fire(enemies);\n      this.lastFired = time;\n    }\n  }\n\n  /**\n   * Upgrade the weapon if not at max level\n   */\n  public upgrade(): void {\n    if (this.level < this.maxLevel) {\n      this.level++;\n      this._damage += RARITY_DAMAGE[WEAPONS[this.type].rarity];\n      this.applyUpgrade();\n\n      this.orbs.forEach((orb) => {\n        orb.sprite.damage = this.damage;\n      });\n      this.projectiles.forEach((item) => {\n        const projectile = item as ProjectileSprite;\n        projectile.damage = this.damage;\n      });\n    }\n  }\n\n  /**\n   * Apply weapon-specific upgrades - must be implemented by subclasses\n   */\n  protected abstract applyUpgrade(): void;\n\n  /**\n   * Get all enemies within a specified range of the player\n   */\n  protected getEnemiesInRange(enemies: Enemy[], range: number): Enemy[] {\n    if (enemies.length === 0) return [];\n\n    const playerPos = this.scene.getPlayerPosition();\n\n    return enemies.filter((enemy) => {\n      const distance = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n\n      return distance <= range;\n    });\n  }\n\n  /**\n   * Get the player's movement angle based on velocity\n   * Returns 0 if player is not moving\n   * @returns Angle in radians\n   */\n  protected getPlayerAngle(): number {\n    const velocity = this.player.sprite.body?.velocity;\n    return velocity && (velocity.x !== 0 || velocity.y !== 0)\n      ? Math.atan2(velocity.y, velocity.x)\n      : 0;\n  }\n\n  protected createProjectile(x?: number): ProjectileSprite {\n    const playerPos = this.scene.getPlayerPosition();\n\n    const weaponData = WEAPONS[this.type];\n\n    const projectileSize = scaleManager.scaleValue(\n      RARITY_SIZE[weaponData.rarity],\n    );\n\n    let projectile: ProjectileSprite;\n\n    let distance = 20;\n\n    if (this.isOrb) {\n      distance = 25;\n      projectile = this.scene.physics.add.sprite(\n        0,\n        0,\n        this.type,\n      ) as ProjectileSprite;\n    } else {\n      projectile = this.projectileGroup.create(\n        x ?? playerPos.x,\n        playerPos.y,\n        this.type,\n      ) as ProjectileSprite;\n    }\n\n    projectile.setCircle(projectileSize / 2);\n    projectile.setDisplaySize(projectileSize, projectileSize);\n    projectile.damage = this.damage;\n    projectile.piercing = this.piercing;\n    projectile.distance = distance;\n\n    return projectile;\n  }\n\n  protected createOrbs(): void {\n    if (this.orbs.length === this.projectileCount) {\n      return;\n    }\n\n    this.scene.playPlayerFireSound();\n\n    this.orbs.forEach((orb) => orb.sprite.destroy());\n    this.orbs = [];\n\n    for (let i = 0; i < this.projectileCount; i++) {\n      const orb = this.createProjectile();\n      this.orbs.push({\n        sprite: orb,\n        offset: ((Math.PI * 2) / this.projectileCount) * i,\n      });\n    }\n  }\n\n  protected generateProjectileAngle(_index: number, enemy?: Enemy): number {\n    if (!enemy) {\n      return 0;\n    }\n    const playerPos = this.scene.getPlayerPosition();\n    return Phaser.Math.Angle.Between(\n      playerPos.x,\n      playerPos.y,\n      enemy.sprite.x,\n      enemy.sprite.y,\n    );\n  }\n\n  // Fire the weapon\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n    const weaponData = WEAPONS[this.type];\n    const duration = RARITY_DURATION[weaponData.rarity];\n\n    for (let i = 0; i < this.projectileCount; i++) {\n      const angle = this.generateProjectileAngle(i, enemies[i]);\n      const projectile = this.createProjectile(\n        playerPos.x + (i === 0 ? -10 : 10),\n      );\n\n      projectile.setVelocity(\n        Math.cos(angle) * this.projectileSpeed,\n        Math.sin(angle) * this.projectileSpeed,\n      );\n      projectile.setRotation(angle);\n\n      this.scene.time.delayedCall(duration, () => {\n        if (projectile.active) projectile.destroy();\n      });\n    }\n  }\n\n  protected updateCollectRange(): void {\n    this.player.collectRange -= this.collectRangeBonus;\n\n    this.collectRangeBonus = COLLECT_RANGE_BONUS * this.level;\n\n    this.player.collectRange += this.collectRangeBonus;\n  }\n\n  public destroy(): void {\n    this.projectileGroup.clear(true, true);\n    this.orbs.forEach((orb: OrbData) => orb.sprite.destroy());\n  }\n}\n\n/**\n * Golden Staff weapon class\n * Fires auto-targeting magic missiles at the closest enemy\n */\nexport class GoldenStaff extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"golden_staff\",\n    });\n  }\n\n  /**\n   * Apply upgrades when weapon levels up\n   */\n  protected applyUpgrade(): void {\n    // Decrease cool down with each level (capped at 300ms)\n    this.coolDown = Math.max(300, this.coolDown - 100);\n\n    // Increase piercing at specific levels\n    if (this.level >= 3) {\n      this.piercing = 2; // Can pierce through 2 enemies at level 3\n    }\n    if (this.level >= 5) {\n      this.piercing = 3; // Can pierce through 3 enemies at max level\n    }\n  }\n}\n\n/**\n * Fireproof Cloak weapon class\n * Creates rotating fire orbs around the player that deal damage to nearby enemies\n */\nexport class FireproofCloak extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"fireproof_cloak\",\n      isOrb: true,\n    });\n    this.rotationRadius = 80;\n    this.rotationSpeed = 2; // Initial rotation speed\n\n    // Initialize orbs on creation\n    this.createOrbs();\n  }\n\n  /**\n   * Apply upgrades when weapon levels up\n   */\n  protected applyUpgrade(): void {\n    // Level-based upgrades\n    if (this.level === 2) {\n      // Add second orb at level 2\n      this.projectileCount = 2;\n      this.createOrbs();\n    } else if (this.level === 3) {\n      // Increase radius at level 3\n      this.rotationRadius = 100;\n    } else if (this.level === 4) {\n      // Add third orb at level 4\n      this.projectileCount = 3;\n      this.createOrbs();\n    } else if (this.level === 5) {\n      // Increase rotation speed at max level\n      this.rotationSpeed = 3;\n    }\n  }\n}\n\n/**\n * Ruyi Staff weapon class\n * Ultimate form of Golden Staff with enhanced power\n * Creates high damage projectiles with piercing capability\n */\nexport class RuyiStaff extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"ruyi_staff\",\n    });\n    this.piercing = 3; // Can pierce through 3 enemies initially\n  }\n\n  /**\n   * Apply upgrades when weapon levels up\n   * Enhances damage, reduces cool down, increases projectile count, and improves piercing\n   */\n  protected applyUpgrade(): void {\n    // Reduce cool down with a minimum of 500ms\n    this.coolDown = Math.max(500, this.coolDown - 50);\n\n    // Add second projectile at level 3\n    if (this.level >= 3) this.projectileCount = 2;\n\n    // Further increase piercing capability at max level\n    if (this.level >= 5) this.piercing = 5;\n  }\n}\n\n/**\n * Fire Lance weapon class\n * Fast piercing spear that travels quickly and can pierce through multiple enemies\n * at higher levels\n */\nexport class FireLance extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"fire_lance\",\n    });\n    this.piercing = 2; // Can pierce through 2 enemies initially\n  }\n\n  /**\n   * Apply upgrades when weapon levels up\n   * Enhances damage, piercing, speed, and reduces cool down\n   */\n  protected applyUpgrade(): void {\n    // Reduce cool down with a minimum of 600ms\n    this.coolDown = Math.max(600, this.coolDown - 150);\n\n    // Increase piercing capability at level 3\n    if (this.level >= 3) this.piercing = 3;\n\n    // Increase speed at max level\n    if (this.level >= 5) this.projectileSpeed = 600;\n  }\n}\n\n// Wind Tamer - Area damage pearl\nexport class WindTamer extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"wind_tamer\",\n      isOrb: true,\n    });\n    this.rotationSpeed = 2;\n    this.rotationRadius = 60;\n    this.createOrbs();\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.rotationSpeed = 3;\n    if (this.level >= 3) {\n      this.rotationRadius = 80;\n    }\n    if (this.level >= 4) this.rotationSpeed = 4;\n    if (this.level >= 5) {\n      this.projectileCount = 2;\n      this.createOrbs();\n    }\n  }\n}\n\n// Violet Bell - Sound wave weapon\nexport class VioletBell extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"violet_bell\",\n    });\n    this.projectileCount = 3;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n    const angles = [];\n\n    for (let i = 0; i < this.projectileCount; i++) {\n      angles.push((Math.PI * 2 * i) / this.projectileCount);\n    }\n\n    angles.forEach(() => {\n      const wave = this.scene.add.circle(\n        playerPos.x,\n        playerPos.y,\n        20,\n        0x9370db,\n        0.3,\n      );\n\n      this.scene.tweens.add({\n        targets: wave,\n        radius: 150,\n        alpha: 0,\n        duration: 1000,\n        ease: \"Power2\",\n        onUpdate: () => {\n          enemies.forEach((enemy) => {\n            const dist = Phaser.Math.Distance.Between(\n              wave.x,\n              wave.y,\n              enemy.sprite.x,\n              enemy.sprite.y,\n            );\n            if (dist <= wave.radius && dist >= wave.radius - 20) {\n              enemy.takeDamage(this.damage);\n            }\n          });\n        },\n        onComplete: () => wave.destroy(),\n      });\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.projectileCount = 4;\n    if (this.level >= 3) this.coolDown = 1200;\n    if (this.level >= 4) this.projectileCount = 5;\n    if (this.level >= 5) this.coolDown = 1000;\n  }\n}\n\n// Twin Blades - Fast dual strike\nexport class TwinBlades extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"twin_blades\",\n    });\n    this.projectileCount = 2;\n  }\n\n  protected applyUpgrade(): void {\n    this.coolDown = Math.max(400, this.coolDown - 100);\n    if (this.level >= 5) this.projectileSpeed += 150;\n  }\n}\n\n// Mace - Heavy damage weapon\nexport class Mace extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"mace\",\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 3) this.coolDown = 1500;\n    if (this.level >= 5) this.damage += 5;\n  }\n}\n\n// Bull Horns - Charge attack\nexport class BullHorns extends Weapon {\n  private chargeRadius: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"bull_horns\",\n    });\n    this.chargeRadius = 150;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Create charge effect\n    const circle = this.scene.add.circle(\n      playerPos.x,\n      playerPos.y,\n      this.chargeRadius,\n      0x8b0000,\n      0.3,\n    );\n\n    this.getEnemiesInRange(enemies, this.chargeRadius).forEach((enemy) => {\n      enemy.takeDamage(this.damage);\n      const angle = Phaser.Math.Angle.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n      enemy.setVelocity(Math.cos(angle) * 300, Math.sin(angle) * 300);\n    });\n\n    this.scene.tweens.add({\n      targets: circle,\n      alpha: 0,\n      duration: 500,\n      onComplete: () => circle.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.chargeRadius = 180;\n    if (this.level >= 3) this.coolDown = 2000;\n    if (this.level >= 4) this.chargeRadius = 200;\n    if (this.level >= 5) this.damage += 5;\n  }\n}\n\n// Thunder Drum - Lightning strikes\nexport class ThunderDrum extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"thunder_drum\",\n    });\n    this.projectileCount = 3;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const targets = enemies\n      .sort(() => Math.random() - 0.5)\n      .slice(0, this.projectileCount);\n\n    targets.forEach((target) => {\n      // Lightning strike effect\n      const lightning = this.scene.add.image(\n        target.sprite.x,\n        target.sprite.y,\n        this.type,\n      );\n\n      lightning.setScale(2);\n\n      this.scene.tweens.add({\n        targets: lightning,\n        alpha: 0,\n        duration: 300,\n        onComplete: () => {\n          lightning.destroy();\n          target.takeDamage(this.damage);\n        },\n      });\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.projectileCount = 4;\n    if (this.level >= 3) this.coolDown = 1300;\n    if (this.level >= 4) this.projectileCount = 5;\n    if (this.level >= 5) this.damage += 5;\n  }\n}\n\n// Ice Needle - Slowing projectiles\nexport class IceNeedle extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"ice_needle\",\n    });\n    this.projectileCount = 3;\n  }\n\n  protected generateProjectileAngle(i: number): number {\n    return ((Math.PI * 2) / this.projectileCount) * i;\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.projectileCount = 4;\n    if (this.level >= 3) this.coolDown = 700;\n    if (this.level >= 4) this.projectileCount = 5;\n    if (this.level >= 5) this.projectileSpeed += 100;\n  }\n}\n\n// Wind Fire Wheels - Dual spinning wheels\nexport class WindFireWheels extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"wind_fire_wheels\",\n      isOrb: true,\n    });\n    this.projectileCount = 2;\n    this.rotationRadius = 70;\n    this.rotationSpeed = 4;\n    this.createOrbs();\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.rotationSpeed = 5;\n    if (this.level >= 3) this.rotationRadius = 90;\n    if (this.level >= 4) this.rotationSpeed = 6;\n    if (this.level >= 5) this.projectileCount = 3;\n  }\n}\n\n// Jade Purity Bottle - Suction and damage\nexport class JadePurityBottle extends Weapon {\n  private pullRadius: number;\n  private pullStrength: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"jade_purity_bottle\",\n    });\n    this.pullRadius = 200;\n    this.pullStrength = 150;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Create bottle effect\n    const bottle = this.scene.add.circle(\n      playerPos.x,\n      playerPos.y,\n      30,\n      0x7fffd4,\n      0.6,\n    );\n\n    enemies.forEach((enemy) => {\n      const distance = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n\n      if (distance < this.pullRadius) {\n        // Pull enemies towards player\n        const angle = Phaser.Math.Angle.Between(\n          enemy.sprite.x,\n          enemy.sprite.y,\n          playerPos.x,\n          playerPos.y,\n        );\n\n        enemy.setVelocity(\n          Math.cos(angle) * this.pullStrength,\n          Math.sin(angle) * this.pullStrength,\n        );\n\n        if (distance < 80) {\n          enemy.takeDamage(this.damage);\n        }\n      }\n    });\n\n    this.scene.tweens.add({\n      targets: bottle,\n      radius: 50,\n      alpha: 0,\n      duration: 1500,\n      onComplete: () => bottle.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.pullRadius = 250;\n    if (this.level >= 3) this.pullStrength = 200;\n    if (this.level >= 4) this.coolDown = 1800;\n    if (this.level >= 5) this.damage += 5;\n  }\n}\n\n// Golden Rope - Binding weapon\nexport class GoldenRope extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"golden_rope\",\n    });\n    this.projectileCount = 2;\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.projectileCount = 3;\n    if (this.level >= 4) this.projectileCount = 4;\n    if (this.level >= 5) this.coolDown = 1000;\n  }\n}\n\n// Plantain Fan - Wind blast\nexport class PlantainFan extends Weapon {\n  private fanAngle: number;\n  private fanRange: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"plantain_fan\",\n    });\n    this.fanAngle = Math.PI / 3;\n    this.fanRange = 250;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    const nearest = enemies[0];\n    if (!nearest) {\n      return;\n    }\n\n    const targetAngle = Phaser.Math.Angle.Between(\n      playerPos.x,\n      playerPos.y,\n      nearest.sprite.x,\n      nearest.sprite.y,\n    );\n\n    // Create fan wind effect\n    const graphics = this.scene.add.graphics();\n    graphics.fillStyle(0x87ceeb, 0.4);\n    graphics.slice(\n      playerPos.x,\n      playerPos.y,\n      this.fanRange,\n      targetAngle - this.fanAngle / 2,\n      targetAngle + this.fanAngle / 2,\n      false,\n    );\n    graphics.fillPath();\n\n    enemies.forEach((enemy) => {\n      const distance = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n      const angle = Phaser.Math.Angle.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n\n      const angleDiff = Math.abs(Phaser.Math.Angle.Wrap(angle - targetAngle));\n\n      if (distance < this.fanRange && angleDiff < this.fanAngle / 2) {\n        enemy.takeDamage(this.damage);\n\n        enemy.setVelocity(Math.cos(angle) * 400, Math.sin(angle) * 400);\n      }\n    });\n\n    this.scene.tweens.add({\n      targets: graphics,\n      alpha: 0,\n      duration: 800,\n      onComplete: () => graphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 2) this.fanAngle = Math.PI / 2.5;\n    if (this.level >= 3) this.fanRange = 300;\n    if (this.level >= 4) this.coolDown = 2500;\n    if (this.level >= 5) this.fanAngle = Math.PI / 2;\n  }\n}\n\n// Three Pointed Blade - Erlang Shen weapon\nexport class ThreePointedBlade extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"three_pointed_blade\",\n    });\n    this.projectileCount = 3;\n  }\n\n  protected generateProjectileAngle(i: number): number {\n    return this.getPlayerAngle() + ((i - 1) * Math.PI) / 6;\n  }\n\n  protected applyUpgrade(): void {\n    this.coolDown = Math.max(600, this.coolDown - 100);\n    if (this.level >= 4) this.projectileCount = 5;\n  }\n}\n\n// Nine Ring Staff - Tang Monk/Sha Monk's weapon\nexport class NineRingStaff extends Weapon {\n  private soundWaveRadius: number;\n  private stunDuration: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"nine_ring_staff\",\n    });\n    this.soundWaveRadius = scaleManager.scaleValue(150);\n    this.stunDuration = 1000;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Create sound wave circle effect\n    const graphics = this.scene.add.graphics();\n    graphics.lineStyle(4, 0xffd700, 1);\n    graphics.strokeCircle(0, 0, this.soundWaveRadius);\n    graphics.setPosition(playerPos.x, playerPos.y);\n\n    this.getEnemiesInRange(enemies, this.soundWaveRadius).forEach((enemy) => {\n      enemy.takeDamage(this.damage);\n\n      const originalSpeed = enemy.speed;\n      enemy.speed *= 0.3;\n      this.scene.time.delayedCall(this.stunDuration, () => {\n        enemy.speed = originalSpeed;\n      });\n    });\n\n    // Sound wave spreading animation\n    this.scene.tweens.add({\n      targets: graphics,\n      scaleX: 1.5,\n      scaleY: 1.5,\n      alpha: 0,\n      duration: 500,\n      onComplete: () => graphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.soundWaveRadius += scaleManager.scaleValue(20);\n    if (this.level >= 3) this.stunDuration = 1500;\n    if (this.level >= 5) this.coolDown = 1200;\n  }\n}\n\n// Crescent Blade - Sha Monk's crescent shovel\nexport class CrescentBlade extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"crescent_blade\",\n    });\n    this.projectileCount = 2;\n  }\n\n  protected generateProjectileAngle(i: number): number {\n    return this.getPlayerAngle() + ((i - 0.5) * Math.PI) / 4;\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 30;\n    if (this.level >= 3) this.projectileCount = 3;\n    if (this.level >= 5) this.projectileCount = 4;\n  }\n}\n\n// Iron Cudgel - Bull Demon King's weapon\nexport class IronCudgel extends Weapon {\n  private smashRadius: number;\n  private knockbackForce: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"iron_cudgel\",\n    });\n    this.smashRadius = scaleManager.scaleValue(120);\n    this.knockbackForce = 500;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Heavy strike on the ground, creating a huge shockwave\n    const graphics = this.scene.add.graphics();\n    graphics.fillStyle(0x8b4513, 0.6);\n    graphics.fillCircle(0, 0, this.smashRadius);\n    graphics.setPosition(playerPos.x, playerPos.y);\n\n    this.getEnemiesInRange(enemies, this.smashRadius).forEach((enemy) => {\n      enemy.takeDamage(this.damage);\n\n      const angle = Phaser.Math.Angle.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n      enemy.setVelocity(\n        Math.cos(angle) * this.knockbackForce,\n        Math.sin(angle) * this.knockbackForce,\n      );\n    });\n\n    this.scene.tweens.add({\n      targets: graphics,\n      scaleX: 1.8,\n      scaleY: 1.8,\n      alpha: 0,\n      duration: 600,\n      onComplete: () => graphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.smashRadius += scaleManager.scaleValue(15);\n    this.knockbackForce += 50;\n    if (this.level >= 5) this.coolDown = 1700;\n  }\n}\n\n// Seven Star Sword - Daoist weapon\nexport class SevenStarSword extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"seven_star_sword\",\n      isOrb: true,\n    });\n    this.projectileCount = 3;\n    this.rotationRadius = 90;\n    this.createOrbs();\n  }\n\n  public update(time: number): void {\n    const playerPos = this.scene.getPlayerPosition();\n    const rotation = (time / 1000) * 3;\n\n    const radius = scaleManager.scaleValue(this.rotationRadius);\n\n    this.orbs.forEach((orb) => {\n      const angle = rotation + orb.offset;\n      orb.sprite.x = playerPos.x + Math.cos(angle) * radius;\n      orb.sprite.y = playerPos.y + Math.sin(angle) * radius;\n      orb.sprite.setRotation(angle + Math.PI / 2);\n    });\n  }\n  protected applyUpgrade(): void {\n    this.rotationRadius += 10;\n    if (this.level >= 3) {\n      this.projectileCount = 5;\n      this.createOrbs();\n    }\n    if (this.level >= 5) {\n      this.projectileCount = 7;\n      this.createOrbs();\n    }\n  }\n}\n\n// Ginseng Fruit - Special recovery type\nexport class GinsengFruit extends Weapon {\n  private healAmount: number;\n  private maxHealthBonus: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"ginseng_fruit\",\n    });\n    this.healAmount = 20;\n    this.maxHealthBonus = 0;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    // Heal player\n    const currentHealth = this.player.health;\n    const maxHealth = this.player.maxHealth;\n    const newHealth = Math.min(currentHealth + this.healAmount, maxHealth);\n    this.player.health = newHealth;\n\n    // Create healing effect\n    const playerPos = this.scene.getPlayerPosition();\n    const graphics = this.scene.add.graphics();\n    graphics.fillStyle(0x90ee90, 0.8);\n    graphics.fillCircle(0, 0, scaleManager.scaleValue(40));\n    graphics.setPosition(playerPos.x, playerPos.y);\n\n    this.scene.tweens.add({\n      targets: graphics,\n      scaleX: 2,\n      scaleY: 2,\n      alpha: 0,\n      duration: 1000,\n      onComplete: () => graphics.destroy(),\n    });\n\n    this.getEnemiesInRange(enemies, scaleManager.scaleValue(100)).forEach(\n      (enemy) => {\n        enemy.takeDamage(this.damage);\n      },\n    );\n  }\n\n  protected applyUpgrade(): void {\n    this.healAmount += 10;\n    if (this.level >= 2) this.maxHealthBonus = 20;\n    if (this.level >= 3) this.coolDown = 4000;\n    if (this.level >= 4) this.maxHealthBonus = 40;\n    if (this.level >= 5) this.healAmount = 100;\n\n    // Increase maximum health\n    if (this.maxHealthBonus > 0) {\n      this.player.maxHealth = this.player.maxHealth + this.maxHealthBonus;\n      this.maxHealthBonus = 0; // Only add once when upgrading\n    }\n  }\n}\n\n// Heaven Earth Circle - Nezha's weapon\nexport class HeavenEarthCircle extends Weapon {\n  private circleSpeed: number;\n  private returnDelay: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"heaven_earth_circle\",\n    });\n    this.circleSpeed = 450;\n    this.returnDelay = 1000;\n  }\n\n  protected fire(): void {\n    const targetAngle = this.getPlayerAngle();\n\n    const circle = this.createProjectile();\n\n    // Fly straight\n    circle.setVelocity(\n      Math.cos(targetAngle) * this.circleSpeed,\n      Math.sin(targetAngle) * this.circleSpeed,\n    );\n\n    // Return logic\n    this.scene.time.delayedCall(this.returnDelay, () => {\n      if (circle.active) {\n        const checkReturn = () => {\n          if (!circle.active) return;\n\n          const currentPlayerPos = this.scene.getPlayerPosition();\n          const dx = currentPlayerPos.x - circle.x;\n          const dy = currentPlayerPos.y - circle.y;\n          const distance = Math.sqrt(dx * dx + dy * dy);\n\n          if (distance < 30) {\n            circle.destroy();\n            return;\n          }\n\n          const returnAngle = Math.atan2(dy, dx);\n          circle.setVelocity(\n            Math.cos(returnAngle) * this.circleSpeed * 1.2,\n            Math.sin(returnAngle) * this.circleSpeed * 1.2,\n          );\n\n          this.scene.time.delayedCall(50, checkReturn);\n        };\n        checkReturn();\n      }\n    });\n\n    this.scene.time.delayedCall(3000, () => {\n      if (circle.active) circle.destroy();\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.circleSpeed += 50;\n    if (this.level >= 5) this.returnDelay = 1500;\n  }\n}\n\n// Red Armillary Sash - Nezha's weapon\nexport class RedArmillarySash extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"red_armillary_sash\",\n    });\n    this.projectileCount = 3;\n  }\n\n  protected generateProjectileAngle(i: number): number {\n    return this.getPlayerAngle() + ((i - 1) * Math.PI) / 4;\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 25;\n    if (this.level >= 3) this.projectileCount = 4;\n    if (this.level >= 5) this.projectileCount = 5;\n  }\n}\n\n// Purple Gold Gourd - Golden/Silver Horn's weapon\nexport class PurpleGoldGourd extends Weapon {\n  private absorbRadius: number;\n  private absorbDuration: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"purple_gold_gourd\",\n    });\n    this.absorbRadius = scaleManager.scaleValue(180);\n    this.absorbDuration = 2000;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Create absorption effect\n    const graphics = this.scene.add.graphics();\n    graphics.lineStyle(4, 0x9932cc, 1);\n    graphics.strokeCircle(0, 0, this.absorbRadius);\n    graphics.setPosition(playerPos.x, playerPos.y);\n\n    this.getEnemiesInRange(enemies, this.absorbRadius).forEach((enemy) => {\n      enemy.takeDamage(this.damage);\n\n      const angle = Phaser.Math.Angle.Between(\n        enemy.sprite.x,\n        enemy.sprite.y,\n        playerPos.x,\n        playerPos.y,\n      );\n      enemy.setVelocity(Math.cos(angle) * 200, Math.sin(angle) * 200);\n    });\n\n    this.scene.tweens.add({\n      targets: graphics,\n      scaleX: 0.5,\n      scaleY: 0.5,\n      alpha: 0,\n      duration: this.absorbDuration,\n      onComplete: () => graphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.absorbRadius += scaleManager.scaleValue(20);\n    if (this.level >= 3) this.absorbDuration = 1500;\n    if (this.level >= 5) this.coolDown = 2800;\n\n    // Increase collect range bonus with each level\n    this.updateCollectRange();\n  }\n}\n\n// Golden Rope Immortal - Immortality Binding Rope (Taishang Laojun)\nexport class GoldenRopeImmortal extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"golden_rope_immortal\",\n    });\n    this.projectileCount = 3;\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 30;\n    if (this.level >= 3) this.projectileCount = 4;\n    if (this.level >= 5) this.projectileCount = 5;\n  }\n}\n\n// Demon Revealing Mirror - Monster Revealing Mirror\nexport class DemonRevealingMirror extends Weapon {\n  private revealRadius: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"demon_revealing_mirror\",\n    });\n    this.revealRadius = scaleManager.scaleValue(200);\n    this.armorBreak = 0.5;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Create demon mirror aura\n    const graphics = this.scene.add.graphics();\n    graphics.lineStyle(3, 0xffffff, 1);\n    graphics.strokeCircle(0, 0, this.revealRadius);\n    graphics.setPosition(playerPos.x, playerPos.y);\n\n    this.getEnemiesInRange(enemies, this.revealRadius).forEach((enemy) => {\n      enemy.takeDamage(this.damage);\n\n      // Weakness marking effect\n      const marker = this.scene.add.graphics();\n      marker.lineStyle(2, 0xff0000, 1);\n      marker.strokeCircle(0, 0, 20);\n      marker.setPosition(enemy.sprite.x, enemy.sprite.y - 30);\n\n      this.scene.tweens.add({\n        targets: marker,\n        alpha: 0,\n        y: enemy.sprite.y - 50,\n        duration: 1000,\n        onComplete: () => marker.destroy(),\n      });\n    });\n\n    this.scene.tweens.add({\n      targets: graphics,\n      scaleX: 1.3,\n      scaleY: 1.3,\n      alpha: 0,\n      duration: 800,\n      onComplete: () => graphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.revealRadius += scaleManager.scaleValue(25);\n    if (this.level >= 2) this.armorBreak = 0.6;\n    if (this.level >= 3) this.armorBreak = 0.7;\n    if (this.level >= 5) this.armorBreak = 0.8;\n  }\n}\n\n// Sea Calming Needle - Ocean Pacifying Needle (Golden Cudgel's ultimate form)\nexport class SeaCalmingNeedle extends Weapon {\n  private sweepRange: number;\n  private sweepAngle: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"sea_calming_needle\",\n    });\n    this.sweepRange = scaleManager.scaleValue(300);\n    this.sweepAngle = Math.PI; // 180 degrees\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n    const targetAngle = this.getPlayerAngle();\n\n    // Create huge sweeping effect\n    const graphics = this.scene.add.graphics();\n    graphics.fillStyle(0xffd700, 0.5);\n\n    const startAngle = targetAngle - this.sweepAngle / 2;\n    const endAngle = targetAngle + this.sweepAngle / 2;\n\n    const isLeft = Math.random() < 0.5;\n\n    graphics.slice(\n      0,\n      0,\n      this.sweepRange,\n      isLeft ? -startAngle : startAngle,\n      isLeft ? -endAngle : endAngle,\n      false,\n    );\n    graphics.fillPath();\n    graphics.setPosition(playerPos.x, playerPos.y);\n\n    enemies.forEach((enemy) => {\n      const distance = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n      const angle = Phaser.Math.Angle.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n\n      const angleDiff = Math.abs(Phaser.Math.Angle.Wrap(angle - targetAngle));\n\n      if (distance < this.sweepRange && angleDiff < this.sweepAngle / 2) {\n        enemy.takeDamage(this.damage);\n\n        enemy.setVelocity(Math.cos(angle) * 600, Math.sin(angle) * 600);\n      }\n    });\n\n    this.scene.tweens.add({\n      targets: graphics,\n      alpha: 0,\n      scaleX: 1.2,\n      scaleY: 1.2,\n      duration: 600,\n      onComplete: () => graphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.sweepRange += scaleManager.scaleValue(30);\n    if (this.level >= 3) this.sweepAngle = Math.PI * 1.2;\n    if (this.level >= 5) this.coolDown = 1500;\n  }\n}\n\n// Eight Trigrams Furnace - Supreme Elder's weapon\nexport class EightTrigramsFurnace extends Weapon {\n  private furnaceRadius: number;\n  private burnDuration: number;\n  private burnDamagePerTick: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"eight_trigrams_furnace\",\n    });\n    this.furnaceRadius = scaleManager.scaleValue(250);\n    this.burnDuration = 5000; // 5 seconds burning duration\n    this.burnDamagePerTick = 5;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const playerPos = this.scene.getPlayerPosition();\n\n    // Create Eight Trigrams Furnace effect - eight fire pillars\n    const furnaceGraphics = this.scene.add.graphics();\n    furnaceGraphics.setPosition(playerPos.x, playerPos.y);\n\n    // Draw flames in eight directions\n    for (let i = 0; i < 8; i++) {\n      const angle = (i * Math.PI) / 4;\n      const x = Math.cos(angle) * this.furnaceRadius;\n      const y = Math.sin(angle) * this.furnaceRadius;\n\n      furnaceGraphics.fillStyle(0xff6600, 0.7);\n      furnaceGraphics.fillCircle(x, y, 30);\n    }\n\n    // Center flame\n    furnaceGraphics.fillStyle(0xff0000, 0.5);\n    furnaceGraphics.fillCircle(0, 0, this.furnaceRadius);\n\n    this.getEnemiesInRange(enemies, this.furnaceRadius).forEach((enemy) => {\n      enemy.takeDamage(this.damage);\n\n      // Apply continuous burning effect\n      const maxBurnTicks = Math.floor(this.burnDuration / 500);\n\n      this.scene.time.addEvent({\n        delay: 500,\n        repeat: maxBurnTicks - 1,\n        callback: () => {\n          enemy.takeDamage(this.burnDamagePerTick);\n        },\n      });\n    });\n\n    this.scene.tweens.add({\n      targets: furnaceGraphics,\n      alpha: 0,\n      scaleX: 1.3,\n      scaleY: 1.3,\n      duration: 1500,\n      onComplete: () => furnaceGraphics.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.burnDamagePerTick += 2;\n    if (this.level >= 3) this.furnaceRadius = scaleManager.scaleValue(300);\n    if (this.level >= 5) this.burnDuration = 7000;\n  }\n}\n\n// Dragon Staff - Guanyin's weapon\nexport class DragonStaff extends Weapon {\n  private tornadoRadius: number;\n  private pullStrength: number;\n\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"dragon_staff\",\n    });\n    this.tornadoRadius = scaleManager.scaleValue(220);\n    this.pullStrength = 150;\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    const closestEnemy = enemies[0];\n    if (!closestEnemy) return;\n\n    const targetX = closestEnemy.sprite.x;\n    const targetY = closestEnemy.sprite.y;\n\n    // Create tornado\n    const tornado = this.scene.add.graphics();\n    tornado.setPosition(targetX, targetY);\n\n    // Draw tornado spiral\n    for (let i = 0; i < 8; i++) {\n      const angle = (i * Math.PI) / 4 + this.scene.time.now * 0.01;\n      const radius = this.tornadoRadius * (1 - i / 10);\n      const x = Math.cos(angle) * radius;\n      const y = Math.sin(angle) * radius;\n\n      tornado.fillStyle(0x00ffff, 0.4 - i * 0.05);\n      tornado.fillCircle(x, y, 25);\n    }\n\n    // Tornado effect - continuous damage and pulling\n    const tornadoDuration = 3000;\n    const damageInterval = 300;\n    const damageTicks = tornadoDuration / damageInterval;\n\n    this.scene.time.addEvent({\n      delay: damageInterval,\n      repeat: damageTicks - 1,\n      callback: () => {\n        enemies.forEach((enemy) => {\n          const distance = Phaser.Math.Distance.Between(\n            targetX,\n            targetY,\n            enemy.sprite.x,\n            enemy.sprite.y,\n          );\n\n          if (distance < this.tornadoRadius) {\n            enemy.takeDamage(this.damage / damageTicks);\n\n            // Pull towards center\n            const angle = Phaser.Math.Angle.Between(\n              enemy.sprite.x,\n              enemy.sprite.y,\n              targetX,\n              targetY,\n            );\n\n            enemy.setVelocity(\n              Math.cos(angle) * this.pullStrength,\n              Math.sin(angle) * this.pullStrength,\n            );\n          }\n        });\n      },\n    });\n\n    this.scene.tweens.add({\n      targets: tornado,\n      rotation: Math.PI * 6,\n      alpha: 0,\n      duration: tornadoDuration,\n      onComplete: () => tornado.destroy(),\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.tornadoRadius += scaleManager.scaleValue(30);\n    if (this.level >= 3) this.pullStrength = 200;\n    if (this.level >= 5) this.coolDown = 1800;\n  }\n}\n\n// Seven Treasure Tree - Zhunti's magical tree\nexport class SevenTreasureTree extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"seven_treasure_tree\",\n    });\n    this.projectileCount = 7;\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 40;\n    if (this.level >= 3) this.projectileCount = 8;\n    if (this.level >= 5) this.coolDown = 2500;\n  }\n}\n\n// Immortal Slaying Blade - Lu Ya's weapon\nexport class ImmortalSlayingBlade extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"immortal_slaying_blade\",\n    });\n  }\n\n  protected fire(enemies: Enemy[]): void {\n    let target: Enemy = enemies[0];\n    for (const item of enemies) {\n      if (item.health > target.health) {\n        target = item;\n      }\n    }\n\n    if (!target) return;\n\n    super.fire([target]);\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 50;\n    if (this.level >= 5) this.coolDown = 3000;\n  }\n}\n\n// Diamond Snare - Supreme Elder's weapon\nexport class DiamondSnare extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"diamond_snare\",\n    });\n    this.armorBreak = 0.5; // Ignore 50% defense\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 50;\n    if (this.level >= 2) this.armorBreak = 0.6;\n    if (this.level >= 3) this.armorBreak = 0.7;\n    if (this.level >= 5) this.armorBreak = 1.0; // Level 5 ignores all defense\n\n    this.updateCollectRange();\n  }\n}\n\n// Exquisite Pagoda - Li Jing's Pagoda\nexport class ExquisitePagoda extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"exquisite_pagoda\",\n    });\n  }\n\n  protected applyUpgrade(): void {\n    if (this.level >= 3) this.projectileSpeed = 250;\n    if (this.level >= 5) this.projectileCount = 2;\n  }\n}\n\n// Nine Tooth Rake - Zhu Bajie's weapon\nexport class NineToothRake extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"nine_tooth_rake\",\n    });\n    this.projectileCount = 4;\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 20;\n    this.projectileCount = this.level + 4;\n    if (this.level >= 5) this.coolDown = 1200;\n  }\n}\n\n// Dragon Scale Sword - White Dragon Horse's weapon\nexport class DragonScaleSword extends Weapon {\n  constructor(scene: GameScene, player: Player) {\n    super(scene, player, {\n      type: \"dragon_scale_sword\",\n    });\n  }\n\n  protected applyUpgrade(): void {\n    this.projectileSpeed += 50;\n    if (this.level >= 2) this.projectileCount = 2;\n    if (this.level >= 4) this.projectileCount = 3;\n    if (this.level >= 5) {\n      this.projectileCount = 3;\n      this.coolDown = 900;\n    }\n  }\n}\n\n// Weapon types\nexport type WeaponClass =\n  | typeof GoldenStaff\n  | typeof RuyiStaff\n  | typeof FireLance\n  | typeof WindTamer\n  | typeof VioletBell\n  | typeof FireproofCloak\n  | typeof TwinBlades\n  | typeof Mace\n  | typeof BullHorns\n  | typeof ThunderDrum\n  | typeof IceNeedle\n  | typeof WindFireWheels\n  | typeof JadePurityBottle\n  | typeof GoldenRope\n  | typeof PlantainFan\n  | typeof ThreePointedBlade\n  | typeof NineRingStaff\n  | typeof CrescentBlade\n  | typeof IronCudgel\n  | typeof SevenStarSword\n  | typeof GinsengFruit\n  | typeof HeavenEarthCircle\n  | typeof RedArmillarySash\n  | typeof PurpleGoldGourd\n  | typeof GoldenRopeImmortal\n  | typeof DemonRevealingMirror\n  | typeof SeaCalmingNeedle\n  | typeof EightTrigramsFurnace\n  | typeof DragonStaff\n  | typeof SevenTreasureTree\n  | typeof ImmortalSlayingBlade\n  | typeof DiamondSnare\n  | typeof ExquisitePagoda\n  | typeof NineToothRake\n  | typeof DragonScaleSword;\nexport interface UpgradeOption {\n  type: \"upgrade\" | \"new\";\n  weapon?: Weapon;\n  weaponClass?: WeaponClass;\n  name: string;\n  description: string;\n}\n\nexport const WEAPON_MAP: Record<WeaponType, WeaponClass> = {\n  golden_staff: GoldenStaff,\n  fireproof_cloak: FireproofCloak,\n  ruyi_staff: RuyiStaff,\n  fire_lance: FireLance,\n  wind_tamer: WindTamer,\n  violet_bell: VioletBell,\n  twin_blades: TwinBlades,\n  mace: Mace,\n  bull_horns: BullHorns,\n  thunder_drum: ThunderDrum,\n  ice_needle: IceNeedle,\n  wind_fire_wheels: WindFireWheels,\n  jade_purity_bottle: JadePurityBottle,\n  golden_rope: GoldenRope,\n  plantain_fan: PlantainFan,\n  three_pointed_blade: ThreePointedBlade,\n  nine_ring_staff: NineRingStaff,\n  crescent_blade: CrescentBlade,\n  iron_cudgel: IronCudgel,\n  seven_star_sword: SevenStarSword,\n  ginseng_fruit: GinsengFruit,\n  heaven_earth_circle: HeavenEarthCircle,\n  red_armillary_sash: RedArmillarySash,\n  purple_gold_gourd: PurpleGoldGourd,\n  golden_rope_immortal: GoldenRopeImmortal,\n  demon_revealing_mirror: DemonRevealingMirror,\n  sea_calming_needle: SeaCalmingNeedle,\n  eight_trigrams_furnace: EightTrigramsFurnace,\n  dragon_staff: DragonStaff,\n  seven_treasure_tree: SevenTreasureTree,\n  immortal_slaying_blade: ImmortalSlayingBlade,\n  diamond_snare: DiamondSnare,\n  exquisite_pagoda: ExquisitePagoda,\n  nine_tooth_rake: NineToothRake,\n  dragon_scale_sword: DragonScaleSword,\n};\n\n// Weapon Manager\nexport class WeaponManager {\n  private scene: GameScene;\n  private player: Player;\n  private weapons: Weapon[];\n\n  constructor(scene: GameScene, player: Player) {\n    this.scene = scene;\n    this.player = player;\n    this.weapons = [];\n  }\n\n  public update(time: number, enemies: Enemy[]): void {\n    const playerPos = this.player.sprite;\n    const list = enemies.filter((e) => !e.isDead);\n    const sortedEnemies = list.sort((a, b) => {\n      const distA = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        a.sprite.x,\n        a.sprite.y,\n      );\n      const distB = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        b.sprite.x,\n        b.sprite.y,\n      );\n      return distA - distB;\n    });\n    this.weapons.forEach((weapon) => {\n      weapon.update(time, sortedEnemies);\n    });\n  }\n\n  public addWeapon(WeaponClass: WeaponClass): Weapon {\n    const weapon = new WeaponClass(this.scene, this.player);\n    this.weapons.push(weapon);\n    if (ENABLE_DEBUG) {\n      console.log(\"addWeapon\", weapon);\n    }\n\n    return weapon;\n  }\n\n  public hasWeapon(WeaponClass: WeaponClass): boolean {\n    return this.weapons.some((weapon) => weapon instanceof WeaponClass);\n  }\n\n  public getWeapon(WeaponClass: WeaponClass): Weapon | undefined {\n    return this.weapons.find((weapon) => weapon instanceof WeaponClass);\n  }\n\n  public getWeaponById(id: WeaponType): WeaponClass {\n    return WEAPON_MAP[id] || GoldenStaff;\n  }\n\n  /**\n   * Get all weapons managed by this manager\n   * @returns Array of all weapons\n   */\n  public getWeapons(): Weapon[] {\n    return this.weapons;\n  }\n\n  public getUpgradeOptions(): UpgradeOption[] {\n    const options: UpgradeOption[] = [];\n\n    // Upgrade options for existing weapons\n    this.weapons.forEach((weapon) => {\n      if (weapon.level < weapon.maxLevel) {\n        const name = i18n.t(`weapons.${weapon.type}.name`);\n        options.push({\n          type: \"upgrade\",\n          weapon: weapon,\n          name: i18n.t(\"weapons.upgradeToLevel\", {\n            name,\n            level: weapon.level + 1,\n          }),\n          description: i18n.t(\"weapons.upgrade\", { name }),\n        });\n      }\n    });\n\n    // New weapon options\n    Object.entries(WEAPON_MAP).forEach(([type, weaponClass]) => {\n      if (!this.hasWeapon(weaponClass)) {\n        options.push({\n          type: \"new\",\n          weaponClass: weaponClass,\n          name: i18n.t(`weapons.${type}.name`),\n          description: i18n.t(`weapons.${type}.description`),\n        });\n      }\n    });\n\n    // Randomly select 3 options\n    const shuffled = options.sort(() => Math.random() - 0.5);\n    return shuffled.slice(0, MAX_SELECT_SIZE);\n  }\n\n  public clear(): void {\n    this.weapons.forEach((weapon) => {\n      weapon.destroy();\n    });\n    this.weapons = [];\n  }\n}\n","import Phaser from \"phaser\";\nimport { Player } from \"./player\";\nimport { scaleManager } from \"./ScaleManager\";\nimport {\n  GEM_MAP,\n  DEFAULT_COLLECT_RADIUS,\n  DEFAULT_MAGNET_RADIUS,\n  DEFAULT_SPRITE_SIZE,\n} from \"../constant\";\nimport { useSaveStore } from \"../store\";\nimport type { GameScene } from \"./GameScene\";\n\ninterface Position {\n  x: number;\n  y: number;\n}\n\nexport type CollectibleType = \"coin\" | \"gem\";\n\n// Collectible item base class\nexport class CollectibleItem {\n  public sprite: Phaser.Physics.Arcade.Sprite;\n  public type: CollectibleType;\n  public value: number;\n  private scene: GameScene;\n  private magnetized: boolean;\n  private collectRadius: number;\n  private magnetRadius: number;\n\n  constructor(\n    scene: GameScene,\n    x: number,\n    y: number,\n    type: CollectibleType,\n    value: number = 0,\n  ) {\n    this.scene = scene;\n    this.type = type;\n    this.value = value;\n    this.magnetized = false;\n    this.collectRadius = DEFAULT_COLLECT_RADIUS;\n    this.magnetRadius = DEFAULT_MAGNET_RADIUS;\n\n    // Determine texture based on type and value\n    let textureName: string;\n    if (type === \"coin\") {\n      textureName = GEM_MAP.coin;\n    } else {\n      // Gem texture based on value\n      if (value >= 5) {\n        textureName = GEM_MAP.gemHigh;\n      } else if (value >= 3) {\n        textureName = GEM_MAP.gemMedium;\n      } else {\n        textureName = GEM_MAP.gemLow;\n      }\n    }\n\n    // Create sprite with responsive scaling\n    const itemSize = scaleManager.scaleValue(DEFAULT_SPRITE_SIZE);\n    this.sprite = scene.physics.add.sprite(x, y, textureName);\n    this.sprite.setDisplaySize(itemSize, itemSize);\n    // Set collision body to match sprite size\n    this.sprite.body?.setSize(itemSize, itemSize);\n  }\n\n  public update(\n    playerPos: Position,\n    collectRangeBonus: number = 0,\n    magnetBonus: number = 0,\n  ): boolean {\n    const dx = playerPos.x - this.sprite.x;\n    const dy = playerPos.y - this.sprite.y;\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    const collectBonusFactor = 1 + collectRangeBonus;\n    const magnetBonusFactor = 1 + magnetBonus;\n\n    // Adjust ranges based on bonuses\n    const adjustedCollectRadius = scaleManager.scaleValue(\n      this.collectRadius * collectBonusFactor,\n    );\n    const adjustedMagnetRadius = scaleManager.scaleValue(\n      this.magnetRadius * magnetBonusFactor,\n    );\n\n    // Collected\n    if (distance < adjustedCollectRadius) {\n      return true; // Return true to indicate collection\n    }\n\n    // Magnetic attraction\n    if (distance < adjustedMagnetRadius) {\n      this.magnetized = true;\n    }\n\n    if (this.magnetized) {\n      const speed = 300;\n      this.sprite.setVelocity((dx / distance) * speed, (dy / distance) * speed);\n    }\n\n    return false;\n  }\n\n  public collect(): void {\n    // Collection animation\n    this.scene.tweens.add({\n      targets: this.sprite,\n      alpha: 0,\n      scale: 1.5,\n      duration: 200,\n      onComplete: () => {\n        this.sprite.destroy();\n      },\n    });\n\n    // Handle coin collection immediately\n    if (this.type === \"coin\") {\n      useSaveStore.getState().addGold(this.value);\n    }\n  }\n\n  public destroy(): void {\n    this.sprite?.destroy();\n  }\n}\n\n// Experience manager\nexport class ExperienceManager {\n  private scene: GameScene;\n  private player: Player;\n  private collectibles: CollectibleItem[] = [];\n\n  constructor(scene: GameScene, player: Player) {\n    this.scene = scene;\n    this.player = player;\n  }\n\n  // Update all collectibles (gems and coins)\n  public update(): void {\n    const playerPos = this.scene.getPlayerPosition();\n    const collectRangeBonus = this.player?.collectRange || 0;\n    const magnetBonus = this.player?.magnetBonus || 0;\n    for (let i = this.collectibles.length - 1; i >= 0; i--) {\n      const collectible = this.collectibles[i];\n      if (collectible.update(playerPos, collectRangeBonus, magnetBonus)) {\n        // Item collected\n        if (collectible.type === \"gem\") {\n          this.player.addExperience(collectible.value);\n        }\n        collectible.collect();\n        this.collectibles.splice(i, 1);\n      }\n    }\n  }\n\n  // Spawn a gem at specified position with given value\n  public spawnGem(x: number, y: number, value: number): void {\n    const gem = new CollectibleItem(this.scene, x, y, \"gem\", value);\n    this.collectibles.push(gem);\n  }\n\n  // Spawn a gold coin at specified position with given value\n  public spawnCoin(x: number, y: number, value: number): void {\n    const coin = new CollectibleItem(this.scene, x, y, \"coin\", value);\n    this.collectibles.push(coin);\n  }\n\n  // Clear all collectibles\n  public clear(): void {\n    for (const collectible of this.collectibles) {\n      collectible.destroy();\n    }\n    this.collectibles = [];\n  }\n\n  // Collect all remaining items with animation\n  public collectAllItems(): Promise<void> {\n    if (this.collectibles.length === 0) {\n      return Promise.resolve();\n    }\n\n    let completedCount = 0;\n    const totalCollectibles = this.collectibles.length;\n\n    return new Promise((resolve) => {\n      for (const collectible of this.collectibles) {\n        const playerPos = this.scene.getPlayerPosition();\n        this.scene.tweens.add({\n          targets: collectible.sprite,\n          x: playerPos.x,\n          y: playerPos.y,\n          scale: 1.5,\n          duration: 2000,\n          ease: Phaser.Math.Easing.Quadratic.InOut,\n          onComplete: () => {\n            // Collect the item after animation completes\n            if (collectible.type === \"gem\") {\n              this.player.addExperience(collectible.value);\n            }\n            collectible.collect();\n\n            // Check if all animations are completed\n            completedCount++;\n            if (completedCount === totalCollectibles) {\n              resolve();\n            }\n          },\n        });\n      }\n    });\n  }\n}\n","import Phaser from \"phaser\";\nimport { useSettingStore } from \"../store\";\nimport type { GameScene } from \"./GameScene\";\n\n// Audio types following Vampire Survivors style\nexport enum SoundEffect {\n  PLAYER_HIT = \"player_hit\",\n  PLAYER_DEATH = \"player_death\",\n  PLAYER_FIRE = \"player_fire\",\n  LEVEL_UP = \"level_up\",\n  VICTORY_THEME = \"victory_theme\",\n}\n\n/**\n * Audio Manager - Handles all game audio (music and sound effects)\n * Following Vampire Survivors audio patterns\n */\nexport class AudioManager {\n  private scene: GameScene;\n  private isPlayerSoundEnabled = false;\n  private music: Phaser.Sound.BaseSound | null = null;\n\n  constructor(scene: GameScene) {\n    this.scene = scene;\n  }\n\n  /**\n   * Preload all audio assets\n   */\n  public static preloadAudio(scene: GameScene): void {\n    for (const key of Object.values(SoundEffect)) {\n      scene.load.audio(key, `assets/audio/${key}.wav`);\n    }\n  }\n\n  /**\n   * Play a sound effect\n   */\n  public playSfx(effect: SoundEffect): void {\n    const { musicEnabled, musicVolume } = useSettingStore.getState();\n\n    if (!musicEnabled || this.isPlayerSoundEnabled || musicVolume === 0) return;\n    this.isPlayerSoundEnabled = true;\n\n    try {\n      this.music = this.scene.sound.add(effect, {\n        volume: musicVolume,\n      });\n      this.music.play();\n\n      // Clean up after playing\n      this.music.once(\"complete\", () => {\n        this.stopMusic();\n      });\n      this.music.once(\"error\", (error: Error) => {\n        console.warn(`Sound effect error: ${effect}`, error);\n        this.stopMusic();\n      });\n    } catch (error) {\n      this.stopMusic();\n      console.warn(`Failed to play sound effect: ${effect}`, error);\n    }\n  }\n\n  public stopMusic(): void {\n    if (this.music) {\n      this.music.stop();\n      this.music.destroy();\n      this.music = null;\n    }\n    this.isPlayerSoundEnabled = false;\n  }\n}\n","import Phaser from \"phaser\";\nimport { scaleManager } from \"./ScaleManager\";\nimport type { GameScene } from \"./GameScene\";\n\nexport interface JoystickInput {\n  x: number; // -1 to 1\n  y: number; // -1 to 1\n}\n\n/**\n * Virtual Joystick for mobile/tablet touch controls\n * Follows best practices for mobile game input:\n * - Semi-transparent UI that doesn't block gameplay view\n * - Visual feedback with stick movement\n * - Normalized output values for consistent movement\n * - Responsive sizing based on screen size\n */\nexport class VirtualJoystick {\n  private scene: GameScene;\n  private base: Phaser.GameObjects.Graphics;\n  private stick: Phaser.GameObjects.Graphics;\n  private container: Phaser.GameObjects.Container;\n  private baseRadius: number;\n  private stickRadius: number;\n  private maxDistance: number;\n  private isActive: boolean = false;\n  private currentInput: JoystickInput = { x: 0, y: 0 };\n  private pointer: Phaser.Input.Pointer | null = null;\n\n  constructor(scene: GameScene, x: number, y: number) {\n    this.scene = scene;\n\n    // Responsive sizing\n    this.baseRadius = scaleManager.UIScaleValue(60);\n    this.stickRadius = scaleManager.UIScaleValue(30);\n    this.maxDistance = this.baseRadius - this.stickRadius;\n\n    // Create container\n    this.container = scene.add\n      .container(x, y)\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex())\n      .setAlpha(0.6);\n\n    // Create base (outer circle)\n    this.base = scene.add.graphics();\n    this.base.lineStyle(3, 0xffffff, 0.8);\n    this.base.fillStyle(0x000000, 0.3);\n    this.base.fillCircle(0, 0, this.baseRadius);\n    this.base.strokeCircle(0, 0, this.baseRadius);\n\n    // Create stick (inner circle)\n    this.stick = scene.add.graphics();\n    this.stick.lineStyle(2, 0xffffff, 0.8);\n    this.stick.fillStyle(0xffffff, 0.5);\n    this.stick.fillCircle(0, 0, this.stickRadius);\n    this.stick.strokeCircle(0, 0, this.stickRadius);\n\n    this.container.add([this.base, this.stick]);\n\n    // Setup touch input\n    this.setupInput();\n\n    // Hide by default (will be shown on touch devices)\n    this.container.setVisible(false);\n  }\n\n  private setupInput(): void {\n    // Make the base interactive\n    const hitArea = new Phaser.Geom.Circle(0, 0, this.baseRadius);\n    this.container.setInteractive(hitArea, Phaser.Geom.Circle.Contains);\n\n    // Handle pointer down\n    this.container.on(\"pointerdown\", (pointer: Phaser.Input.Pointer) => {\n      this.isActive = true;\n      this.pointer = pointer;\n      this.updateStickPosition(pointer);\n      this.container.setAlpha(0.9); // Increase opacity when active\n    });\n\n    // Handle pointer move\n    this.scene.input.on(\"pointermove\", (pointer: Phaser.Input.Pointer) => {\n      if (this.isActive && this.pointer === pointer) {\n        this.updateStickPosition(pointer);\n      }\n    });\n\n    // Handle pointer up\n    this.scene.input.on(\"pointerup\", (pointer: Phaser.Input.Pointer) => {\n      if (this.pointer === pointer) {\n        this.isActive = false;\n        this.pointer = null;\n        this.resetStick();\n        this.container.setAlpha(0.6); // Restore opacity\n      }\n    });\n  }\n\n  private updateStickPosition(pointer: Phaser.Input.Pointer): void {\n    // Get pointer position relative to container\n    const localX = pointer.x - this.container.x;\n    const localY = pointer.y - this.container.y;\n\n    // Calculate distance and angle\n    const distance = Math.sqrt(localX * localX + localY * localY);\n    const angle = Math.atan2(localY, localX);\n\n    // Clamp to max distance\n    const clampedDistance = Math.min(distance, this.maxDistance);\n\n    // Calculate stick position\n    const stickX = Math.cos(angle) * clampedDistance;\n    const stickY = Math.sin(angle) * clampedDistance;\n\n    // Update stick graphics\n    this.stick.clear();\n    this.stick.lineStyle(2, 0xffffff, 0.8);\n    this.stick.fillStyle(0xffffff, 0.5);\n    this.stick.fillCircle(stickX, stickY, this.stickRadius);\n    this.stick.strokeCircle(stickX, stickY, this.stickRadius);\n\n    // Calculate normalized input (-1 to 1)\n    this.currentInput.x = stickX / this.maxDistance;\n    this.currentInput.y = stickY / this.maxDistance;\n  }\n\n  private resetStick(): void {\n    // Reset stick to center\n    this.stick.clear();\n    this.stick.lineStyle(2, 0xffffff, 0.8);\n    this.stick.fillStyle(0xffffff, 0.5);\n    this.stick.fillCircle(0, 0, this.stickRadius);\n    this.stick.strokeCircle(0, 0, this.stickRadius);\n\n    // Reset input\n    this.currentInput.x = 0;\n    this.currentInput.y = 0;\n  }\n\n  public getInput(): JoystickInput {\n    return this.currentInput;\n  }\n\n  public isPressed(): boolean {\n    return this.isActive;\n  }\n\n  public show(): void {\n    this.container.setVisible(true);\n  }\n\n  public hide(): void {\n    this.container.setVisible(false);\n    if (this.isActive) {\n      this.resetStick();\n      this.isActive = false;\n    }\n  }\n\n  public setPosition(x: number, y: number): void {\n    this.container.setPosition(x, y);\n  }\n\n  public updateSize(): void {\n    // Update sizes based on current scale\n    const oldBaseRadius = this.baseRadius;\n    this.baseRadius = scaleManager.UIScaleValue(60);\n    this.stickRadius = scaleManager.UIScaleValue(30);\n    this.maxDistance = this.baseRadius - this.stickRadius;\n\n    // Update graphics\n    this.base.clear();\n    this.base.lineStyle(3, 0xffffff, 0.8);\n    this.base.fillStyle(0x000000, 0.3);\n    this.base.fillCircle(0, 0, this.baseRadius);\n    this.base.strokeCircle(0, 0, this.baseRadius);\n\n    this.resetStick();\n\n    // Update hit area\n    const hitArea = new Phaser.Geom.Circle(0, 0, this.baseRadius);\n    this.container.setInteractive(hitArea, Phaser.Geom.Circle.Contains);\n\n    // Adjust position if needed to maintain relative screen position\n    const scale = this.baseRadius / oldBaseRadius;\n    this.container.x *= scale;\n    this.container.y *= scale;\n  }\n\n  public destroy(): void {\n    this.container.destroy();\n  }\n}\n","import Phaser from \"phaser\";\nimport { WEAPONS, ELIXIRS, RARITY_COLORS, MAX_SELECT_SIZE } from \"../constant\";\nimport {\n  getRandomWeapons,\n  getRandomElixirs,\n  getAvailableCrafts,\n} from \"../util\";\nimport type { RewardOption } from \"../types\";\nimport { useAppStore, useSaveStore, useSettingStore } from \"../store\";\nimport i18n from \"../i18n\";\nimport { scaleManager } from \"./ScaleManager\";\n\nexport class RewardSelectionUI {\n  private scene: Phaser.Scene;\n  private uiElements: Phaser.GameObjects.GameObject[] = [];\n  private overlay: Phaser.GameObjects.Rectangle | null = null;\n  private refreshCost: number = 10; // Refresh cost in gold\n  private onSelectCallback?: (option: RewardOption) => void;\n\n  constructor(scene: Phaser.Scene) {\n    this.scene = scene;\n  }\n\n  public show(onSelect?: (option: RewardOption) => void): void {\n    if (!onSelect) {\n      return;\n    }\n\n    // Generate random options (mixed weapons and elixirs)\n    const options = this.generateOptions();\n\n    if (options.length === 0) {\n      return;\n    }\n\n    if (this.isVisible()) {\n      this.hide();\n    }\n\n    this.onSelectCallback = onSelect;\n\n    // Pause game\n    this.scene.physics.pause();\n\n    const centerX = this.scene.cameras.main.width / 2;\n    const centerY = this.scene.cameras.main.height / 2;\n\n    // Semi-transparent background overlay\n    this.overlay = this.scene.add\n      .rectangle(\n        centerX,\n        centerY,\n        this.scene.cameras.main.width,\n        this.scene.cameras.main.height,\n        0x000000,\n        0.85,\n      )\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    this.uiElements.push(this.overlay);\n\n    // Title\n    const title = this.scene.add\n      .text(\n        centerX,\n        centerY - scaleManager.UIScaleValue(220),\n        i18n.t(\"rewards.title\"),\n        {\n          fontSize: scaleManager.getTitleSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: \"#ffd700\",\n          fontStyle: \"bold\",\n          stroke: \"#000000\",\n          strokeThickness: 6,\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    this.uiElements.push(title);\n\n    // Create option buttons\n    this.createOptionButtons(centerX, centerY, options);\n\n    // Refresh button\n    this.createRefreshButton(centerX, centerY);\n\n    // Crafting hint\n    this.createCraftHint(centerX, centerY);\n  }\n\n  private generateOptions() {\n    const options: RewardOption[] = [];\n\n    if (Math.random() > 0.5) {\n      // Get random weapons\n      const randomWeapons = getRandomWeapons(MAX_SELECT_SIZE);\n      randomWeapons.forEach((weaponId) => {\n        options.push({\n          type: \"weapon\",\n          data: { ...WEAPONS[weaponId] },\n        });\n      });\n    } else {\n      // Get random elixirs\n      const randomElixirs = getRandomElixirs(MAX_SELECT_SIZE);\n      randomElixirs.forEach((elixirId) => {\n        options.push({\n          type: \"elixir\",\n          data: { ...ELIXIRS[elixirId] },\n        });\n      });\n    }\n\n    // Shuffle order\n    options.sort(() => Math.random() - 0.5);\n\n    return options;\n  }\n\n  private createOptionButtons(\n    centerX: number,\n    centerY: number,\n    options: RewardOption[],\n  ): void {\n    const minWidth = Math.floor(\n      (this.scene.cameras.main.width - 40) / MAX_SELECT_SIZE,\n    );\n\n    const buttonWidth = Math.min(minWidth, scaleManager.UIScaleValue(280));\n    const buttonHeight = scaleManager.UIScaleValue(180);\n    const spacing = scaleManager.UIScaleValue(30);\n    const startX =\n      centerX -\n      (buttonWidth * options.length + spacing * (options.length - 1)) / 2;\n    const depth = scaleManager.getZIndex();\n\n    options.forEach((option, index) => {\n      const x = startX + index * (buttonWidth + spacing) + buttonWidth / 2;\n      const y = centerY - scaleManager.UIScaleValue(20);\n\n      this.createOptionButton(option, x, y, buttonWidth, buttonHeight, depth);\n    });\n\n    if (useSettingStore.getState().enableAutoSelect) {\n      const index = Math.floor(Math.random() * options.length);\n      this.selectOption(options[index]);\n    }\n  }\n\n  private createOptionButton(\n    option: RewardOption,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    depth: number,\n  ) {\n    // Set color based on rarity\n    const rarity = option.data.rarity;\n    const color = RARITY_COLORS[rarity];\n\n    // Background - this will be the interactive element\n    const background = this.scene.add\n      .rectangle(x, y, width, height, 0x2a2a2a)\n      .setStrokeStyle(4, color)\n      .setScrollFactor(0)\n      .setDepth(depth)\n      .setInteractive({ useHandCursor: true });\n\n    this.uiElements.push(background);\n\n    const isWeapon = option.type === \"weapon\";\n\n    // Icon (using emoji instead of images)\n    const icon = this.scene.add\n      .text(x, y - scaleManager.UIScaleValue(60), isWeapon ? \"⚔️\" : \"🧪\", {\n        fontSize: scaleManager.getNameSize(),\n        fontFamily: scaleManager.getDefaultFont(),\n      })\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(depth + 1);\n\n    this.uiElements.push(icon);\n\n    const name = isWeapon\n      ? i18n.t(`weapons.${option.data.id}.name`)\n      : i18n.t(`elixirs.${option.data.id}.name`);\n\n    const description = isWeapon\n      ? i18n.t(`weapons.${option.data.id}.description`)\n      : i18n.t(`elixirs.${option.data.id}.description`);\n\n    // Name\n    const nameText = this.scene.add\n      .text(x, y - scaleManager.UIScaleValue(10), name, {\n        fontSize: scaleManager.getNameSize(),\n        fontFamily: scaleManager.getDefaultFont(),\n        color: \"#ffffff\",\n        fontStyle: \"bold\",\n        align: \"center\",\n        wordWrap: { width: width - 20 },\n      })\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(depth + 1);\n\n    this.uiElements.push(nameText);\n\n    let descText: Phaser.GameObjects.Text | null = null;\n\n    if (!scaleManager.isMobile()) {\n      // Description\n      descText = this.scene.add\n        .text(x, y + scaleManager.UIScaleValue(30), description, {\n          fontSize: scaleManager.getDescSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: \"#cccccc\",\n          align: \"center\",\n          wordWrap: { width: width - 20 },\n        })\n        .setOrigin(0.5)\n        .setScrollFactor(0)\n        .setDepth(depth + 1);\n\n      this.uiElements.push(descText);\n    }\n\n    // Rarity text\n    const rarityText = this.scene.add\n      .text(\n        x,\n        y + scaleManager.UIScaleValue(70),\n        i18n.t(`rewards.rarity.${rarity}`),\n        {\n          fontSize: scaleManager.getDescSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: `#${color.toString(16).padStart(6, \"0\")}`,\n          fontStyle: \"bold\",\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(depth + 1);\n\n    this.uiElements.push(rarityText);\n\n    // Store all text elements for animation\n\n    const allElements = [background, icon, nameText, rarityText];\n\n    if (descText) {\n      allElements.push(descText);\n    }\n\n    // Mouse hover effects\n    background.on(\"pointerover\", () => {\n      background.setFillStyle(0x3a3a3a);\n      this.scene.tweens.add({\n        targets: allElements,\n        scaleX: 1.05,\n        scaleY: 1.05,\n        duration: 200,\n        ease: \"Power2\",\n      });\n    });\n\n    background.on(\"pointerout\", () => {\n      background.setFillStyle(0x2a2a2a);\n      this.scene.tweens.add({\n        targets: allElements,\n        scaleX: 1,\n        scaleY: 1,\n        duration: 200,\n        ease: \"Power2\",\n      });\n    });\n\n    background.on(\"pointerdown\", () => {\n      this.selectOption(option);\n    });\n  }\n\n  private createRefreshButton(centerX: number, centerY: number): void {\n    const gold = useSaveStore.getState().totalGold;\n    const canRefresh = gold >= this.refreshCost;\n\n    const buttonY = centerY + scaleManager.UIScaleValue(140);\n    const buttonWidth = scaleManager.UIScaleValue(200);\n    const buttonHeight = scaleManager.UIScaleValue(50);\n\n    const refreshBg = this.scene.add\n      .rectangle(\n        centerX,\n        buttonY,\n        buttonWidth,\n        buttonHeight,\n        canRefresh ? 0x4a4a4a : 0x2a2a2a,\n      )\n      .setStrokeStyle(2, canRefresh ? 0xffd700 : 0x666666)\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    this.uiElements.push(refreshBg);\n\n    const refreshText = this.scene.add\n      .text(\n        centerX,\n        buttonY,\n        i18n.t(\"rewards.refreshCost\", { cost: this.refreshCost }),\n        {\n          fontSize: scaleManager.getNameSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: canRefresh ? \"#ffffff\" : \"#666666\",\n          fontStyle: \"bold\",\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    this.uiElements.push(refreshText);\n\n    if (canRefresh) {\n      refreshBg.setInteractive({ useHandCursor: true });\n\n      refreshBg.on(\"pointerover\", () => {\n        refreshBg.setFillStyle(0x5a5a5a);\n      });\n\n      refreshBg.on(\"pointerout\", () => {\n        refreshBg.setFillStyle(0x4a4a4a);\n      });\n\n      refreshBg.on(\"pointerdown\", () => {\n        this.refresh();\n      });\n    }\n  }\n\n  private createCraftHint(centerX: number, centerY: number): void {\n    // Check if there are craft able weapons\n    const ownedWeapons = useAppStore.getState().ownedWeapons || [];\n    const availableCrafts = getAvailableCrafts(ownedWeapons);\n\n    if (availableCrafts.length > 0) {\n      const hintText = this.scene.add\n        .text(\n          centerX,\n          centerY + scaleManager.UIScaleValue(200),\n          i18n.t(\"rewards.craftHint\", { count: availableCrafts.length }),\n          {\n            fontSize: scaleManager.getDescSize(),\n            fontFamily: scaleManager.getDefaultFont(),\n            color: \"#ffd700\",\n            fontStyle: \"italic\",\n          },\n        )\n        .setOrigin(0.5)\n        .setScrollFactor(0)\n        .setDepth(scaleManager.getZIndex());\n\n      this.uiElements.push(hintText);\n    }\n  }\n\n  private refresh(): void {\n    if (useSaveStore.getState().spendGold(this.refreshCost)) {\n      // Increase refresh cost before recreating UI\n\n      // Store  new cost\n      const newCost = this.refreshCost + 5;\n      // Hide current UI\n      this.hide();\n\n      // Restore the cost and show new UI\n      this.refreshCost = newCost;\n      this.show(this.onSelectCallback);\n    }\n  }\n\n  private selectOption(option: RewardOption): void {\n    // Play selection sound (if available)\n    this.scene.tweens.add({\n      targets: this.uiElements,\n      alpha: 0,\n      duration: 300,\n      ease: \"Power2\",\n      onComplete: () => {\n        this.hide();\n\n        this.onSelectCallback?.(option);\n\n        // Resume game\n        this.scene.physics.resume();\n      },\n    });\n  }\n\n  public hide(): void {\n    this.overlay?.destroy();\n    this.overlay = null;\n\n    // Destroy all UI elements\n    this.uiElements.forEach((element) => {\n      if (element && element.active) {\n        element.destroy();\n      }\n    });\n\n    this.uiElements = [];\n    this.refreshCost = 10; // Reset refresh cost\n  }\n\n  public isVisible(): boolean {\n    return Boolean(this.overlay && this.uiElements.length > 0);\n  }\n}\n","import Phaser from \"phaser\";\n\nconst EventBus = new Phaser.Events.EventEmitter();\n\nexport default EventBus;\n","import Phaser from \"phaser\";\nimport { Player, type WASDKeys } from \"./player\";\nimport { EnemySpawner } from \"./enemy\";\nimport { WeaponManager, type UpgradeOption } from \"./weapon\";\nimport { ExperienceManager } from \"./experience\";\nimport { AudioManager, SoundEffect } from \"./AudioManager\";\nimport { VirtualJoystick } from \"./VirtualJoystick\";\nimport { useSaveStore, useAppStore, useSettingStore } from \"../store\";\nimport {\n  ENEMIES_DATA,\n  WEAPONS,\n  EVENT_MAP,\n  PERMANENT_UPGRADES,\n  GEM_MAP,\n  WORLD_SIZE,\n  CHARACTER_SIZE,\n  ENEMY_SIZE,\n  DEFAULT_SPRITE_SIZE,\n} from \"../constant\";\nimport {\n  getCharacterImagePath,\n  getEnemyImagePath,\n  getWeaponImagePath,\n  getMapImagePath,\n} from \"../util\";\nimport i18n from \"../i18n\";\nimport { scaleManager } from \"./ScaleManager\";\nimport { RewardSelectionUI } from \"./RewardSelectionUI\";\nimport type { RewardOption, ElixirData, WeaponData } from \"../types\";\nimport eventBus from \"./eventBus\";\nimport { formatTime } from \"../util\";\n\ninterface ButtonElement {\n  button: Phaser.GameObjects.Rectangle;\n  nameText: Phaser.GameObjects.Text;\n  descText: Phaser.GameObjects.Text;\n}\n\nconst REQUIRED_KILLS_FOR_REWARD = 20;\n\n// Game scene\nexport class GameScene extends Phaser.Scene {\n  private player!: Player;\n  private cursors?: Phaser.Types.Input.Keyboard.CursorKeys;\n  private wasd?: WASDKeys;\n  private enemySpawner?: EnemySpawner;\n  private weaponManager?: WeaponManager;\n  private experienceManager?: ExperienceManager;\n  private rewardUI?: RewardSelectionUI;\n  private audioManager?: AudioManager;\n  private healthBarBg?: Phaser.GameObjects.Rectangle;\n  private healthBar?: Phaser.GameObjects.Rectangle;\n  private expBarBg?: Phaser.GameObjects.Rectangle;\n  private expBar?: Phaser.GameObjects.Rectangle;\n  private levelText?: Phaser.GameObjects.Text;\n  private timeText?: Phaser.GameObjects.Text;\n  private goldText?: Phaser.GameObjects.Text;\n  private closeButton?: Phaser.GameObjects.Rectangle;\n  private closeButtonText?: Phaser.GameObjects.Text;\n  private killsSinceLastReward: number = 0;\n  private killsRequiredForReward: number = REQUIRED_KILLS_FOR_REWARD; // Pop reward every 10 kills\n  private isPaused: boolean = false;\n  private isGameOver: boolean = false;\n  private playerDamageCoolDown: number = 0;\n  private killCount = 0;\n  private gameTime = 0;\n  private virtualJoystick?: VirtualJoystick;\n\n  constructor() {\n    super({ key: \"GameScene\" });\n  }\n\n  public getPlayTime() {\n    return Math.floor(useSettingStore.getState().gameTime - this.gameTime);\n  }\n\n  public playPlayerFireSound = () => {\n    this.audioManager?.playSfx(SoundEffect.PLAYER_FIRE);\n  };\n\n  public getPlayerPosition() {\n    return {\n      x: this.player.sprite.x,\n      y: this.player.sprite.y,\n    };\n  }\n\n  preload(): void {\n    // Load audio assets\n    AudioManager.preloadAudio(this);\n\n    const commonSize = scaleManager.scaleValue(DEFAULT_SPRITE_SIZE);\n\n    // Load experience gem textures - Buddhist beads and spirit essence\n    Object.values(GEM_MAP).forEach((gem) => {\n      this.load.svg(gem, `assets/${gem}.svg`, {\n        width: commonSize,\n        height: commonSize,\n      });\n    });\n\n    const selectedCharacter = useAppStore.getState().getSelectCharacter();\n\n    const characterSize = scaleManager.scaleValue(\n      CHARACTER_SIZE[selectedCharacter.rank],\n    );\n\n    this.load.svg(\n      selectedCharacter.id,\n      getCharacterImagePath(selectedCharacter.id),\n      {\n        width: characterSize,\n        height: characterSize,\n      },\n    );\n\n    const selectMap = useAppStore.getState().getSelectMap();\n\n    Object.values(ENEMIES_DATA).forEach((enemy) => {\n      if (enemy.chapter === selectMap.id) {\n        const size = scaleManager.scaleValue(ENEMY_SIZE[enemy.rank]);\n        this.load.svg(enemy.id, getEnemyImagePath(enemy.id), {\n          width: size,\n          height: size,\n        });\n      }\n    });\n\n    Object.values(WEAPONS).forEach((weapon) => {\n      this.load.svg(weapon.id, getWeaponImagePath(weapon.id), {\n        width: commonSize,\n        height: commonSize,\n      });\n    });\n\n    const worldSize = scaleManager.scaleValue(WORLD_SIZE);\n\n    this.load.svg(selectMap.id, getMapImagePath(selectMap.id), {\n      width: worldSize,\n      height: worldSize,\n    });\n  }\n\n  public create(): void {\n    // Initialize audio manager\n    this.audioManager = new AudioManager(this);\n\n    eventBus.on(EVENT_MAP.SHOW_END_GAME_MODAL, () => {\n      this.endGame();\n    });\n\n    const worldSize = scaleManager.scaleValue(WORLD_SIZE);\n\n    const worldX = Math.floor(worldSize / 2);\n\n    // Set world bounds\n    this.physics.world.setBounds(-worldX, -worldX, worldSize, worldSize);\n\n    // Load and display chapter map background\n    const selectedMap = useAppStore.getState().getSelectMap();\n\n    // Add the map image as background\n    const mapImage = this.add.image(0, 0, selectedMap.id);\n    mapImage.setOrigin(0.5, 0.5);\n    mapImage.setDepth(-2);\n\n    // Get selected character\n    const character = useAppStore.getState().getSelectCharacter();\n\n    // Create player and apply character attributes and permanent upgrades\n    this.player = new Player(this, 0, 0, character.id);\n\n    // Apply character base attributes\n    this.player.maxHealth = character.stats.baseHealth;\n    this.player.health = character.stats.baseHealth;\n    this.player.speed = character.stats.baseSpeed;\n    this.player.luck = character.stats.baseLuck;\n    this.player.armor = character.stats.baseArmor;\n    this.player.attack = character.stats.baseDamage;\n\n    // Apply permanent upgrades\n    const state = useSaveStore.getState();\n    PERMANENT_UPGRADES.forEach((upgrade) => {\n      const level = state[upgrade.id] || 0;\n      if (level > 0) {\n        const effect = upgrade.effect(level);\n        this.player.upgrade(upgrade.id, effect, effect);\n      }\n    });\n\n    // Detect touch device\n    const isTouchDevice = this.sys.game.device.input.touch;\n\n    // Input controls\n    const cursors = this.input.keyboard?.createCursorKeys();\n    if (cursors) {\n      this.cursors = cursors;\n    }\n    this.wasd = {\n      w: this.input.keyboard?.addKey(\"W\"),\n      a: this.input.keyboard?.addKey(\"A\"),\n      s: this.input.keyboard?.addKey(\"S\"),\n      d: this.input.keyboard?.addKey(\"D\"),\n    };\n\n    // Initialize virtual joystick for touch devices\n    if (isTouchDevice) {\n      const padding = scaleManager.UIScaleValue(20);\n      const joystickRadius = scaleManager.UIScaleValue(60);\n      this.virtualJoystick = new VirtualJoystick(\n        this,\n        padding + joystickRadius,\n        this.cameras.main.height - padding - joystickRadius,\n      );\n      this.virtualJoystick.show();\n    }\n\n    // Create enemy spawner with available enemies from selected map\n    this.enemySpawner = new EnemySpawner(this, selectedMap.availableEnemies);\n\n    // Create weapon manager\n    this.weaponManager = new WeaponManager(this, this.player);\n\n    // Add character's starting weapon\n    const startingWeaponId = character.startingWeapon;\n\n    // Get weapon class, default to GoldenStaff if weapon not implemented yet\n    const StartingWeaponClass =\n      this.weaponManager.getWeaponById(startingWeaponId);\n    this.weaponManager.addWeapon(StartingWeaponClass);\n\n    useAppStore.getState().addWeapon(startingWeaponId);\n\n    // Create experience manager\n    this.experienceManager = new ExperienceManager(this, this.player);\n\n    // Create reward UI\n    this.rewardUI = new RewardSelectionUI(this);\n\n    // Create UI\n    this.createUI();\n\n    // Game state\n    this.gameTime = useSettingStore.getState().gameTime;\n    this.isPaused = false;\n    this.isGameOver = false;\n\n    // Player damage cool down\n    this.playerDamageCoolDown = 0;\n\n    // Handle window resize\n    this.scale.on(\"resize\", this.handleResize, this);\n  }\n\n  private handleResize(gameSize: Phaser.Structs.Size): void {\n    const width = gameSize.width;\n    const height = gameSize.height;\n\n    // Update scale manager\n    scaleManager.updateScale();\n\n    // Update camera bounds\n    const worldSize = scaleManager.scaleValue(WORLD_SIZE);\n    const worldX = Math.floor(worldSize / 2);\n    this.cameras.main.setBounds(-worldX, -worldX, worldSize, worldSize);\n    this.cameras.main.setZoom(scaleManager.getCameraZoom());\n\n    // Update UI positions and sizes\n    this.updateUILayout(width);\n\n    const isTouchDevice = this.sys.game.device.input.touch;\n\n    // Update virtual joystick position and size\n    if (this.virtualJoystick && isTouchDevice) {\n      this.virtualJoystick.updateSize();\n      const padding = scaleManager.UIScaleValue(20);\n      const joystickRadius = scaleManager.UIScaleValue(60);\n      this.virtualJoystick.setPosition(\n        padding + joystickRadius,\n        height - padding - joystickRadius,\n      );\n    }\n  }\n\n  private updateUILayout(width: number): void {\n    const padding = scaleManager.UIScaleValue(20);\n    const barWidth = scaleManager.UIScaleValue(200);\n    const barHeight = scaleManager.UIScaleValue(20);\n    const expBarHeight = scaleManager.UIScaleValue(15);\n\n    // Update health bar\n    if (this.healthBarBg && this.healthBar) {\n      this.healthBarBg.setPosition(padding, padding);\n      this.healthBarBg.setSize(barWidth, barHeight);\n      this.healthBar.setPosition(padding, padding);\n      this.healthBar.height = barHeight;\n    }\n\n    // Update experience bar\n    if (this.expBarBg && this.expBar) {\n      this.expBarBg.setPosition(\n        padding,\n        padding + barHeight + scaleManager.UIScaleValue(5),\n      );\n      this.expBarBg.setSize(barWidth, expBarHeight);\n      this.expBar.setPosition(\n        padding,\n        padding + barHeight + scaleManager.UIScaleValue(5),\n      );\n      this.expBar.height = expBarHeight;\n    }\n\n    // Update level text\n    if (this.levelText) {\n      this.levelText.setPosition(\n        padding + barWidth + scaleManager.UIScaleValue(10),\n        padding,\n      );\n      this.levelText.setFontSize(scaleManager.getNameSize());\n    }\n\n    const timeX = scaleManager.isMobile()\n      ? width - padding - scaleManager.UIScaleValue(40)\n      : width / 2;\n\n    // Center the time text at the top\n    this.timeText?.setPosition(\n      timeX,\n      padding - scaleManager.UIScaleValue(16) / 4,\n    );\n    this.timeText?.setFontSize(scaleManager.getNameSize());\n\n    // Center the kill count\n    const goldTextY = padding + barHeight + scaleManager.UIScaleValue(5);\n    this.goldText?.setPosition(timeX, goldTextY);\n    this.goldText?.setFontSize(scaleManager.getDescSize());\n\n    const buttonHeight = scaleManager.UIScaleValue(40);\n    const buttonWidth = scaleManager.UIScaleValue(60);\n    const x = scaleManager.isMobile()\n      ? timeX\n      : this.cameras.main.width - padding - buttonWidth / 2;\n    const y = scaleManager.isMobile()\n      ? goldTextY + expBarHeight * 2 + padding\n      : padding + buttonHeight / 2;\n\n    this.closeButton?.setPosition(x, y);\n    this.closeButtonText?.setPosition(x, y);\n  }\n\n  private createUI(): void {\n    // UI container (fixed on screen)\n    const uiContainer = this.add\n      .container(0, 0)\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    // Responsive UI sizing\n    const barWidth = scaleManager.UIScaleValue(200);\n    const barHeight = scaleManager.UIScaleValue(20);\n    const expBarHeight = scaleManager.UIScaleValue(15);\n    const padding = scaleManager.UIScaleValue(20);\n\n    // Health bar\n    this.healthBarBg = this.add.rectangle(\n      padding,\n      padding,\n      barWidth,\n      barHeight,\n      0x000000,\n      0.7,\n    );\n\n    this.healthBarBg.setOrigin(0, 0);\n    this.healthBar = this.add.rectangle(\n      padding,\n      padding,\n      barWidth,\n      barHeight,\n      0xff0000,\n    );\n    this.healthBar.setOrigin(0, 0);\n\n    // Experience bar\n    this.expBarBg = this.add.rectangle(\n      padding,\n      padding + barHeight + scaleManager.UIScaleValue(5),\n      barWidth,\n      expBarHeight,\n      0x000000,\n      0.7,\n    );\n    this.expBarBg.setOrigin(0, 0);\n    this.expBar = this.add.rectangle(\n      padding,\n      padding + barHeight + scaleManager.UIScaleValue(5),\n      barWidth,\n      expBarHeight,\n      0x00ff00,\n    );\n    this.expBar.setOrigin(0, 0);\n\n    // Level text\n    this.levelText = this.add.text(\n      padding + barWidth + scaleManager.UIScaleValue(10),\n      padding,\n      i18n.t(\"game.level\", { level: 1 }),\n      {\n        fontSize: scaleManager.getNameSize(),\n        fontFamily: scaleManager.getDefaultFont(),\n        color: \"#ffffff\",\n        fontStyle: \"bold\",\n        stroke: \"#000000\",\n        strokeThickness: 3,\n      },\n    );\n\n    // Time text (centered at top) - Countdown from 30 minutes\n    const timeX = scaleManager.isMobile()\n      ? this.cameras.main.width - padding - scaleManager.UIScaleValue(40)\n      : this.cameras.main.width / 2;\n    this.timeText = this.add.text(\n      timeX,\n      padding - scaleManager.UIScaleValue(16) / 4,\n      \"00:00\",\n      {\n        fontSize: scaleManager.getNameSize(),\n        fontFamily: scaleManager.getDefaultFont(),\n        color: \"#ffffff\",\n        fontStyle: \"bold\",\n        stroke: \"#000000\",\n        strokeThickness: 3,\n      },\n    );\n    this.timeText.setOrigin(0.5, 0);\n\n    const goldTextY = padding + barHeight + scaleManager.UIScaleValue(5);\n\n    // Kill count\n    this.goldText = this.add.text(\n      timeX,\n      goldTextY,\n      `${i18n.t(\"stats.gold\")}: ${useSaveStore.getState().totalGold}`,\n      {\n        fontSize: scaleManager.getDescSize(),\n        fontFamily: scaleManager.getDefaultFont(),\n        color: \"#ffffff\",\n        stroke: \"#000000\",\n        strokeThickness: 2,\n      },\n    );\n    this.goldText.setOrigin(0.5, 0);\n\n    this.killCount = 0;\n\n    const buttonHeight = scaleManager.UIScaleValue(40);\n    const buttonWidth = scaleManager.UIScaleValue(60);\n    const x = scaleManager.isMobile()\n      ? timeX\n      : this.cameras.main.width - padding - buttonWidth / 2;\n    const y = scaleManager.isMobile()\n      ? goldTextY + expBarHeight * 2 + buttonHeight / 2\n      : padding + buttonHeight / 2;\n    // Back to menu button\n    this.closeButton = this.add\n      .rectangle(x, y, buttonWidth, buttonHeight, 0x333333, 0.7)\n      .setStrokeStyle(3, 0xffffff)\n      .setInteractive({ useHandCursor: true })\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    this.closeButtonText = this.add\n      .text(x, y, \"X\", {\n        fontSize: scaleManager.getNameSize(),\n        fontFamily: scaleManager.getDefaultFont(),\n        color: \"#ffffff\",\n        fontStyle: \"bold\",\n      })\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(scaleManager.getZIndex());\n\n    this.closeButton.on(\"pointerover\", () => {\n      this.closeButton?.setFillStyle(0x555555);\n    });\n\n    this.closeButton.on(\"pointerout\", () => {\n      this.closeButton?.setFillStyle(0x333333);\n    });\n\n    this.closeButton.on(\"pointerdown\", () => {\n      this.endGame();\n    });\n\n    uiContainer.add([\n      this.healthBarBg,\n      this.healthBar,\n      this.expBarBg,\n      this.expBar,\n      this.levelText,\n      this.timeText,\n      this.goldText,\n      this.closeButton,\n      this.closeButtonText,\n    ]);\n\n    // Emit event to indicate game initialization is complete\n    eventBus.emit(EVENT_MAP.GAME_INITIALIZED);\n  }\n\n  private endGame(): void {\n    // Save game data\n    useSaveStore.getState().addKills(this.killCount);\n    useSaveStore.getState().updatePlayTime(this.getPlayTime());\n\n    this.showModal({\n      title: i18n.t(\"game.endGameTitle\"),\n      titleColor: \"#ff0000\",\n      description: i18n.t(\"game.endGameDesc\"),\n      cancelText: i18n.t(\"shop.cancel\"),\n      onCancel: () => {\n        this.audioManager?.stopMusic();\n        this.resume();\n      },\n      okText: i18n.t(\"game.endGame\"),\n      onOk: () => {\n        this.audioManager?.stopMusic();\n        eventBus.emit(EVENT_MAP.BACK_TO_HOME);\n      },\n    });\n  }\n\n  private updateUI(): void {\n    // Update health bar\n    const healthPercent = this.player.health / this.player.maxHealth;\n    const barWidth = scaleManager.UIScaleValue(200);\n    if (this.healthBar) {\n      this.healthBar.width = barWidth * healthPercent;\n    }\n\n    // Update experience bar\n    const expPercent =\n      this.player.experience / this.player.experienceToNextLevel;\n\n    if (this.expBar) {\n      this.expBar.width = barWidth * expPercent;\n    }\n\n    // Update level\n    this.levelText?.setText(\n      i18n.t(\"game.level\", { level: this.player?.level }),\n    );\n\n    // Update time\n    this.timeText?.setText(formatTime(this.gameTime));\n\n    // Change color based on remaining time\n    if (this.gameTime < 60) {\n      this.timeText?.setColor(\"#ff0000\"); // Red when less than 1 minute\n    } else if (this.gameTime < 300) {\n      this.timeText?.setColor(\"#ffff00\"); // Yellow when less than 5 minutes\n    } else {\n      this.timeText?.setColor(\"#ffffff\"); // White otherwise\n    }\n\n    // Update kill count\n    this.goldText?.setText(\n      `${i18n.t(\"stats.gold\")}: ${useSaveStore.getState().totalGold}`,\n    );\n  }\n\n  public update(time: number, delta: number): void {\n    if (this.isPaused || this.isGameOver) return;\n\n    // Update game time (countdown)\n\n    this.gameTime -= delta / 1000;\n\n    // Check for victory when time runs out\n    if (this.gameTime <= 0) {\n      this.showVictory();\n      return;\n    }\n\n    // Update player with joystick input\n    const joystickInput = this.virtualJoystick?.getInput();\n    this.player.update(this.cursors, this.wasd, joystickInput);\n\n    // Update enemies\n    const playerPos = this.getPlayerPosition();\n    this.enemySpawner?.update(time, delta, playerPos);\n\n    // Update weapons\n    const enemies = this.enemySpawner?.getEnemies() || [];\n    this.weaponManager?.update(time, enemies);\n\n    // Update experience\n    this.experienceManager?.update();\n\n    // Collision detection\n    this.checkCollisions(delta);\n\n    // Update UI\n    this.updateUI();\n  }\n\n  private checkCollisions(delta: number): void {\n    const enemies = this.enemySpawner?.getEnemies() || [];\n\n    // Player and enemy collision\n    this.playerDamageCoolDown = Math.max(0, this.playerDamageCoolDown - delta);\n\n    const playerPos = this.getPlayerPosition();\n\n    enemies.forEach((enemy) => {\n      if (enemy.isDead) return;\n\n      const distance = Phaser.Math.Distance.Between(\n        playerPos.x,\n        playerPos.y,\n        enemy.sprite.x,\n        enemy.sprite.y,\n      );\n\n      if (distance < 30 && this.playerDamageCoolDown <= 0) {\n        this.player.takeDamage(enemy.damage);\n        this.audioManager?.playSfx(SoundEffect.PLAYER_HIT);\n        this.playerDamageCoolDown = 500; // 0.5 seconds of invincibility\n      }\n    });\n\n    // Weapon and enemy collision\n    for (const weapon of this.weaponManager?.getWeapons() || []) {\n      // Magic missile collision\n      weapon.projectiles.forEach((projectile) => {\n        if (!projectile.active) return;\n\n        enemies.forEach((enemy) => {\n          if (enemy.isDead) return;\n\n          const distance = Phaser.Math.Distance.Between(\n            projectile.x,\n            projectile.y,\n            enemy.sprite.x,\n            enemy.sprite.y,\n          );\n\n          if (distance < projectile.distance) {\n            const killed = enemy.takeDamage(projectile.damage);\n            if (killed) {\n              this.killCount++;\n              this.killsSinceLastReward++;\n              this.checkRewardTrigger();\n              this.spawnGoldCoin(\n                enemy.sprite.x,\n                enemy.sprite.y,\n                enemy.goldValue,\n              );\n            }\n\n            projectile.piercing--;\n            if (projectile.piercing <= 0) {\n              projectile.destroy();\n            }\n          }\n        });\n      });\n\n      // Holy Aura collision\n\n      weapon.orbs.forEach(({ sprite: orb }) => {\n        enemies.forEach((enemy) => {\n          if (enemy.isDead) return;\n\n          const distance = Phaser.Math.Distance.Between(\n            orb.x,\n            orb.y,\n            enemy.sprite.x,\n            enemy.sprite.y,\n          );\n\n          if (distance < orb.distance) {\n            const killed = enemy.takeDamage(orb.damage);\n            if (killed) {\n              this.killCount++;\n              this.killsSinceLastReward++;\n              this.checkRewardTrigger();\n              this.spawnGoldCoin(\n                enemy.sprite.x,\n                enemy.sprite.y,\n                enemy.goldValue,\n              );\n            }\n          }\n        });\n      });\n    }\n  }\n\n  private spawnGoldCoin(x: number, y: number, value: number): void {\n    const dropRate = 0.1 + this.player.luck * 0.02;\n    if (Math.random() < dropRate) {\n      this.experienceManager?.spawnCoin(x, y, value);\n    }\n  }\n\n  public spawnExperience(x: number, y: number, value: number): void {\n    this.experienceManager?.spawnGem(x, y, value);\n  }\n\n  private checkRewardTrigger(): void {\n    if (this.killsSinceLastReward >= this.killsRequiredForReward) {\n      this.killsSinceLastReward = 0;\n      // Increase required kills for next reward to make game more challenging\n      this.killsRequiredForReward = Math.min(\n        30,\n        this.killsRequiredForReward + REQUIRED_KILLS_FOR_REWARD,\n      );\n      this.showRewardSelection();\n    }\n  }\n\n  public pause() {\n    this.isPaused = true;\n    this.physics.pause();\n  }\n\n  public resume() {\n    this.isPaused = false;\n    this.physics.resume();\n  }\n\n  private showRewardSelection(): void {\n    if (this.isGameOver || this.rewardUI?.isVisible()) return;\n    this.audioManager?.playSfx(SoundEffect.LEVEL_UP);\n    this.pause();\n\n    this.rewardUI?.show((option: RewardOption) => {\n      this.handleRewardSelection(option);\n      this.resume();\n    });\n  }\n\n  private handleRewardSelection(option: RewardOption): void {\n    if (option.type === \"weapon\") {\n      const weaponData = option.data as WeaponData;\n\n      const WeaponClass = this.weaponManager?.getWeaponById(weaponData.id);\n      if (!WeaponClass) {\n        return;\n      }\n\n      // Add weapon to manager if not already owned\n      if (!this.weaponManager?.hasWeapon(WeaponClass)) {\n        this.weaponManager?.addWeapon(WeaponClass);\n        // Save to store\n        useAppStore.getState().addWeapon(weaponData.id);\n      } else {\n        // If already owned, upgrade it\n        const weapon = this.weaponManager?.getWeapon(WeaponClass);\n        weapon?.upgrade();\n      }\n\n      return;\n    }\n\n    if (option.type === \"elixir\") {\n      // Apply elixir effects\n      const elixir = option.data as ElixirData;\n\n      const effect =\n        elixir.id === \"jade_dew\"\n          ? Math.min(\n              this.player.maxHealth,\n              this.player.health + this.player.maxHealth * elixir.effect.value,\n            )\n          : elixir.effect.value;\n\n      this.player.upgrade(elixir.effect.type, effect, this.player.maxHealth);\n    }\n  }\n\n  public showLevelUpMenu(): void {\n    if (this.isGameOver) {\n      return;\n    }\n    // Get upgrade options\n    const options = this.weaponManager?.getUpgradeOptions() || [];\n\n    if (options.length === 0) {\n      return;\n    }\n\n    this.audioManager?.playSfx(SoundEffect.LEVEL_UP);\n    this.pause();\n    const startDepth = scaleManager.getZIndex();\n    const textDepth = scaleManager.getZIndex();\n    const endDepth = scaleManager.getZIndex();\n\n    // Create level up menu\n    const centerX = this.cameras.main.width / 2;\n    const centerY = this.cameras.main.height / 2;\n\n    // Semi-transparent background\n    const overlay = this.add\n      .rectangle(\n        centerX,\n        centerY,\n        this.cameras.main.width,\n        this.cameras.main.height,\n        0x000000,\n        0.8,\n      )\n      .setScrollFactor(0)\n      .setDepth(startDepth);\n\n    // Title\n    const title = this.add\n      .text(\n        centerX,\n        centerY - scaleManager.UIScaleValue(150),\n        i18n.t(\"game.levelUp\"),\n        {\n          fontSize: scaleManager.getTitleSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: \"#ffff00\",\n          fontStyle: \"bold\",\n          stroke: \"#000000\",\n          strokeThickness: 4,\n        },\n      )\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(textDepth);\n\n    // Create option buttons\n    const buttons: ButtonElement[] = [];\n\n    const selectOption = (option: UpgradeOption) => {\n      this.selectUpgrade(option);\n      // Clear menu\n      overlay.destroy();\n      title.destroy();\n      buttons.forEach((btn) => {\n        btn.button.destroy();\n        btn.nameText.destroy();\n        btn.descText.destroy();\n      });\n    };\n\n    const width = Math.min(\n      scaleManager.UIScaleValue(500),\n      this.cameras.main.width - 40,\n    );\n\n    options.forEach((option, index) => {\n      const y =\n        centerY -\n        scaleManager.UIScaleValue(50) +\n        index * scaleManager.UIScaleValue(100);\n\n      const button = this.add\n        .rectangle(centerX, y, width, scaleManager.UIScaleValue(80), 0x333333)\n        .setStrokeStyle(3, 0xffffff)\n        .setInteractive({ useHandCursor: true })\n        .setScrollFactor(0)\n        .setDepth(textDepth);\n\n      const nameText = this.add\n        .text(centerX, y - scaleManager.UIScaleValue(15), option.name, {\n          fontSize: scaleManager.getNameSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: \"#ffffff\",\n          fontStyle: \"bold\",\n        })\n        .setOrigin(0.5)\n        .setScrollFactor(0)\n        .setDepth(endDepth);\n\n      const descText = this.add\n        .text(centerX, y + scaleManager.UIScaleValue(15), option.description, {\n          fontSize: scaleManager.getDescSize(),\n          fontFamily: scaleManager.getDefaultFont(),\n          color: \"#cccccc\",\n          wordWrap: { width: width - 20 },\n        })\n        .setOrigin(0.5)\n        .setScrollFactor(0)\n        .setDepth(endDepth);\n\n      button.on(\"pointerover\", () => {\n        button.setFillStyle(0x555555);\n      });\n\n      button.on(\"pointerout\", () => {\n        button.setFillStyle(0x333333);\n      });\n\n      button.on(\"pointerdown\", () => {\n        selectOption(option);\n      });\n\n      buttons.push({ button, nameText, descText });\n    });\n\n    if (useSettingStore.getState().enableAutoSelect) {\n      const index = Math.floor(Math.random() * options.length);\n      selectOption(options[index]);\n    }\n  }\n\n  public selectUpgrade(option: UpgradeOption): void {\n    if (option.type === \"upgrade\" && option.weapon) {\n      option.weapon.upgrade();\n    } else if (option.type === \"new\" && option.weaponClass) {\n      this.weaponManager?.addWeapon(option.weaponClass);\n    }\n\n    this.resume();\n  }\n\n  private showModal({\n    title,\n    titleColor,\n    description,\n    cancelText,\n    onCancel,\n    okText,\n    onOk,\n  }: {\n    title: string;\n    titleColor: string;\n    description?: string;\n    cancelText: string;\n    onCancel: () => void;\n    okText: string;\n    onOk: () => void;\n  }) {\n    const result: Array<\n      Phaser.GameObjects.Text | Phaser.GameObjects.Rectangle\n    > = [];\n    this.pause();\n\n    const centerX = this.cameras.main.width / 2;\n    const centerY = this.cameras.main.height / 2;\n\n    const startDepth = scaleManager.getZIndex();\n    const textDepth = scaleManager.getZIndex();\n    const endDepth = scaleManager.getZIndex();\n\n    const container = this.add\n      .rectangle(\n        centerX,\n        centerY,\n        this.cameras.main.width,\n        this.cameras.main.height,\n        0x000000,\n        0.9,\n      )\n      .setScrollFactor(0)\n      .setDepth(startDepth);\n\n    result.push(container);\n\n    const titleText = this.add\n      .text(centerX, centerY - scaleManager.UIScaleValue(100), title, {\n        fontSize: scaleManager.getTitleSize(),\n        color: titleColor,\n        fontStyle: \"bold\",\n        stroke: \"#000000\",\n        strokeThickness: 6,\n        fontFamily: scaleManager.getDefaultFont(),\n      })\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(textDepth);\n\n    result.push(titleText);\n\n    if (description) {\n      const descText = this.add\n        .text(centerX, centerY, description, {\n          fontSize: scaleManager.getNameSize(),\n          color: \"#ffffff\",\n          align: \"center\",\n          stroke: \"#000000\",\n          strokeThickness: 3,\n          fontFamily: scaleManager.getDefaultFont(),\n        })\n        .setOrigin(0.5)\n        .setScrollFactor(0)\n        .setDepth(textDepth);\n      result.push(descText);\n    }\n\n    const paddingY = scaleManager.UIScaleValue(120);\n\n    const okButton = this.add\n      .rectangle(\n        centerX - scaleManager.UIScaleValue(110),\n        centerY + paddingY,\n        scaleManager.UIScaleValue(180),\n        scaleManager.UIScaleValue(60),\n        0x333333,\n      )\n      .setStrokeStyle(3, 0xffffff)\n      .setInteractive({ useHandCursor: true })\n      .setScrollFactor(0)\n      .setDepth(textDepth);\n\n    result.push(okButton);\n\n    const paddingX = scaleManager.UIScaleValue(110);\n\n    const okObj = this.add\n      .text(centerX - paddingX, centerY + paddingY, okText, {\n        fontSize: scaleManager.getNameSize(),\n        color: \"#ffffff\",\n        fontStyle: \"bold\",\n        fontFamily: scaleManager.getDefaultFont(),\n      })\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(endDepth);\n\n    result.push(okObj);\n\n    okButton.on(\"pointerover\", () => {\n      okButton.setFillStyle(0x555555);\n    });\n\n    okButton.on(\"pointerout\", () => {\n      okButton.setFillStyle(0x333333);\n    });\n\n    okButton.on(\"pointerdown\", () => {\n      onOk();\n    });\n\n    const cancelButton = this.add\n      .rectangle(\n        centerX + paddingX,\n        centerY + paddingY,\n        scaleManager.UIScaleValue(180),\n        scaleManager.UIScaleValue(60),\n        0x333333,\n      )\n      .setStrokeStyle(3, 0xffffff)\n      .setInteractive({ useHandCursor: true })\n      .setScrollFactor(0)\n      .setDepth(textDepth);\n\n    result.push(cancelButton);\n\n    const cancelTextObj = this.add\n      .text(centerX + paddingX, centerY + paddingY, cancelText, {\n        fontSize: scaleManager.getNameSize(),\n        color: \"#ffffff\",\n        fontStyle: \"bold\",\n        fontFamily: scaleManager.getDefaultFont(),\n      })\n      .setOrigin(0.5)\n      .setScrollFactor(0)\n      .setDepth(endDepth);\n\n    result.push(cancelTextObj);\n\n    cancelButton.on(\"pointerover\", () => {\n      cancelButton.setFillStyle(0x555555);\n    });\n\n    cancelButton.on(\"pointerout\", () => {\n      cancelButton.setFillStyle(0x333333);\n    });\n\n    cancelButton.on(\"pointerdown\", () => {\n      result.forEach((item) => {\n        item.destroy();\n      });\n      onCancel();\n    });\n\n    return result;\n  }\n\n  private getEndGameDesc() {\n    return `${i18n.t(\"stats.survivalTime\")}: ${this.getPlayTime()}\\n${i18n.t(\n      \"stats.kills\",\n    )}: ${this.killCount}\\n${i18n.t(\"stats.level\")}: ${this.player.level}\\n${i18n.t(\"stats.gold\")}: ${useSaveStore.getState().totalGold}`;\n  }\n\n  public async showVictory(): Promise<void> {\n    if (this.isGameOver) return;\n    this.isGameOver = true;\n\n    this.audioManager?.playSfx(SoundEffect.VICTORY_THEME);\n\n    // Collect all remaining items with animation\n    await this.experienceManager?.collectAllItems();\n\n    // Save game data\n    useSaveStore.getState().addKills(this.killCount);\n    useSaveStore.getState().updatePlayTime(this.getPlayTime());\n\n    // Complete the chapter and unlock characters\n    const selectedMap = useAppStore.getState().getSelectMap();\n    useSaveStore.getState().completeChapter([selectedMap.id]);\n\n    this.showModal({\n      title: i18n.t(\"game.chapterComplete\"),\n      titleColor: \"#00ff00\",\n      description: this.getEndGameDesc(),\n      cancelText: i18n.t(\"game.backToHome\"),\n      onCancel: () => {\n        this.audioManager?.stopMusic();\n        eventBus.emit(EVENT_MAP.BACK_TO_HOME);\n      },\n      okText: i18n.t(\"game.restart\"),\n      onOk: () => {\n        this.isGameOver = false;\n        this.audioManager?.stopMusic();\n        this.scene.restart();\n      },\n    });\n  }\n\n  public gameOver(): void {\n    if (this.isGameOver) return;\n    this.isGameOver = true;\n\n    this.audioManager?.playSfx(SoundEffect.PLAYER_DEATH);\n\n    // Save game data\n    useSaveStore.getState().addKills(this.killCount);\n    useSaveStore.getState().updatePlayTime(this.getPlayTime());\n\n    this.showModal({\n      title: i18n.t(\"game.gameOver\"),\n      titleColor: \"#ff0000\",\n      description: this.getEndGameDesc(),\n      cancelText: i18n.t(\"game.backToHome\"),\n      onCancel: () => {\n        this.audioManager?.stopMusic();\n        eventBus.emit(EVENT_MAP.BACK_TO_HOME);\n      },\n      okText: i18n.t(\"game.restart\"),\n      onOk: () => {\n        this.audioManager?.stopMusic();\n\n        this.scene.restart();\n      },\n    });\n  }\n}\n","import React, { useEffect, useRef, useState } from \"react\";\nimport styles from \"./index.module.css\";\nimport { GameScene } from \"../../game/GameScene\";\nimport { EVENT_MAP, ENABLE_DEBUG } from \"../../constant\";\nimport Phaser from \"phaser\";\nimport EventBus from \"../../game/eventBus\";\n\ninterface GameWrapperProps {\n  onBack: () => void;\n}\n\nconst getConfig = (parent: HTMLElement) => {\n  const config: Phaser.Types.Core.GameConfig = {\n    width: window.innerWidth,\n    height: window.innerHeight,\n    type: Phaser.AUTO,\n    parent,\n    physics: {\n      default: \"arcade\",\n      arcade: {\n        gravity: { y: 0, x: 0 },\n        debug: ENABLE_DEBUG,\n      },\n    },\n    scene: [GameScene],\n    scale: {\n      mode: Phaser.Scale.RESIZE,\n      autoCenter: Phaser.Scale.CENTER_BOTH,\n      width: \"100%\",\n      height: \"100%\",\n    },\n    render: {\n      pixelArt: false,\n      antialias: true,\n    },\n  };\n\n  return config;\n};\n\nconst GameWrapper: React.FC<GameWrapperProps> = ({ onBack }) => {\n  const gameRef = useRef<Phaser.Game | null>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    if (!containerRef.current || gameRef.current) return;\n\n    gameRef.current = new Phaser.Game(getConfig(containerRef.current));\n\n    return () => {\n      if (gameRef.current) {\n        gameRef.current.destroy(true);\n        gameRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    EventBus.on(EVENT_MAP.BACK_TO_HOME, onBack);\n    const handleGameInitialized = () => {\n      setIsLoading(false);\n    };\n\n    function handleKeyDown(event: KeyboardEvent) {\n      if (event.key === \"Escape\") {\n        EventBus.emit(EVENT_MAP.SHOW_END_GAME_MODAL);\n      }\n\n      return false;\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    EventBus.on(EVENT_MAP.GAME_INITIALIZED, handleGameInitialized);\n\n    return () => {\n      window.removeEventListener(\"keydown\", handleKeyDown);\n      EventBus.off(EVENT_MAP.BACK_TO_HOME, onBack);\n      EventBus.off(EVENT_MAP.GAME_INITIALIZED, handleGameInitialized);\n    };\n  }, []);\n\n  return (\n    <>\n      <div\n        className={styles.gameContainer}\n        ref={containerRef}\n        data-testid=\"game-container\"\n      />\n      {isLoading && (\n        <div className={styles.loadingOverlay} data-testid=\"loading-overlay\">\n          <div\n            className={styles.loadingSpinner}\n            data-testid=\"loading-spinner\"\n          ></div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default GameWrapper;\n","import type { Screen } from \"../../types\";\nimport { useTranslation } from \"react-i18next\";\nimport { useSaveStore } from \"../../store\";\nimport { confirmModal } from \"../../util\";\n\ninterface HomeProps {\n  changeScreen: (screen: Screen) => void;\n}\n\nexport const Home = ({ changeScreen }: HomeProps) => {\n  const [t] = useTranslation();\n\n  const handleResetSave = () => {\n    if (confirmModal(t(\"dialog.resetSaveConfirm\"))) {\n      useSaveStore.getState().resetAll();\n      window.location.reload();\n    }\n  };\n\n  return (\n    <div className=\"center-container\">\n      <h1 data-testid=\"page-title\">{t(\"game.title\")}</h1>\n      <button\n        className=\"confirmButton\"\n        onClick={() => changeScreen(\"characterSelect\")}\n        data-testid=\"start-button\"\n      >\n        {t(\"game.start\")}\n      </button>\n      <button\n        className=\"backButton\"\n        onClick={() => {\n          changeScreen(\"shop\");\n        }}\n        data-testid=\"shop-button\"\n      >\n        {t(\"shop.title\")}\n      </button>\n\n      <button\n        className=\"backButton\"\n        onClick={() => {\n          changeScreen(\"stats\");\n        }}\n        data-testid=\"stats-button\"\n      >\n        {t(\"stats.title\")}\n      </button>\n\n      <button\n        className=\"backButton\"\n        onClick={() => {\n          changeScreen(\"settings\");\n        }}\n        data-testid=\"settings-button\"\n      >\n        {t(\"settings.title\")}\n      </button>\n\n      <button\n        className=\"backButton\"\n        onClick={() => {\n          changeScreen(\"wiki\");\n        }}\n        data-testid=\"wiki-button\"\n      >\n        {t(\"wiki.title\")}\n      </button>\n\n      <button\n        className=\"resetButton\"\n        onClick={handleResetSave}\n        data-testid=\"reset-save-button\"\n      >\n        {t(\"game.resetSave\")}\n      </button>\n    </div>\n  );\n};\n\nexport default Home;\n","import { LanguageSelect } from \"../../components\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  useEnableAutoSelect,\n  useEnableUnlockAll,\n  useMusicEnabled,\n  useMusicVolume,\n  useGameTime,\n  useSettingStore,\n  useEnableFullScreen,\n} from \"../../store\";\nimport styles from \"./index.module.css\";\nimport { toggleFullScreen, confirmModal } from \"../../util\";\n\nexport const Settings = ({ onBack }: { onBack: () => void }) => {\n  const [t] = useTranslation();\n  const enableAutoSelect = useEnableAutoSelect();\n  const enableUnlockAll = useEnableUnlockAll();\n  const musicEnabled = useMusicEnabled();\n  const musicVolume = useMusicVolume();\n  const gameTime = Math.floor(useGameTime() / 60);\n  const enableFullScreen = useEnableFullScreen();\n  return (\n    <div className=\"center-container\">\n      <button\n        className={`backButton closeButton ${styles.closeButton}`}\n        onClick={onBack}\n        data-testid=\"back-to-home-button\"\n      >\n        X\n      </button>\n      <h1 data-testid=\"page-title\">{t(\"settings.title\")}</h1>\n      <div className={styles.list}>\n        <label htmlFor=\"select-language\">{t(\"settings.chooseLanguage\")}</label>\n        <LanguageSelect />\n      </div>\n      <div className={styles.list}>\n        <label htmlFor=\"auto-select\">{t(\"settings.autoSelect\")}</label>\n        <input\n          type=\"checkbox\"\n          id=\"auto-select\"\n          name=\"auto-select\"\n          checked={enableAutoSelect}\n          onChange={(e) =>\n            useSettingStore\n              .getState()\n              .setAutoSelectEnabled(Boolean(e.target.checked))\n          }\n        />\n      </div>\n      <div className={styles.list}>\n        <label htmlFor=\"unlock-all\">{t(\"settings.unlockAll\")}</label>\n        <input\n          type=\"checkbox\"\n          id=\"unlock-all\"\n          name=\"unlock-all\"\n          checked={enableUnlockAll}\n          onChange={(e) =>\n            useSettingStore\n              .getState()\n              .setUnlockAllEnabled(Boolean(e.target.checked))\n          }\n        />\n      </div>\n      <div className={styles.list}>\n        <label htmlFor=\"full-screen\">{t(\"settings.enableFullScreen\")}</label>\n        <input\n          type=\"checkbox\"\n          id=\"full-screen\"\n          name=\"full-screen\"\n          checked={enableFullScreen}\n          onChange={(e) => {\n            const enable = Boolean(e.target.checked);\n            useSettingStore.getState().setFullScreenEnabled(enable);\n            toggleFullScreen(enable);\n          }}\n        />\n      </div>\n      <div className={styles.list}>\n        <label htmlFor=\"game-time\">\n          {t(\"settings.gameTime\", { value: gameTime })}\n        </label>\n        <input\n          type=\"range\"\n          id=\"game-time\"\n          name=\"game-time\"\n          min=\"1\"\n          max=\"120\"\n          value={gameTime}\n          step=\"1\"\n          onChange={(e) => {\n            const value = Number(e.target.value) * 60;\n            useSettingStore.getState().setGameTime(value);\n          }}\n        />\n      </div>\n      <div className={styles.list}>\n        <label htmlFor=\"enable-music\">{t(\"settings.enableMusic\")}</label>\n        <input\n          type=\"checkbox\"\n          id=\"enable-music\"\n          name=\"enable-music\"\n          checked={musicEnabled}\n          onChange={(e) =>\n            useSettingStore\n              .getState()\n              .setMusicEnabled(Boolean(e.target.checked))\n          }\n        />\n      </div>\n      <div className={styles.list}>\n        <label htmlFor=\"music-volume\">{`${t(\"settings.musicVolume\")}: ${musicVolume}`}</label>\n        <input\n          type=\"range\"\n          id=\"music-volume\"\n          name=\"music-volume\"\n          min=\"0\"\n          max=\"1\"\n          value={musicVolume}\n          step=\"0.01\"\n          onChange={(e) => {\n            const value = Number(e.target.value);\n            useSettingStore.getState().setMusicVolume(value);\n          }}\n        />\n      </div>\n      <button\n        className={`resetButton ${styles.resetButton}`}\n        onClick={() => {\n          if (confirmModal(t(\"settings.resetConfirm\"))) {\n            useSettingStore.getState().resetAll();\n          }\n        }}\n        data-testid=\"reset-setting-button\"\n      >\n        {t(\"settings.resetSetting\")}\n      </button>\n    </div>\n  );\n};\n\nexport default Settings;\n","import React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  useUnlockedCharacters,\n  useTotalGold,\n  useTotalKills,\n  useBestSurvivalTime,\n  useTotalPlayTime,\n  useCompletedChapters,\n} from \"../../store\";\nimport { CHARACTERS_DATA } from \"../../constant\";\nimport { MAPS } from \"../../constant/map\";\nimport styles from \"./index.module.css\";\nimport { formatTime } from \"../../util\";\n\nconst chatterList = Object.keys(CHARACTERS_DATA);\n\nconst Stats: React.FC<{ onBack: () => void }> = ({ onBack }) => {\n  const [t] = useTranslation();\n  const unlockedCharacters = useUnlockedCharacters();\n  const completedChapters = useCompletedChapters();\n  const totalGold = useTotalGold();\n  const totalKills = useTotalKills();\n  const bestSurvivalTime = useBestSurvivalTime();\n  const totalPlayTime = useTotalPlayTime();\n\n  return (\n    <div className=\"center-container\">\n      <button\n        className={`backButton closeButton ${styles.closeButton}`}\n        onClick={onBack}\n        data-testid=\"back-to-home-button\"\n      >\n        X\n      </button>\n      <h1 data-testid=\"page-title\">{t(\"stats.title\")}</h1>\n      <div className={styles.stat}>\n        <span className={styles.statLabel}>💰 {t(\"stats.gold\")}:</span>\n        <span className={styles.statValue}>{totalGold}</span>\n      </div>\n      <div className={styles.stat}>\n        {/* eslint-disable-next-line i18next/no-literal-string */}\n        <span className={styles.statLabel}>⚔️ {t(\"stats.totalKills\")}:</span>\n        <span className={styles.statValue}>{totalKills}</span>\n      </div>\n      <div className={styles.stat}>\n        {/* eslint-disable-next-line i18next/no-literal-string */}\n        <span className={styles.statLabel}>⏱️ {t(\"stats.bestSurvival\")}:</span>\n        <span className={styles.statValue}>{formatTime(bestSurvivalTime)}</span>\n      </div>\n      <div className={styles.stat}>\n        <span className={styles.statLabel}>🕒 {t(\"stats.totalPlayTime\")}:</span>\n        <span className={styles.statValue}>{formatTime(totalPlayTime)}</span>\n      </div>\n      <div className={styles.stat}>\n        <span className={styles.statLabel}>\n          {t(\"characters.unlockCharacter\")}:\n        </span>\n        <span className={styles.statValue}>\n          {unlockedCharacters.length}/{chatterList.length}\n        </span>\n      </div>\n      <div className={styles.stat}>\n        <span className={styles.statLabel}>{t(\"game.completeChapters\")}:</span>\n        <span className={styles.statValue}>\n          {completedChapters.length}/{MAPS.length}\n        </span>\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(Stats);\n","import { useTranslation } from \"react-i18next\";\nimport styles from \"./index.module.css\";\nimport {\n  CHARACTERS_DATA,\n  MAPS,\n  WEAPONS,\n  ELIXIRS,\n  ENEMIES_DATA,\n} from \"../../constant\";\n\nconst characters = Object.values(CHARACTERS_DATA);\nconst weapons = Object.values(WEAPONS);\nconst elixirs = Object.values(ELIXIRS);\nconst enemies = Object.values(ENEMIES_DATA);\n\nconst Wiki = ({ onBack }: { onBack: () => void }) => {\n  const [t] = useTranslation();\n  return (\n    <div className=\"common-container\">\n      <button\n        className={`backButton closeButton ${styles.closeButton}`}\n        onClick={onBack}\n        data-testid=\"back-to-home-button\"\n      >\n        X\n      </button>\n      <h1 data-testid=\"page-title\">{t(\"wiki.title\")}</h1>\n\n      <details className={styles.details} data-testid=\"wiki-maps-section\">\n        <summary className={styles.title}>{t(\"maps.title\")}</summary>\n        {MAPS.map((v) => (\n          <div key={v.id} className={styles.item}>\n            <div className={styles.label}>{t(`maps.${v.id}.name`)}</div>\n            <div className={styles.desc}>{t(`maps.${v.id}.description`)}</div>\n          </div>\n        ))}\n      </details>\n\n      <details className={styles.details} data-testid=\"wiki-characters-section\">\n        <summary className={styles.title}>{t(\"characters.title\")}</summary>\n        {characters.map((v) => (\n          <div key={v.id} className={styles.item}>\n            <div className={styles.label}>{t(`characters.${v.id}.name`)}</div>\n            <div className={styles.desc}>\n              {t(`characters.${v.id}.description`)}\n            </div>\n          </div>\n        ))}\n      </details>\n\n      <details className={styles.details} data-testid=\"wiki-weapons-section\">\n        <summary className={styles.title}>{t(\"weapons.title\")}</summary>\n        {weapons.map((v) => (\n          <div key={v.id} className={styles.item}>\n            <div className={styles.label}>{t(`weapons.${v.id}.name`)}</div>\n            <div className={styles.desc}>\n              {t(`weapons.${v.id}.description`)}\n            </div>\n          </div>\n        ))}\n      </details>\n\n      <details className={styles.details} data-testid=\"wiki-elixirs-section\">\n        <summary className={styles.title}>{t(\"elixirs.title\")}</summary>\n        {elixirs.map((v) => (\n          <div key={v.id} className={styles.item}>\n            <div className={styles.label}>{t(`elixirs.${v.id}.name`)}</div>\n            <div className={styles.desc}>\n              {t(`elixirs.${v.id}.description`)}\n            </div>\n          </div>\n        ))}\n      </details>\n\n      <details className={styles.details} data-testid=\"wiki-enemies-section\">\n        <summary className={styles.title}>{t(\"enemies.title\")}</summary>\n        {enemies.map((v) => (\n          <div key={v.id} className={styles.item}>\n            <div className={styles.label}>{t(`enemies.${v.id}`)}</div>\n          </div>\n        ))}\n      </details>\n    </div>\n  );\n};\n\nexport default Wiki;\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { useAppStore } from \"./store\";\nimport CharacterSelect from \"./pages/CharacterSelect\";\nimport MapSelect from \"./pages/MapSelect\";\nimport Shop from \"./pages/Shop\";\nimport Game from \"./pages/Game\";\nimport \"./App.css\";\nimport { type Screen } from \"./types\";\nimport Home from \"./pages/Home\";\nimport Settings from \"./pages/Settings\";\nimport Stats from \"./pages/Stats\";\nimport Wiki from \"./pages/Wiki\";\n\nconst App: React.FC = () => {\n  const [currentScreen, setCurrentScreen] = useState<Screen>(\"home\");\n  useEffect(() => {\n    useAppStore.getState().checkUnlocks();\n  }, [currentScreen]);\n\n  const onGoToGame = useCallback(() => {\n    setCurrentScreen(\"game\");\n  }, []);\n\n  const onGoToHome = useCallback(() => {\n    setCurrentScreen(\"home\");\n  }, []);\n\n  const onGoToMap = useCallback(() => {\n    setCurrentScreen(\"mapSelect\");\n  }, []);\n\n  const onGoToCharacter = useCallback(() => {\n    setCurrentScreen(\"characterSelect\");\n  }, []);\n\n  const screenComponents = {\n    mapSelect: <MapSelect onConfirm={onGoToGame} onBack={onGoToCharacter} />,\n    shop: <Shop onBack={onGoToHome} />,\n    game: <Game onBack={onGoToHome} />,\n    characterSelect: (\n      <CharacterSelect onConfirm={onGoToMap} onBack={onGoToHome} />\n    ),\n    settings: <Settings onBack={onGoToHome} />,\n    stats: <Stats onBack={onGoToHome} />,\n    wiki: <Wiki onBack={onGoToHome} />,\n    home: <Home changeScreen={setCurrentScreen} />,\n  };\n\n  return screenComponents[currentScreen] || screenComponents.home;\n};\n\nexport default App;\n","import { createRoot } from \"react-dom/client\";\nimport \"./i18n\";\nimport App from \"./App\";\nimport \"./App.css\";\nimport i18n from \"./i18n\";\nimport { useSettingStore } from \"./store\";\nimport { isFullScreen } from \"./util\";\nimport \"vite/modulepreload-polyfill\";\n\nasync function init() {\n  await i18n.changeLanguage();\n  useSettingStore.getState().setFullScreenEnabled(isFullScreen());\n  const root = createRoot(document.getElementById(\"root\")!);\n  root.render(<App />);\n}\n\ninit();\n"],"names":["CHARACTERS_DATA","CHARACTER_SIZE","ENEMIES_DATA","ENEMY_SIZE","WEAPONS","ELIXIRS","WEAPON_RECIPES","RARITY_COLORS","RARITY_SIZE","RARITY_DURATION","RARITY_SPEED","RARITY_DAMAGE","RARITY_MAX_LEVEL","GEM_MAP","DEFAULT_COLLECT_RADIUS","DEFAULT_MAGNET_RADIUS","DEFAULT_SPRITE_SIZE","COLLECT_RANGE_BONUS","LanguageSelect","t","useTranslation","language","useLanguage","jsx","styles","e","i18n","SupportLanguageCodes","lang","Toast","React","message","type","testId","toast","props","duration","rest","container","root","createRoot","close","timer","confirmModal","res","requestFullscreen","element","exitFullscreen","isFullScreen","toggleFullScreen","enable","formatTime","seconds","mins","secs","getRarityWeight","rarity","getRandomItemsWithWeight","items","count","weightedItems","id","item","selected","availableItems","totalWeight","sum","random","selectedIndex","i","getWeaponImagePath","getCharacterImagePath","getEnemyImagePath","getMapImagePath","getRandomWeapons","getRandomElixirs","canCraftWeapon","ownedWeapons","recipeKey","recipe","material","getAvailableCrafts","available","key","upgradeLevelGold","level","DEFAULT_GAME_TIME","MAPS","BASE_UPGRADE_PERCENTAGE","MAX_UPGRADE_LEVEL","PERMANENT_UPGRADES","DEFAULT_SAVE","WORLD_SIZE","EVENT_MAP","START_Z_INDEX","MAX_SELECT_SIZE","ENABLE_DEBUG","checkUnlocks","state","useSaveStore","completedChapters","unlockedMapIds","unlockedCharacterIds","chapters","c","m","map","unlocked","char","useAppStore","create","set","get","weaponId","characterId","mapId","selectedCharacter","selectedMap","getSelectedCharacter","getSelectedMap","getUnlockedCharacters","getUnlockedMaps","useSelectedCharacter","useShallow","useSelectedMap","useUnlockedCharacters","useUnlockedMaps","SAVE_KEY","persist","amount","newPlayTime","newBestTime","upgradeId","upgrade","u","currentLevel","cost","refund","resetUpgrades","list","persistedState","currentState","createJSONStorage","getTotalGold","getTotalKills","getBestSurvivalTime","getTotalPlayTime","getCompletedChapters","getShopLevel","useTotalGold","useTotalKills","useBestSurvivalTime","useTotalPlayTime","useCompletedChapters","useShopLevel","DEFAULT_SETTING","useSettingStore","enabled","gameTime","volume","Phaser","getLanguage","getEnableAutoSelect","getEnableUnlockAll","getMusicEnabled","getMusicVolume","getGameTime","getEnableFullScreen","useEnableAutoSelect","useEnableUnlockAll","useMusicEnabled","useMusicVolume","useGameTime","useEnableFullScreen","resources","zhCN","enUS","jaJP","deDE","esES","frFR","koKR","ptBR","ruRU","zhTW","I18nConfig","defaultLang","currentLanguage","initialized","getSelectedLang","selectedLang","findLang","initialize","initReactI18next","i18nConfig","characterList","CharacterSelect","onConfirm","onBack","unlockedCharacters","useMemo","handleCharacterClick","character","handleConfirm","jsxs","isUnlocked","isSelected","MAP_COLORS","MapSelect","unlockedMaps","handleMapClick","chapterColor","ICONS_MAP","Shop","setRefresh","useState","totalGold","save","handlePurchase","prev","handleResetUpgrades","isMaxLevel","canAfford","currentEffect","nextEffect","ScaleManagerClass","onResize","_","rawScale","baseSize","scaleManager","Player","scene","x","y","textureKey","spriteSize","cursors","wasd","joystickInput","velocityX","velocityY","damage","actualDamage","actualExp","value","value2","radio","Enemy","enemyType","enemyData","displaySize","playerPos","dx","dy","distance","EnemySpawner","availableEnemies","_time","delta","enemy","timeBasedMultiplier","spawnCount","angle","eliteChance","minions","elites","pool","Weapon","player","config","weaponData","isCrit","time","enemies","radius","orb","adjustedAngle","projectile","range","velocity","projectileSize","_index","GoldenStaff","FireproofCloak","RuyiStaff","FireLance","WindTamer","VioletBell","angles","wave","dist","TwinBlades","Mace","BullHorns","circle","ThunderDrum","target","lightning","IceNeedle","WindFireWheels","JadePurityBottle","bottle","GoldenRope","PlantainFan","nearest","targetAngle","graphics","angleDiff","ThreePointedBlade","NineRingStaff","originalSpeed","CrescentBlade","IronCudgel","SevenStarSword","rotation","GinsengFruit","currentHealth","maxHealth","newHealth","HeavenEarthCircle","checkReturn","currentPlayerPos","returnAngle","RedArmillarySash","PurpleGoldGourd","GoldenRopeImmortal","DemonRevealingMirror","marker","SeaCalmingNeedle","startAngle","endAngle","isLeft","EightTrigramsFurnace","furnaceGraphics","maxBurnTicks","DragonStaff","closestEnemy","targetX","targetY","tornado","tornadoDuration","damageInterval","damageTicks","SevenTreasureTree","ImmortalSlayingBlade","DiamondSnare","ExquisitePagoda","NineToothRake","DragonScaleSword","WEAPON_MAP","WeaponManager","sortedEnemies","a","b","distA","distB","weapon","WeaponClass","options","name","weaponClass","CollectibleItem","textureName","itemSize","collectRangeBonus","magnetBonus","collectBonusFactor","magnetBonusFactor","adjustedCollectRadius","adjustedMagnetRadius","ExperienceManager","collectible","gem","coin","completedCount","totalCollectibles","resolve","SoundEffect","AudioManager","effect","musicEnabled","musicVolume","error","VirtualJoystick","hitArea","pointer","localX","localY","clampedDistance","stickX","stickY","oldBaseRadius","scale","RewardSelectionUI","onSelect","centerX","centerY","title","elixirId","minWidth","buttonWidth","buttonHeight","spacing","startX","depth","option","index","width","height","color","background","isWeapon","icon","description","nameText","descText","rarityText","allElements","canRefresh","buttonY","refreshBg","refreshText","availableCrafts","hintText","newCost","EventBus","REQUIRED_KILLS_FOR_REWARD","GameScene","commonSize","characterSize","selectMap","size","worldSize","eventBus","worldX","mapImage","isTouchDevice","padding","joystickRadius","startingWeaponId","StartingWeaponClass","gameSize","barWidth","barHeight","expBarHeight","timeX","goldTextY","uiContainer","healthPercent","expPercent","dropRate","elixir","startDepth","textDepth","endDepth","overlay","buttons","selectOption","btn","button","titleColor","cancelText","onCancel","okText","onOk","result","titleText","paddingY","okButton","paddingX","okObj","cancelButton","cancelTextObj","getConfig","parent","GameWrapper","gameRef","useRef","containerRef","isLoading","setIsLoading","useEffect","handleGameInitialized","handleKeyDown","event","Fragment","Home","changeScreen","handleResetSave","Settings","enableAutoSelect","enableUnlockAll","enableFullScreen","chatterList","Stats","totalKills","bestSurvivalTime","totalPlayTime","Stats$1","characters","weapons","elixirs","Wiki","v","App","currentScreen","setCurrentScreen","onGoToGame","useCallback","onGoToHome","onGoToMap","onGoToCharacter","screenComponents","Game","init"],"mappings":"28BAGO,MAAMA,EAAwD,CAEnE,aAAc,CACZ,GAAI,eACJ,KAAM,MACN,KAAM,OACN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,CAAA,EAEZ,eAAgB,eAChB,MAAO,SAAA,EAIT,UAAW,CACT,GAAI,YACJ,KAAM,KACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,EACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,kBAChB,MAAO,SAAA,EAGT,SAAU,CACR,GAAI,WACJ,KAAM,KACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,iBAChB,MAAO,SAAA,EAGT,UAAW,CACT,GAAI,YACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,kBAChB,MAAO,SAAA,EAGT,mBAAoB,CAClB,GAAI,qBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,qBAChB,MAAO,SAAA,EAIT,gBAAiB,CACf,GAAI,kBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,OAChB,MAAO,SAAA,EAGT,SAAU,CACR,GAAI,WACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,CAAA,EAEZ,eAAgB,cAChB,MAAO,SAAA,EAGT,gBAAiB,CACf,GAAI,kBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAIT,iBAAkB,CAChB,GAAI,mBACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAGT,eAAgB,CACd,GAAI,iBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,CAAA,EAEZ,eAAgB,cAChB,MAAO,SAAA,EAGT,eAAgB,CACd,GAAI,iBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,eAChB,MAAO,SAAA,EAGT,qBAAsB,CACpB,GAAI,uBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,OAChB,MAAO,SAAA,EAIT,iBAAkB,CAChB,GAAI,mBACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,EAAA,EAEZ,eAAgB,cAChB,MAAO,SAAA,EAGT,aAAc,CACZ,GAAI,eACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAGT,UAAW,CACT,GAAI,YACJ,KAAM,KACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,CAAA,EAEZ,eAAgB,eAChB,MAAO,SAAA,EAGT,eAAgB,CACd,GAAI,iBACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,eAChB,MAAO,SAAA,EAIT,iBAAkB,CAChB,GAAI,mBACJ,KAAM,KACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAGT,oBAAqB,CACnB,GAAI,sBACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAGT,aAAc,CACZ,GAAI,eACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,OAChB,MAAO,SAAA,EAGT,2BAA4B,CAC1B,GAAI,6BACJ,KAAM,QACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAIT,UAAW,CACT,GAAI,YACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAGT,QAAS,CACP,GAAI,UACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,CAAA,EAEZ,eAAgB,mBAChB,MAAO,SAAA,EAGT,SAAU,CACR,GAAI,WACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,GACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,eAChB,MAAO,SAAA,EAGT,YAAa,CACX,GAAI,cACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,eAChB,MAAO,SAAA,EAIT,YAAa,CACX,GAAI,cACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,CAAA,EAEZ,eAAgB,cAChB,MAAO,SAAA,EAGT,kBAAmB,CACjB,GAAI,oBACJ,KAAM,OACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,EAGT,cAAe,CACb,GAAI,gBACJ,KAAM,MACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,EACX,SAAU,EAAA,EAEZ,eAAgB,OAChB,MAAO,SAAA,EAGT,aAAc,CACZ,GAAI,eACJ,KAAM,KACN,KAAM,OAEN,gBAAiB,CAAE,KAAM,UAAW,MAAO,CAAA,EAC3C,MAAO,CACL,WAAY,IACZ,UAAW,IACX,WAAY,GACZ,UAAW,GACX,SAAU,EAAA,EAEZ,eAAgB,aAChB,MAAO,SAAA,CAEX,EAEaC,GAAoD,CAC/D,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,EACR,EC1eaC,EAA6C,CAGxD,YAAa,CACX,GAAI,cACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,EACR,MAAO,IACP,QAAS,GACT,UAAW,EACX,MAAO,SAAA,EAGT,aAAc,CACZ,GAAI,eACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,EACR,MAAO,IACP,QAAS,GACT,UAAW,EACX,MAAO,SAAA,EAIT,WAAY,CACV,GAAI,aACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,GACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,YAAa,CACX,GAAI,cACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAKT,WAAY,CACV,GAAI,aACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,EACR,MAAO,IACP,QAAS,GACT,UAAW,EACX,MAAO,SAAA,EAGT,YAAa,CACX,GAAI,cACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,EACR,MAAO,GACP,QAAS,GACT,UAAW,EACX,MAAO,SAAA,EAIT,YAAa,CACX,GAAI,cACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,WAAY,CACV,GAAI,aACJ,KAAM,OACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAKT,YAAa,CACX,GAAI,cACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,cAAe,CACb,GAAI,gBACJ,KAAM,OACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAIT,gBAAiB,CACf,GAAI,kBACJ,KAAM,OACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,eAAgB,CACd,GAAI,iBACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAKT,oBAAqB,CACnB,GAAI,sBACJ,KAAM,OACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,iBAAkB,CAChB,GAAI,mBACJ,KAAM,MACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAIT,oBAAqB,CACnB,GAAI,sBACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,IACT,UAAW,GACX,MAAO,SAAA,EAGT,uBAAwB,CACtB,GAAI,yBACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,GACP,QAAS,IACT,UAAW,GACX,MAAO,SAAA,EAKT,kBAAmB,CACjB,GAAI,oBACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,oBAAqB,CACnB,GAAI,sBACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,GACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAIT,mBAAoB,CAClB,GAAI,qBACJ,KAAM,MACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,IACT,UAAW,GACX,MAAO,SAAA,EAGT,mBAAoB,CAClB,GAAI,qBACJ,KAAM,OACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,IACT,UAAW,GACX,MAAO,SAAA,EAKT,uBAAwB,CACtB,GAAI,yBACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAGT,eAAgB,CACd,GAAI,iBACJ,KAAM,KACN,QAAS,WACT,KAAM,SACN,OAAQ,GACR,OAAQ,GACR,MAAO,IACP,QAAS,GACT,UAAW,GACX,MAAO,SAAA,EAIT,wBAAyB,CACvB,GAAI,0BACJ,KAAM,KACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,IACT,UAAW,GACX,MAAO,SAAA,EAGT,sBAAuB,CACrB,GAAI,wBACJ,KAAM,KACN,QAAS,WACT,KAAM,QACN,OAAQ,IACR,OAAQ,GACR,MAAO,IACP,QAAS,IACT,UAAW,GACX,MAAO,SAAA,CAEX,EAEaC,GAAwC,CACnD,OAAQ,GACR,MAAO,EACT,ECzUaC,EAA0C,CAErD,aAAc,CACZ,GAAI,eACJ,KAAM,MACN,YAAa,0BACb,OAAQ,SACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAIZ,WAAY,CACV,GAAI,aACJ,KAAM,MACN,YAAa,qBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,gBAAiB,CACf,GAAI,kBACJ,KAAM,MACN,YAAa,qBACb,OAAQ,OACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAEZ,YAAa,CACX,GAAI,cACJ,KAAM,MACN,YAAa,mBACb,OAAQ,OACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAEZ,aAAc,CACZ,GAAI,eACJ,KAAM,MACN,YAAa,mBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,WAAY,CACV,GAAI,aACJ,KAAM,OACN,YAAa,qBACb,OAAQ,OACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAEZ,YAAa,CACX,GAAI,cACJ,KAAM,MACN,YAAa,sBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAIZ,WAAY,CACV,GAAI,aACJ,KAAM,MACN,YAAa,sBACb,OAAQ,OACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAEZ,YAAa,CACX,GAAI,cACJ,KAAM,MACN,YAAa,uBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,KAAM,CACJ,GAAI,OACJ,KAAM,MACN,YAAa,kBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,WAAY,CACV,GAAI,aACJ,KAAM,OACN,YAAa,mBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,iBAAkB,CAChB,GAAI,mBACJ,KAAM,MACN,YAAa,oBACb,OAAQ,OACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAIZ,WAAY,CACV,GAAI,aACJ,KAAM,QACN,YAAa,qBACb,OAAQ,YACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAEZ,mBAAoB,CAClB,GAAI,qBACJ,KAAM,MACN,YAAa,qBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,aAAc,CACZ,GAAI,eACJ,KAAM,MACN,YAAa,yBACb,OAAQ,YACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAIZ,oBAAqB,CACnB,GAAI,sBACJ,KAAM,QACN,YAAa,mBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,gBAAiB,CACf,GAAI,kBACJ,KAAM,OACN,YAAa,kBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,eAAgB,CACd,GAAI,iBACJ,KAAM,MACN,YAAa,oBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,YAAa,CACX,GAAI,cACJ,KAAM,MACN,YAAa,mBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,iBAAkB,CAChB,GAAI,mBACJ,KAAM,MACN,YAAa,iBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,cAAe,CACb,GAAI,gBACJ,KAAM,MACN,YAAa,8BACb,OAAQ,YACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAIZ,oBAAqB,CACnB,GAAI,sBACJ,KAAM,MACN,YAAa,uBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,mBAAoB,CAClB,GAAI,qBACJ,KAAM,MACN,YAAa,uBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,kBAAmB,CACjB,GAAI,oBACJ,KAAM,OACN,YAAa,oBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,qBAAsB,CACpB,GAAI,uBACJ,KAAM,MACN,YAAa,qBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,uBAAwB,CACtB,GAAI,yBACJ,KAAM,MACN,YAAa,sBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,mBAAoB,CAClB,GAAI,qBACJ,KAAM,OACN,YAAa,2BACb,OAAQ,YACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAIZ,uBAAwB,CACtB,GAAI,yBACJ,KAAM,MACN,YAAa,uBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,aAAc,CACZ,GAAI,eACJ,KAAM,MACN,YAAa,sBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,oBAAqB,CACnB,GAAI,sBACJ,KAAM,OACN,YAAa,oBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,uBAAwB,CACtB,GAAI,yBACJ,KAAM,OACN,YAAa,qBACb,OAAQ,YACR,WAAY,GACZ,YAAa,IACb,MAAO,EACP,SAAU,CAAA,EAEZ,cAAe,CACb,GAAI,gBACJ,KAAM,MACN,YAAa,oBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,iBAAkB,CAChB,GAAI,mBACJ,KAAM,OACN,YAAa,sBACb,OAAQ,YACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAIZ,gBAAiB,CACf,GAAI,kBACJ,KAAM,OACN,YAAa,sBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,EAEZ,mBAAoB,CAClB,GAAI,qBACJ,KAAM,MACN,YAAa,qBACb,OAAQ,OACR,WAAY,GACZ,YAAa,KACb,MAAO,EACP,SAAU,CAAA,CAEd,EAIaC,GAA0C,CACrD,qBAAsB,CACpB,GAAI,uBACJ,KAAM,KACN,YAAa,aACb,OAAQ,OACR,OAAQ,CACN,KAAM,SACN,MAAO,EAAA,CACT,EAEF,cAAe,CACb,GAAI,gBACJ,KAAM,KACN,YAAa,WACb,OAAQ,OACR,OAAQ,CACN,KAAM,SACN,MAAO,EAAA,CACT,EAEF,SAAU,CACR,GAAI,WACJ,KAAM,KACN,YAAa,WACb,OAAQ,SACR,OAAQ,CACN,KAAM,SACN,MAAO,EAAA,CACT,EAEF,gBAAiB,CACf,GAAI,kBACJ,KAAM,MACN,YAAa,SACb,OAAQ,OACR,OAAQ,CACN,KAAM,QACN,MAAO,CAAA,CACT,EAEF,gBAAiB,CACf,GAAI,kBACJ,KAAM,MACN,YAAa,YACb,OAAQ,OACR,OAAQ,CACN,KAAM,QACN,MAAO,EAAA,CACT,EAEF,aAAc,CACZ,GAAI,eACJ,KAAM,KACN,YAAa,SACb,OAAQ,OACR,OAAQ,CACN,KAAM,QACN,MAAO,CAAA,CACT,EAEF,gBAAiB,CACf,GAAI,kBACJ,KAAM,KACN,YAAa,YACb,OAAQ,OACR,OAAQ,CACN,KAAM,WACN,MAAO,EAAA,CACT,EAEF,UAAW,CACT,GAAI,YACJ,KAAM,MACN,YAAa,WACb,OAAQ,OACR,OAAQ,CACN,KAAM,WACN,MAAO,EAAA,CACT,EAEF,aAAc,CACZ,GAAI,eACJ,KAAM,KACN,YAAa,UACb,OAAQ,YACR,OAAQ,CACN,KAAM,MACN,MAAO,GAAA,CACT,EAEF,kBAAmB,CACjB,GAAI,oBACJ,KAAM,MACN,YAAa,YACb,OAAQ,YACR,OAAQ,CACN,KAAM,SACN,MAAO,CAAA,CACT,EAEF,aAAc,CACZ,GAAI,eACJ,KAAM,MACN,YAAa,iBACb,OAAQ,OACR,OAAQ,CACN,KAAM,cACN,MAAO,GAAA,CACT,CAEJ,EAGaC,GAGT,CAEF,WAAY,CACV,UAAW,CAAC,eAAgB,eAAgB,MAAM,EAClD,OAAQ,YAAA,EAGV,mBAAoB,CAClB,UAAW,CAAC,cAAe,aAAc,iBAAiB,EAC1D,OAAQ,oBAAA,EAGV,aAAc,CACZ,UAAW,CAAC,aAAc,aAAc,YAAY,EACpD,OAAQ,cAAA,EAGV,iBAAkB,CAChB,UAAW,CAAC,aAAc,YAAY,EACtC,OAAQ,kBAAA,EAGV,YAAa,CACX,UAAW,CAAC,cAAe,cAAc,EACzC,OAAQ,aAAA,EAGV,WAAY,CACV,UAAW,CAAC,OAAQ,YAAY,EAChC,OAAQ,YAAA,EAGV,WAAY,CACV,UAAW,CAAC,cAAe,aAAa,EACxC,OAAQ,YAAA,EAGV,aAAc,CACZ,UAAW,CAAC,cAAe,aAAa,EACxC,OAAQ,cAAA,EAGV,oBAAqB,CACnB,UAAW,CAAC,cAAe,cAAc,EACzC,OAAQ,qBAAA,EAGV,gBAAiB,CACf,UAAW,CAAC,OAAQ,aAAa,EACjC,OAAQ,iBAAA,EAGV,eAAgB,CACd,UAAW,CAAC,OAAQ,aAAa,EACjC,OAAQ,gBAAA,EAGV,YAAa,CACX,UAAW,CAAC,aAAc,MAAM,EAChC,OAAQ,aAAA,EAGV,iBAAkB,CAChB,UAAW,CAAC,cAAe,YAAY,EACvC,OAAQ,kBAAA,EAGV,oBAAqB,CACnB,UAAW,CAAC,eAAgB,YAAY,EACxC,OAAQ,qBAAA,EAGV,mBAAoB,CAClB,UAAW,CAAC,cAAe,kBAAkB,EAC7C,OAAQ,oBAAA,EAGV,kBAAmB,CACjB,UAAW,CAAC,qBAAsB,aAAa,EAC/C,OAAQ,mBAAA,EAGV,qBAAsB,CACpB,UAAW,CAAC,cAAe,iBAAiB,EAC5C,OAAQ,sBAAA,EAGV,uBAAwB,CACtB,UAAW,CAAC,mBAAoB,YAAY,EAC5C,OAAQ,wBAAA,EAGV,mBAAoB,CAClB,UAAW,CAAC,aAAc,YAAY,EACtC,OAAQ,oBAAA,EAGV,uBAAwB,CACtB,UAAW,CAAC,cAAe,aAAc,MAAM,EAC/C,OAAQ,wBAAA,EAGV,aAAc,CACZ,UAAW,CAAC,OAAQ,YAAY,EAChC,OAAQ,cAAA,EAGV,oBAAqB,CACnB,UAAW,CAAC,qBAAsB,cAAe,YAAY,EAC7D,OAAQ,qBAAA,EAGV,uBAAwB,CACtB,UAAW,CAAC,sBAAuB,YAAY,EAC/C,OAAQ,wBAAA,EAGV,cAAe,CACb,UAAW,CAAC,aAAc,cAAc,EACxC,OAAQ,eAAA,EAGV,iBAAkB,CAChB,UAAW,CAAC,qBAAsB,OAAQ,iBAAiB,EAC3D,OAAQ,kBAAA,EAGV,gBAAiB,CACf,UAAW,CAAC,OAAQ,qBAAqB,EACzC,OAAQ,iBAAA,EAGV,mBAAoB,CAClB,UAAW,CAAC,aAAc,aAAa,EACvC,OAAQ,oBAAA,CAEZ,EAGaC,GAA8C,CACzD,OAAQ,SACR,KAAM,QACN,KAAM,SACN,UAAW,QACb,EACaC,GAA4C,CACvD,OAAQ,GACR,KAAM,GACN,KAAM,GACN,UAAW,EACb,EAEaC,GAAgD,CAC3D,OAAQ,KACR,KAAM,KACN,KAAM,KACN,UAAW,GACb,EAEaC,GAA6C,CACxD,OAAQ,IACR,KAAM,IACN,KAAM,IACN,UAAW,GACb,EAEaC,GAA8C,CACzD,OAAQ,EACR,KAAM,EACN,KAAM,GACN,UAAW,EACb,EAEaC,GAAiD,CAC5D,OAAQ,EACR,KAAM,EACN,KAAM,EACN,UAAW,CACb,EAEaC,EAAU,CACrB,OAAQ,UACR,UAAW,aACX,QAAS,WACT,KAAM,MACR,EAEaC,GAAyB,GACzBC,GAAwB,IAExBC,GAAsB,GAEtBC,GAAsB,2DCzqB7BC,GAAiB,IAAM,CAC3B,KAAM,CAACC,CAAC,EAAIC,EAAA,EACNC,EAAWC,GAAA,EAEjB,OACEC,EAAAA,IAAC,SAAA,CACC,MAAOF,EACP,UAAWG,GAAO,iBAClB,SAAWC,GAAM,CACfC,EAAK,eAAeD,EAAE,OAAO,KAAiB,CAChD,EACA,GAAG,kBAEF,SAAAE,EAAqB,IAAKC,SACxB,SAAA,CAAkB,MAAOA,EACvB,SAAAT,EAAE,aAAaS,CAAI,EAAE,CAAA,EADXA,CAEb,CACD,CAAA,CAAA,CAGP,2aCfaC,GAA2CC,GAAM,KAC5D,CAAC,CAAE,QAAAC,EAAS,KAAAC,EAAM,OAAAC,KAEdV,EAAAA,IAAC,MAAA,CACC,UAAW,GAAGC,EAAO,KAAQ,IAAIA,EAAOQ,CAAI,CAAC,GAC7C,cAAaC,EAEb,eAAC,MAAA,CAAI,UAAWT,EAAO,QAAa,SAAAO,CAAA,CAAQ,CAAA,CAAA,CAIpD,EAEAF,GAAM,YAAc,QAEb,SAASK,EAAMC,EAAc,CAClC,KAAM,CAAE,SAAAC,EAAW,EAAG,GAAGC,GAASF,EAClC,IAAIG,EAAmC,SAAS,cAAc,KAAK,EACnEA,EAAU,UAAYd,EAAO,UAC7B,SAAS,KAAK,YAAYc,CAAS,EACnC,MAAMC,EAAaC,GAAAA,WAAWF,CAAS,EACvCC,EAAK,OAAOhB,EAAAA,IAACM,GAAA,CAAO,GAAGQ,EAAM,CAAE,EAE/B,SAASI,GAAQ,CACVH,IAGLC,EAAK,QAAA,EACDD,EAAU,YACZ,SAAS,KAAK,YAAYA,CAAS,EAErCA,EAAY,KACd,CAEA,MAAMI,EAAQ,WAAWD,EAAOL,EAAW,GAAI,EAG/C,MAAO,IAAM,CACX,aAAaM,CAAK,EAClBD,EAAA,CACF,CACF,CAEAP,EAAM,MAAQ,SAAUH,EAAiBE,EAAS,cAAe,CAC/D,OAAOC,EAAM,CAAE,QAAAH,EAAS,KAAM,QAAS,OAAAE,EAAQ,CACjD,EAEAC,EAAM,KAAO,SAAUH,EAAiBE,EAAS,aAAc,CAC7D,OAAOC,EAAM,CAAE,QAAAH,EAAS,KAAM,OAAQ,OAAAE,EAAQ,CAChD,EAEAC,EAAM,QAAU,SAAUH,EAAiBE,EAAS,gBAAiB,CACnE,OAAOC,EAAM,CAAE,QAAAH,EAAS,KAAM,UAAW,OAAAE,EAAQ,CACnD,EAEAC,EAAM,QAAU,SAAUH,EAAiBE,EAAS,gBAAiB,CACnE,OAAOC,EAAM,CAAE,QAAAH,EAAS,KAAM,UAAW,OAAAE,EAAQ,CACnD,EClEO,MAAMU,GAAgBZ,GAA6B,CACxD,MAAMa,EAAM,OAAO,QAAQb,CAAO,EAElC,OAAIa,GACFV,EAAM,QAAQR,EAAK,EAAE,uBAAuB,CAAC,EAExCkB,CACT,EAEA,SAASC,GAAkBC,EAAc,CACnCA,EAAQ,kBACVA,EAAQ,kBAAA,EACCA,EAAQ,wBAEjBA,EAAQ,wBAAA,EACCA,EAAQ,qBAEjBA,EAAQ,qBAAA,EACCA,EAAQ,qBAEjBA,EAAQ,oBAAA,CAEZ,CAEA,SAASC,IAAiB,CACxB,MAAMD,EAAU,SAEZA,EAAQ,eACVA,EAAQ,eAAA,EACCA,EAAQ,qBACjBA,EAAQ,qBAAA,EACCA,EAAQ,oBACjBA,EAAQ,oBAAA,EACCA,EAAQ,kBACjBA,EAAQ,iBAAA,CAEZ,CAEO,SAASE,IAAe,CAC7B,MAAMF,EAAU,SAQhB,MALE,CAAC,CAACA,EAAQ,mBACV,CAAC,CAACA,EAAQ,yBACV,CAAC,CAACA,EAAQ,sBACV,CAAC,CAACA,EAAQ,mBAGd,CAEO,MAAMG,GAAoBC,GAAoB,CACtCF,GAAA,IAEAE,IAITA,EACFL,GAAkB,SAAS,eAAe,EAE1CE,GAAA,EAEJ,ECvDaI,GAAcC,GAA4B,CACrD,MAAMC,EAAO,KAAK,MAAMD,EAAU,EAAE,EAC9BE,EAAO,KAAK,MAAMF,EAAU,EAAE,EACpC,MAAO,GAAGC,EAAK,SAAA,EAAW,SAAS,EAAG,GAAG,CAAC,IAAIC,EAAK,SAAA,EAAW,SAAS,EAAG,GAAG,CAAC,EAChF,EAKO,SAASC,GAAgBC,EAA8B,CAO5D,MAN8C,CAC5C,OAAQ,GACR,KAAM,GACN,KAAM,GACN,UAAW,CAAA,EAEEA,CAAM,CACvB,CAGA,SAASC,GACPC,EACAC,EACK,CAEL,MAAMC,EAAgB,OAAO,QAAQF,CAAK,EAAE,IAAI,CAAC,CAACG,EAAIC,CAAI,KAAO,CAC/D,GAAAD,EACA,OAAQN,GAAiBO,EAAkC,MAAM,CAAA,EACjE,EAEIC,EAAgB,CAAA,EAChBC,EAAiB,CAAC,GAAGJ,CAAa,EAGxC,KAAOG,EAAS,OAASJ,GAASK,EAAe,OAAS,GAAG,CAE3D,MAAMC,EAAcD,EAAe,OACjC,CAACE,EAAKJ,IAASI,EAAMJ,EAAK,OAC1B,CAAA,EAIF,IAAIK,EAAS,KAAK,OAAA,EAAWF,EACzBG,EAAgB,GAEpB,QAASC,EAAI,EAAGA,EAAIL,EAAe,QAAUG,EAAS,EAAGE,IAEvD,GADAF,GAAUH,EAAeK,CAAC,EAAE,OACxBF,GAAU,EAAG,CACfC,EAAgBC,EAChB,KACF,CAGED,GAAiB,IACnBL,EAAS,KAAKC,EAAeI,CAAa,EAAE,EAAE,EAC9CJ,EAAe,OAAOI,EAAe,CAAC,EAE1C,CAEA,OAAOL,CACT,CAGO,MAAMO,GAAsBT,GAC1B,kBAAkBA,CAAE,OAGhBU,GAAyBV,GAC7B,qBAAqBA,CAAE,OAGnBW,GAAqBX,GACzB,kBAAkBA,CAAE,OAGhBY,GAAmBZ,GACvB,eAAeA,CAAE,OAInB,SAASa,GAAiBf,EAA6B,CAC5D,OAAOF,GAAyBrD,EAASuD,CAAK,CAChD,CAGO,SAASgB,GAAiBhB,EAA6B,CAC5D,OAAOF,GAAyBpD,GAASsD,CAAK,CAChD,CAKA,SAASiB,GACPC,EACAC,EACS,CACT,MAAMC,EAASzE,GAAewE,CAAS,EACvC,OAAKC,EAEEA,EAAO,UAAU,MAAOC,GAAaH,EAAa,SAASG,CAAQ,CAAC,EAFvD,EAGtB,CAGO,SAASC,GAAmBJ,EAA0C,CAC3E,MAAMK,EAA0B,CAAA,EAEhC,cAAO,QAAQ5E,EAAc,EAAE,QAAQ,CAAC,CAAC6E,EAAKJ,CAAM,IAAM,CAEtDH,GAAeC,EAAcM,CAAG,GAChC,CAACN,EAAa,SAASE,EAAO,MAAM,GAEpCG,EAAU,KAAKH,EAAO,MAAM,CAEhC,CAAC,EAEMG,CACT,CAEO,MAAME,EAAoBC,GAAkBA,EAAQ,IAAM,IC7HpDC,GAAoB,KAEpBC,EAAkB,CAC7B,CACE,GAAI,WACJ,QAAS,EACT,gBAAiB,CACf,KAAM,UACN,MAAO,CAAA,EAET,WAAY,EACZ,iBAAkB,CAChB,cACA,eACA,aACA,aAAA,CACF,EAEF,CACE,GAAI,WACJ,QAAS,EACT,gBAAiB,CACf,KAAM,UACN,MAAO,CAAA,EAET,WAAY,EACZ,iBAAkB,CAChB,aACA,cACA,cACA,YAAA,CACF,EAEF,CACE,GAAI,WACJ,QAAS,EACT,gBAAiB,CACf,KAAM,UACN,MAAO,CAAA,EAET,WAAY,EACZ,iBAAkB,CAChB,cACA,gBACA,kBACA,gBAAA,CACF,EAEF,CACE,GAAI,WACJ,QAAS,EACT,gBAAiB,CACf,KAAM,UACN,MAAO,CAAA,EAET,WAAY,EACZ,iBAAkB,CAChB,sBACA,mBACA,sBACA,wBAAA,CACF,EAEF,CACE,GAAI,WACJ,QAAS,EACT,gBAAiB,CACf,KAAM,UACN,MAAO,CAAA,EAET,WAAY,EACZ,iBAAkB,CAChB,oBACA,sBACA,qBACA,oBAAA,CACF,EAEF,CACE,GAAI,WACJ,QAAS,EACT,gBAAiB,CACf,KAAM,UACN,MAAO,CAAA,EAET,WAAY,EACZ,iBAAkB,CAChB,yBACA,iBACA,0BACA,uBAAA,CACF,CAEJ,EAGaC,EAA0B,IAC1BC,EAAoB,GAEpBC,EAAyC,CACpD,CACE,GAAI,SACJ,SAAUD,EACV,KAAML,EACN,OAASC,GAAUA,EAAQ,CAAA,EAE7B,CACE,GAAI,SACJ,SAAUI,EACV,KAAML,EACN,OAASC,GAAUA,EAAQ,EAAA,EAE7B,CACE,GAAI,QACJ,SAAUI,EACV,KAAML,EACN,OAASC,GAAUA,EAAQ,CAAA,EAE7B,CACE,GAAI,OACJ,SAAUI,EACV,KAAML,EACN,OAASC,GAAUA,EAAQ,CAAA,EAE7B,CACE,GAAI,QACJ,SAAUI,EACV,KAAML,EACN,OAASC,GAAUA,EAAQ,CAAA,EAE7B,CACE,GAAI,WACJ,SAAUI,EACV,KAAML,EACN,OAASC,GAAUA,EAAQG,CAAA,EAE7B,CACE,GAAI,WACJ,SAAUC,EACV,KAAML,EACN,OAASC,GAAUA,EAAQG,CAAA,EAE7B,CACE,GAAI,cACJ,SAAUC,EACV,KAAML,EACN,OAASC,GAAUA,EAAQG,CAAA,EAE7B,CACE,GAAI,eACJ,SAAUC,EACV,KAAML,EACN,OAASC,GAAUA,EAAQG,CAAA,CAE/B,EAGaG,GAAyB,CACpC,UAAW,EACX,WAAY,EACZ,iBAAkB,EAClB,cAAe,EACf,kBAAmB,CAAA,EACnB,OAAQ,EACR,OAAQ,EACR,MAAO,EACP,KAAM,EACN,MAAO,EACP,SAAU,EACV,SAAU,EACV,YAAa,EACb,aAAc,CAChB,EAEaC,GAAa,ICjLbC,EAAY,OAAO,OAAO,CACrC,aAAc,eACd,oBAAqB,sBACrB,iBAAkB,kBACpB,CAAU,EAEGC,GAAgB,EAEhBC,EAAkB,EAElBC,GAAe,EAAQ,aAAa,QAAQ,OAAO,ECuB1DC,GAAe,IAAuB,CAC1C,MAAMC,EAAQC,EAAa,SAAA,EACrB,CAAE,kBAAAC,GAAsBF,EAExBG,EAA4B,CAAA,EAC5BC,EAAwC,CAAA,EAExCC,EAAWH,EAAkB,IAAKI,GACzBjB,EAAK,KAAMkB,GAAMA,EAAE,KAAOD,CAAC,GAC3B,SAAW,CACzB,EAGD,OAAAjB,EAAK,QAASmB,GAAQ,CACpB,GAAI,CAACL,EAAe,SAASK,EAAI,EAAE,EAAG,CACpC,IAAIC,EAAW,GAEf,OAAQD,EAAI,gBAAgB,KAAA,CAC1B,IAAK,UACHC,EAAW,GACX,MACF,IAAK,UACHA,EAAWJ,EAAS,SAASG,EAAI,gBAAgB,KAAK,EACtD,KAAA,CAGAC,GACFN,EAAe,KAAKK,EAAI,EAAE,CAE9B,CACF,CAAC,EAGD,OAAO,OAAO1G,CAAe,EAAE,QAAS4G,GAAS,CAC/C,GAAI,CAACN,EAAqB,SAASM,EAAK,EAAE,EAAG,CAC3C,IAAID,EAAW,GAEf,OAAQC,EAAK,gBAAgB,KAAA,CAC3B,IAAK,UACHD,EAAW,GACX,MACF,IAAK,QACHA,EAAWT,EAAM,YAAcU,EAAK,gBAAgB,MACpD,MACF,IAAK,OACHD,EAAWT,EAAM,kBAAoBU,EAAK,gBAAgB,MAC1D,MACF,IAAK,OACHD,EAAWT,EAAM,WAAaU,EAAK,gBAAgB,MACnD,MACF,IAAK,UAAW,CACdD,EAAWJ,EAAS,SAASK,EAAK,gBAAgB,KAAK,EACvD,KACF,CAAA,CAGED,GACFL,EAAqB,KAAKM,EAAK,EAAE,CAErC,CACF,CAAC,EAEM,CACL,qBAAAN,EACA,eAAAD,CAAA,CAEJ,EAEaQ,EAAcC,GAAc,CAACC,EAAKC,KACtC,CACL,oBAAqB,eACrB,cAAe,WACf,qBAAsB,CAAA,EACtB,eAAgB,CAAA,EAChB,aAAc,CAAA,EACd,UAAW,CACTD,EAAI,CACF,oBAAqB,eACrB,cAAe,WACf,qBAAsB,CAAA,EACtB,eAAgB,CAAA,EAChB,aAAc,CAAA,CAAC,CAChB,CACH,EACA,UAAYE,GAAa,CACvB,KAAM,CAAE,aAAApC,CAAA,EAAiBmC,EAAA,EAEpBnC,EAAa,SAASoC,CAAQ,GACjCF,EAAI,CAAE,aAAc,CAAC,GAAGlC,EAAcoC,CAAQ,EAAG,CAErD,EACA,gBAAkBC,GAA+B,CAC/C,KAAM,CAAE,qBAAAZ,CAAA,EAAyBU,EAAA,EAC7BV,EAAqB,SAASY,CAAW,GAC3CH,EAAI,CAAE,oBAAqBG,EAAa,CAE5C,EAEA,UAAYC,GAAmB,CAC7B,KAAM,CAAE,eAAAd,CAAA,EAAmBW,EAAA,EACvBX,EAAe,SAASc,CAAK,GAC/BJ,EAAI,CAAE,cAAeI,EAAO,CAEhC,EACA,oBAAqB,CACnB,KAAM,CAAE,oBAAqBC,CAAA,EAAsBJ,EAAA,EAEnD,OACEhH,EAAgBoH,CAAiB,GAAKpH,EAAgB,YAE1D,EACA,cAAe,CACb,KAAM,CAAE,cAAeqH,CAAA,EAAgBL,EAAA,EAEvC,OAAOzB,EAAK,KAAMmB,GAAQA,EAAI,KAAOW,CAAW,GAAK9B,EAAK,CAAC,CAC7D,EAEA,aAAc,IAAM,CAClBwB,EAAId,IAAc,CACpB,CAAA,EAEH,EAEKqB,GAAwBpB,GAAiBA,EAAM,oBAC/CqB,GAAkBrB,GAAiBA,EAAM,cACzCsB,GAAyBtB,GAAiBA,EAAM,qBAChDuB,GAAmBvB,GAAiBA,EAAM,eAEnCwB,GAAuB,IAClCb,EAAYc,EAAWL,EAAoB,CAAC,EACjCM,GAAiB,IAAMf,EAAYc,EAAWJ,EAAc,CAAC,EAC7DM,GAAwB,IACnChB,EAAYc,EAAWH,EAAqB,CAAC,EAClCM,GAAkB,IAAMjB,EAAYc,EAAWF,EAAe,CAAC,EC/JtEM,GAAW,yBAgBJ5B,EAAeW,GAAA,EAC1BkB,GACE,CAACjB,EAAKC,KAAS,CACb,GAAGrB,GAGH,QAAUsC,GAAmB,CAC3BlB,EAAI,CAAE,UAAWC,EAAA,EAAM,UAAYiB,EAAQ,EAC3CpB,EAAY,SAAA,EAAW,aAAA,CACzB,EAEA,UAAYoB,GAAmB,CAC7B,MAAM/B,EAAQc,EAAA,EACd,OAAId,EAAM,WAAa+B,GACrBlB,EAAI,CAAE,UAAWb,EAAM,UAAY+B,EAAQ,EACpC,IAEF,EACT,EAEA,SAAWA,GAAmB,CAC5BlB,EAAI,CACF,WAAYC,EAAA,EAAM,WAAaiB,CAAA,CAChC,EACDpB,EAAY,SAAA,EAAW,aAAA,CACzB,EAEA,eAAiBzD,GAAoB,CACnCA,EAAU,KAAK,MAAMA,CAAO,EAE5B,MAAM8C,EAAQc,EAAA,EAERkB,EAAchC,EAAM,cAAgB9C,EACpC+E,EACJ/E,EAAU8C,EAAM,iBAAmB9C,EAAU8C,EAAM,iBACrDa,EAAI,CACF,cAAemB,EACf,iBAAkBC,CAAA,CACnB,EACDtB,EAAY,SAAA,EAAW,aAAA,CACzB,EAEA,iBAAmBuB,GAAoC,CACrD,MAAMlC,EAAQc,EAAA,EACRqB,EAAU3C,EAAmB,KAAM4C,GAAMA,EAAE,KAAOF,CAAS,EACjE,GAAI,CAACC,EAAS,MAAO,GAErB,MAAME,EAAerC,EAAMkC,CAAS,GAAK,EACzC,GAAIG,GAAgBF,EAAQ,SAAU,MAAO,GAE7C,MAAMG,EAAOH,EAAQ,KAAKE,CAAY,EACtC,OAAIrC,EAAM,WAAasC,GACrBzB,EAAI,CACF,UAAWb,EAAM,UAAYsC,EAC7B,CAACJ,CAAS,EAAGG,EAAe,CAAA,CAC7B,EACM,IAEF,EACT,EAEA,uBAAwB,IAAM,CAC5B,MAAMrC,EAAQc,EAAA,EACd,IAAIyB,EAAS,EAEb/C,EAAmB,QAAS5B,GAAS,CACnC,MAAMuB,EAAQa,EAAMpC,EAAK,EAAE,GAAK,EAChC,QAASO,EAAI,EAAGA,EAAIgB,EAAOhB,IACzBoE,GAAU3E,EAAK,KAAKO,CAAC,CAEzB,CAAC,EAEDoE,EAAS,KAAK,MAAMA,CAAM,EAG1B,MAAMC,EAA+D,CAAA,EACrEhD,EAAmB,QAAS5B,GAAS,CACnC4E,EAAc5E,EAAK,EAAE,EAAI,CAC3B,CAAC,EAEDiD,EAAI,CACF,GAAG2B,EACH,UAAWxC,EAAM,UAAYuC,CAAA,CAC9B,CACH,EAEA,SAAU,IAAM1B,EAAI,CAAE,GAAGpB,GAAc,EAGvC,gBAAkBY,GAAa,CAC7B,KAAM,CAAE,kBAAAH,EAAoB,EAAC,EAAMY,EAAA,EAE7B2B,EAAO,MAAM,KAAK,IAAI,IAAI,CAAC,GAAGvC,EAAmB,GAAGG,CAAQ,CAAC,CAAC,EAEpEQ,EAAI,CAAE,kBAAmB4B,EAAM,EAE/B9B,EAAY,SAAA,EAAW,aAAA,CACzB,CAAA,GAEF,CACE,KAAMkB,GACN,MAAO,CAACa,EAAgBC,KAAkB,CACxC,GAAGlD,GACH,GAAGkD,EACH,GAAID,CAAA,GAEN,QAASE,GAAkB,IAAM,YAAY,CAAA,CAC/C,CAEJ,EAEMC,GAAgB7C,GAAoBA,EAAM,UAC1C8C,GAAiB9C,GAAoBA,EAAM,WAC3C+C,GAAuB/C,GAAoBA,EAAM,iBACjDgD,GAAoBhD,GAAoBA,EAAM,cAE9CiD,GAAwBjD,GAAoBA,EAAM,kBAElDkD,GACJlD,IAC0C,CAC1C,OAAQA,EAAM,OACd,OAAQA,EAAM,OACd,MAAOA,EAAM,MACb,MAAOA,EAAM,MACb,KAAMA,EAAM,KACZ,SAAUA,EAAM,SAChB,SAAUA,EAAM,SAChB,YAAaA,EAAM,YACnB,aAAcA,EAAM,YACtB,GAEamD,GAAe,IAAMlD,EAAawB,EAAWoB,EAAY,CAAC,EAC1DO,GAAgB,IAAMnD,EAAawB,EAAWqB,EAAa,CAAC,EAC5DO,GAAsB,IACjCpD,EAAawB,EAAWsB,EAAmB,CAAC,EACjCO,GAAmB,IAC9BrD,EAAawB,EAAWuB,EAAgB,CAAC,EAE9BO,GAAuB,IAClCtD,EAAawB,EAAWwB,EAAoB,CAAC,EAElCO,GAAe,IAAMvD,EAAawB,EAAWyB,EAAY,CAAC,ECnJ1DO,GAAgC,CAC3C,YAAa,GACb,aAAc,GACd,iBAAkB,GAClB,gBAAiB,GACjB,SAAUrE,GACV,iBAAkB,EACpB,EAEMyC,GAAW,4BAcJ6B,EAAkB9C,GAAA,EAC7BkB,GACGjB,IAAS,CACR,GAAG4C,GACH,qBAAqBE,EAAkB,CACrC9C,EAAI,CAAE,iBAAkB8C,EAAS,CACnC,EACA,YAAYC,EAAkB,CAC5B/C,EAAI,CAAE,SAAA+C,EAAU,CAClB,EACA,qBAAqBD,EAAS,CAC5B9C,EAAI,CAAE,iBAAkB8C,EAAS,CACnC,EACA,oBAAoBA,EAAS,CAC3B9C,EAAI,CAAE,gBAAiB8C,EAAS,EAC5BA,GACF1D,EAAa,WAAW,gBAAgBZ,EAAK,IAAKkB,GAAMA,EAAE,EAAE,CAAC,CAEjE,EACA,eAAesD,EAAQ,CACrB,MAAM5I,EAAI6I,EAAO,KAAK,MAAMD,EAAQ,EAAG,CAAC,EACxChD,EAAI,CAAE,YAAa5F,EAAG,CACxB,EACA,gBAAgB0I,EAAS,CACvB9C,EAAI,CAAE,aAAc8C,EAAS,CAC/B,EAEA,YAAcxI,GAAa0F,EAAI,CAAE,SAAA1F,EAAU,EAE3C,SAAU,IAAM0F,EAAI,CAAE,GAAG4C,GAAiB,CAAA,GAE5C,CACE,KAAM5B,GACN,MAAO,CAACa,EAAgBC,KAAkB,CACxC,GAAGc,GACH,GAAGd,EACH,GAAID,CAAA,GAEN,QAASE,GAAkB,IAAM,YAAY,CAAA,CAC/C,CAEJ,EAEMmB,GAAe/D,GAAwBA,EAAM,SAC7CgE,GAAuBhE,GAAwBA,EAAM,iBACrDiE,GAAsBjE,GAAwBA,EAAM,gBACpDkE,GAAmBlE,GAAwBA,EAAM,aACjDmE,GAAkBnE,GAAwBA,EAAM,YAChDoE,GAAepE,GAAwBA,EAAM,SAC7CqE,GAAuBrE,GAAwBA,EAAM,iBAE9C5E,GAAc,IAAMsI,EAAgBjC,EAAWsC,EAAW,CAAC,EAC3DO,GAAsB,IACjCZ,EAAgBjC,EAAWuC,EAAmB,CAAC,EACpCO,GAAqB,IAChCb,EAAgBjC,EAAWwC,EAAkB,CAAC,EACnCO,GAAkB,IAC7Bd,EAAgBjC,EAAWyC,EAAe,CAAC,EAChCO,GAAiB,IAAMf,EAAgBjC,EAAW0C,EAAc,CAAC,EACjEO,GAAc,IAAMhB,EAAgBjC,EAAW2C,EAAW,CAAC,EAC3DO,GAAsB,IACjCjB,EAAgBjC,EAAW4C,EAAmB,CAAC,kmiHCrF3CO,GAAY,CAChB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,EACxB,QAAS,CAAE,YAAaC,EAAA,CAC1B,EAEa7J,EAAuB,OAAO,KAAKmJ,EAAS,EAEzD,SAASW,IAAa,CACpB,MAAMC,EAAc,QAEpB,IAAIC,EAA4BD,EAC5BE,EAAc,GAElB,MAAMC,EAAkB,CAACjK,EAAO,KAAO,CACrC,MAAMkK,EACJlK,GACAgI,EAAgB,WAAW,UAC3B,UAAU,UACV8B,EAEF,GAAI/J,EAAqB,SAASmK,CAAY,EAC5C,OAAOA,EAGT,MAAMC,EAAWpK,EAAqB,KAAMmC,GAC1CA,EAAK,kBAAA,EAAoB,SAASgI,EAAa,mBAAmB,CAAA,EAEpE,OAAIC,GAEGL,CACT,EAEMM,EAAa,MAAOpK,EAAO,MAC/BgK,EAAc,GAEdD,EAAkBE,EAAgBjK,CAAI,EAEtC,MAAMF,GAAK,IAAIuK,EAAgB,EAAE,KAAK,CACpC,IAAKN,EACL,YAAaD,EACb,UAAAZ,GACA,cAAenJ,EACf,cAAe,CACb,YAAa,GACb,OAAQ,IACR,OAAQ,GAAA,EAEV,MAAO,CACL,YAAa,EAAA,CACf,CACD,EAEMgK,GAGT,MAAO,CACL,eAAgB,MAAO/J,IAChBgK,EAEMhK,GAAQA,IAAS+J,IAC1BA,EAAkBE,EAAgBjK,CAAI,EACtC,MAAMF,GAAK,eAAeiK,CAAe,GAHzC,MAAMK,EAAWpK,CAAI,EAMvBgI,EAAgB,SAAA,EAAW,YAAY+B,CAAe,EAE/CA,GAET,EAAGjK,GAAK,EACR,IAAI,UAAqB,CACvB,OAAOiK,CACT,CAAA,CAEJ,CAEA,MAAMO,EAAaT,GAAA,ujBCxFbU,GAAgB,OAAO,OAAOnM,CAAe,EAO7CoM,GAAkD,CAAC,CACvD,UAAAC,EACA,OAAAC,CACF,IAAM,CACJ,KAAM,CAACnL,CAAC,EAAIC,EAAA,EACNmL,EAAqB1E,GAAA,EACrBX,EAAcQ,GAAA,EAEdN,EAAoBoF,EAAAA,QAAQ,IACzB3F,EAAY,SAAA,EAAW,mBAAA,EAC7B,CAACK,CAAW,CAAC,EAEVuF,EAAwBC,GAA6B,CACrDH,EAAmB,SAASG,EAAU,EAAE,GAC1C7F,EAAY,SAAA,EAAW,gBAAgB6F,EAAU,EAAE,CAEvD,EAEMC,EAAgB,IAAM,CACtBvF,IACFP,EAAY,SAAA,EAAW,gBAAgBO,EAAkB,EAAE,EAC3DiF,EAAA,EAEJ,EAEA,OACEO,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,MAAC,KAAA,CAAG,cAAY,aAAc,SAAAJ,EAAE,4BAA4B,EAAE,EAC9DI,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,eAAgB,cAAY,kBAChD,SAAA2K,GAAc,IAAKO,GAAc,CAChC,MAAMG,EAAaN,EAAmB,SAASG,EAAU,EAAE,EACrDI,EAAa1F,GAAmB,KAAOsF,EAAU,GAEvD,OACEE,EAAAA,KAAC,MAAA,CAEC,UAAW,GAAGpL,EAAO,aAAa,IAAIqL,EAAarL,EAAO,SAAWA,EAAO,MAAM,IAAIsL,EAAatL,EAAO,SAAW,EAAE,GACvH,cAAa,kBAAkBkL,EAAU,EAAE,GAC3C,QAAS,IAAMD,EAAqBC,CAAS,EAE7C,SAAA,CAAAnL,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,cACpB,SAAAqL,EACCtL,EAAAA,IAAC,MAAA,CACC,IAAKgD,GAAsBmI,EAAU,EAAE,EACvC,IAAKvL,EAAE,cAAcuL,EAAU,EAAE,OAAO,EACxC,UAAWlL,EAAO,aAClB,MAAO,CACL,MAAOkL,EAAU,KAAA,CACnB,CAAA,EAGFnL,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,WAAY,cAAE,EAEzC,QAEC,MAAA,CAAI,UAAWA,EAAO,cACpB,WACGL,EAAE,cAAcuL,EAAU,EAAE,OAAO,EACnCvL,EAAE,oBAAoBuL,EAAU,gBAAgB,IAAI,GAAI,CACtD,MAAOA,EAAU,gBAAgB,KAAA,CAClC,CAAA,CACP,CAAA,CAAA,EA1BKA,EAAU,EAAA,CA6BrB,CAAC,CAAA,CACH,EAECtF,GACCwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,gBAAiB,cAAY,oBAClD,SAAA,CAAAD,EAAAA,IAAC,MAAI,SAAAJ,EAAE,cAAciG,EAAkB,EAAE,OAAO,EAAE,EAClD7F,EAAAA,IAAC,IAAA,CAAE,UAAWC,EAAO,YAClB,WAAE,cAAc4F,EAAkB,EAAE,cAAc,CAAA,CACrD,EACAwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,MACrB,SAAA,CAAAoL,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KAErB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,SAAU,SAAA,CAAA,MAAIL,EAAE,aAAa,CAAA,EAAE,QACtD,OAAA,CAAK,UAAWK,EAAO,UACrB,SAAA4F,EAAkB,MAAM,UAAA,CAC3B,CAAA,EACF,EACAwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,SAAU,SAAA,CAAA,MAC5BL,EAAE,qBAAqB,CAAA,EAC7B,QACC,OAAA,CAAK,UAAWK,EAAO,UACrB,SAAA4F,EAAkB,MAAM,SAAA,CAC3B,CAAA,EACF,EACAwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KAErB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,SAAU,SAAA,CAAA,MAC5BL,EAAE,sBAAsB,CAAA,EAC9B,QACC,OAAA,CAAK,UAAWK,EAAO,UACrB,SAAA4F,EAAkB,MAAM,UAAA,CAC3B,CAAA,EACF,EACAwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KAErB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,SAAU,SAAA,CAAA,OAC3BL,EAAE,qBAAqB,CAAA,EAC9B,QACC,OAAA,CAAK,UAAWK,EAAO,UACrB,SAAA4F,EAAkB,MAAM,SAAA,CAC3B,CAAA,EACF,EACAwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,SAAU,SAAA,CAAA,MAC5BL,EAAE,oBAAoB,CAAA,EAC5B,QACC,OAAA,CAAK,UAAWK,EAAO,UACrB,SAAA4F,EAAkB,MAAM,QAAA,CAC3B,CAAA,EACF,EACCA,EAAkB,gBACjBwF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KAErB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,SAAU,SAAA,CAAA,OAC3BL,EAAE,0BAA0B,CAAA,EACnC,EACAI,EAAAA,IAAC,OAAA,CAAK,UAAWC,EAAO,UACrB,WAAE,WAAW4F,EAAkB,cAAc,OAAO,CAAA,CACvD,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,EAGFwF,EAAAA,KAAC,MAAA,CAAI,UAAU,eACb,SAAA,CAAArL,EAAAA,IAAC,SAAA,CACC,UAAU,gBACV,QAASoL,EACT,SAAU,CAACvF,EACX,cAAY,eAEX,WAAE,YAAY,CAAA,CAAA,EAGjB7F,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS+K,EACT,cAAY,sBAEX,WAAE,WAAW,CAAA,CAAA,CAChB,CAAA,CACF,CAAA,EACF,CAEJ,0fC7JMS,GAAsC,CAC1C,SAAU,UACV,SAAU,UACV,SAAU,UACV,SAAU,UACV,SAAU,UACV,SAAU,SACZ,EAEMC,GAAsC,CAAC,CAAE,UAAAX,EAAW,OAAAC,KAAa,CACrE,KAAM,CAACnL,CAAC,EAAIC,EAAA,EACN6L,EAAenF,GAAA,EAEfX,EAAQS,GAAA,EAERP,EAAcmF,EAAAA,QAAQ,IACnB3F,EAAY,SAAA,EAAW,aAAA,EAC7B,CAACM,CAAK,CAAC,EAEJ+F,EAAkBxG,GAAiB,CACnCuG,EAAa,SAASvG,EAAI,EAAE,GAC9BG,EAAY,SAAA,EAAW,UAAUH,EAAI,EAAE,CAE3C,EAEMiG,EAAgB,IAAM,CACtBtF,IACFR,EAAY,SAAA,EAAW,UAAUQ,EAAY,EAAE,EAC/CgF,EAAA,EAEJ,EAEA,OACEO,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,EAAAA,IAAC,KAAA,CAAG,UAAWC,EAAO,MAAO,cAAY,aACtC,SAAAL,EAAE,gBAAgB,CAAA,CACrB,EAEAI,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,SAAU,cAAY,YAC1C,SAAA+D,EAAK,IAAKmB,GAAQ,CACjB,MAAMmG,EAAaI,EAAa,SAASvG,EAAI,EAAE,EACzCoG,EAAazF,GAAa,KAAOX,EAAI,GACrCyG,EAAeJ,GAAWrG,EAAI,EAAE,EAEtC,OACEkG,EAAAA,KAAC,MAAA,CAEC,UAAW,GAAGpL,EAAO,OAAO,IAAIqL,EAAarL,EAAO,SAAWA,EAAO,MAAM,IAAIsL,EAAatL,EAAO,SAAW,EAAE,GACjH,cAAa,YAAYkF,EAAI,EAAE,GAC/B,QAAS,IAAMwG,EAAexG,CAAG,EAEjC,SAAA,CAAAkG,EAAAA,KAAC,MAAA,CACC,UAAWpL,EAAO,aAClB,MAAO,CAAE,gBAAiB2L,CAAA,EAEzB,SAAA,CAAAhM,EAAE,gBAAgB,EAAE,IAAEuF,EAAI,OAAA,CAAA,CAAA,EAG7BnF,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,QACpB,SAAAqL,EAAa1L,EAAE,QAAQuF,EAAI,EAAE,OAAO,EAAI,MAC3C,EAECmG,GACCtL,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,WACpB,SAAA,IAAI,OAAOkF,EAAI,UAAU,CAAA,CAC5B,EAGD,CAACmG,GACAtL,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,gBACpB,SAAAL,EAAE,oBAAoBuF,EAAI,gBAAgB,IAAI,GAAI,CACjD,MAAOA,EAAI,gBAAgB,KAAA,CAC5B,CAAA,CACH,CAAA,CAAA,EA3BGA,EAAI,EAAA,CA+Bf,CAAC,CAAA,CACH,EAECW,GACCuF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,UAAW,cAAY,cAC5C,SAAA,CAAAD,EAAAA,IAAC,MAAI,SAAAJ,EAAE,QAAQkG,EAAY,EAAE,OAAO,EAAE,EACtC9F,EAAAA,IAAC,IAAA,CAAE,UAAWC,EAAO,YAClB,WAAE,QAAQ6F,EAAY,EAAE,cAAc,CAAA,CACzC,EACAuF,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,eACrB,SAAA,CAAAoL,OAAC,SAAA,CAAQ,SAAA,CAAAzL,EAAE,iBAAiB,EAAE,GAAA,EAAC,EAAU,IACxC,IAAI,OAAOkG,EAAY,UAAU,CAAA,CAAA,CACpC,CAAA,EACF,EAGFuF,EAAAA,KAAC,MAAA,CAAI,UAAU,eACb,SAAA,CAAArL,EAAAA,IAAC,SAAA,CACC,UAAU,gBACV,QAASoL,EACT,SAAU,CAACtF,EACX,cAAY,oBAEX,WAAE,YAAY,CAAA,CAAA,EAEjB9F,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS+K,EACT,cAAY,sBAEX,WAAE,WAAW,CAAA,CAAA,CAChB,CAAA,CACF,CAAA,EACF,CAEJ,+iBChHMc,GAAkD,CACtD,OAAQ,KACR,OAAQ,KACR,MAAO,MACP,KAAM,KACN,MAAO,IACP,SAAU,KACV,SAAU,KACV,YAAa,KACb,aAAc,IAChB,EAEMC,GAA4B,CAAC,CAAE,OAAAf,KAAa,CAChD,KAAM,CAACnL,CAAC,EAAIC,EAAA,EACN,EAAGkM,CAAU,EAAIC,EAAAA,SAAS,CAAC,EAC3BC,EAAYnE,GAAA,EAEZoE,EAAO/D,GAAA,EAEPgE,EAAkBtF,GAAoC,CACtDjC,EAAa,SAAA,EAAW,iBAAiBiC,CAAS,GACpDkF,EAAYK,GAASA,EAAO,CAAC,CAEjC,EAEMC,EAAsB,IAAM,CAC5BjL,GAAaxB,EAAE,mBAAmB,CAAC,IACrCgF,EAAa,SAAA,EAAW,uBAAA,EACxBmH,EAAYK,GAASA,EAAO,CAAC,EAEjC,EAEA,OACEf,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,MAAC,KAAA,CAAG,cAAY,aAAc,SAAAJ,EAAE,YAAY,EAAE,SAE7C,MAAA,CAAI,UAAWK,EAAO,YAAa,cAAY,oBAC9C,SAAA,CAAAD,EAAAA,IAAC,OAAA,CAAK,UAAWC,EAAO,SAAU,SAAA,KAAE,EACpCD,EAAAA,IAAC,OAAA,CAAK,UAAWC,EAAO,WAAa,SAAAgM,CAAA,CAAU,CAAA,EACjD,EAEAjM,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,aAAc,cAAY,gBAC9C,SAAAkE,EAAmB,IAAK2C,GAAY,CACnC,MAAME,EAAekF,EAAKpF,EAAQ,EAAE,GAAK,EACnCG,EAAOH,EAAQ,KAAKE,CAAY,EAChCsF,EAAatF,GAAgBF,EAAQ,SACrCyF,EAAYN,GAAahF,EACzBuF,EAAgB1F,EAAQ,OAAOE,CAAY,EAC3CyF,EAAa3F,EAAQ,OAAOE,EAAe,CAAC,EAElD,OACEqE,EAAAA,KAAC,MAAA,CAEC,UAAWpL,EAAO,YAClB,cAAa,gBAAgB6G,EAAQ,EAAE,GAEvC,SAAA,CAAAuE,EAAAA,KAAC,KAAA,CAAG,UAAWpL,EAAO,YACnB,SAAA,CAAA4L,GAAU/E,EAAQ,EAAE,EAAE,IAAElH,EAAE,YAAYkH,EAAQ,EAAE,OAAO,CAAA,EAC1D,EACA9G,EAAAA,IAAC,KAAE,UAAWC,EAAO,mBAClB,SAAAL,EAAE,YAAYkH,EAAQ,EAAE,eAAgB,CACvC,MAAOA,EAAQ,OAAO,CAAC,CAAA,CACxB,EACH,EAEAuE,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,aACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,WACrB,SAAA,CAAAL,EAAE,oBAAqB,CAAE,MAAO4M,CAAA,CAAe,EAAE,GAAA,EACpD,EACAnB,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,WACrB,SAAA,CAAA+G,EAAa,MAAIF,EAAQ,QAAA,CAAA,CAC5B,CAAA,EACF,EAEAuE,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,cACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,YACrB,SAAA,CAAAL,EAAE,oBAAqB,CAAE,MAAO4M,CAAA,CAAe,EAAE,GAAA,EACpD,EACAnB,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,YAAa,SAAA,CAAA,IAAEuM,CAAA,CAAA,CAAc,CAAA,EACvD,EAEAnB,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,YACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UAAY,SAAA,CAAAL,EAAE,cAAc,EAAE,GAAA,EAAC,EACvDI,EAAAA,IAAC,OAAA,CAAK,UAAWC,EAAO,UACrB,SAAAqM,EAAa1M,EAAE,eAAe,EAAI,IAAI6M,CAAU,EAAA,CACnD,CAAA,EACF,EAEAzM,EAAAA,IAAC,SAAA,CACC,UAAU,gBACV,QAAS,IAAMmM,EAAerF,EAAQ,EAAE,EACxC,SAAU,CAACyF,GAAaD,EACxB,cAAa,mBAAmBxF,EAAQ,EAAE,GAEzC,SAAAwF,EAAa1M,EAAE,eAAe,EAAI,GAAGqH,CAAI,KAAA,CAAA,CAC5C,CAAA,EA3CKH,EAAQ,EAAA,CA8CnB,CAAC,CAAA,CACH,EAEAuE,EAAAA,KAAC,MAAA,CAAI,UAAU,eACb,SAAA,CAAArL,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS+K,EACT,cAAY,mBAEX,WAAE,WAAW,CAAA,CAAA,EAEhB/K,EAAAA,IAAC,SAAA,CACC,UAAU,cACV,QAASqM,EACT,cAAY,wBAEX,WAAE,oBAAoB,CAAA,CAAA,CACzB,CAAA,CACF,CAAA,EACF,CAEJ,oJC7GA,MAAMK,EAAkB,CACd,OAAsB,CAC5B,UAAW,KACX,WAAY,KACZ,OAAQ,EACR,OAAQ,EACR,MAAO,EACP,QAAS,CAAA,EAGH,SAAW,EACX,SAAW,EACX,OAASnI,GAEjB,aAAc,CACZ,KAAK,YAAA,EAEL,MAAMoI,EAAWC,GAAE,SAAS,IAAM,CAChC,KAAK,YAAA,CACP,EAAG,GAAG,EAEN,OAAO,iBAAiB,SAAUD,CAAQ,EAC1C,OAAO,iBAAiB,oBAAqB,IAAM,CACjD,KAAK,YAAA,CACP,CAAC,CACH,CAEA,WAAY,CACV,YAAK,QAAU,KAAK,OAAS,GAAK,IAC3B,KAAK,MACd,CAEO,UAAW,CAChB,OAAO,OAAO,WAAa,GAC7B,CAEO,eAAgB,CACrB,OAAO,OAAO,WAAa,GAC7B,CAKO,aAAoB,CAEzB,KAAK,OAAO,OAAS,OAAO,WAAa,KAAK,OAAO,UACrD,KAAK,OAAO,OAAS,OAAO,YAAc,KAAK,OAAO,WAGtD,MAAME,EAAW,KAAK,IAAI,KAAK,OAAO,OAAQ,KAAK,OAAO,MAAM,EAChE,KAAK,OAAO,MAAQ,KAAK,IACvB,KAAK,SACL,KAAK,IAAI,KAAK,SAAUA,CAAQ,CAAA,EAK9B,KAAK,gBAEP,KAAK,OAAO,QAAU,KAAK,OAAO,MAAQ,EACjC,KAAK,WAEd,KAAK,OAAO,QAAU,KAAK,OAAO,MAAQ,EACjC,OAAO,WAAa,KAE7B,KAAK,OAAO,QAAU,KAAK,OAAO,MAAQ,IACjC,OAAO,WAAa,KAE7B,KAAK,OAAO,QAAU,KAAK,OAAO,MAAQ,IAG1C,KAAK,OAAO,QAAU,KAAK,OAAO,MAAQ,IAI5C,KAAK,OAAO,QAAU,KAAK,IACzB,KAAK,SACL,KAAK,IAAI,KAAK,SAAU,KAAK,OAAO,OAAO,CAAA,CAE/C,CAEO,cAAuB,CAE5B,MAAO,GADY,KAAK,MAAM,GAAK,KAAK,OAAO,OAAO,CAClC,IACtB,CAEO,gBAAyB,CAC9B,MAAO,yDACT,CAEO,aAAsB,CAE3B,MAAO,GADY,KAAK,MAAM,GAAK,KAAK,OAAO,OAAO,CAClC,IACtB,CAEO,aAAsB,CAE3B,MAAO,GADY,KAAK,MAAM,GAAK,KAAK,OAAO,OAAO,CAClC,IACtB,CAEO,WAAWC,EAA0B,CAC1C,OAAO,KAAK,MAAMA,EAAW,KAAK,OAAO,KAAK,CAChD,CAEO,aAAaA,EAA0B,CAC5C,OAAO,KAAK,MAAMA,EAAW,KAAK,OAAO,OAAO,CAClD,CAEO,eAAgB,CACrB,MAAO,EACT,CACF,CAGO,MAAMC,EAAe,IAAIL,GC9GzB,MAAMM,EAAO,CACX,OACA,UACA,OACA,MACA,MACA,WACA,sBACA,MACA,SACA,SACA,YACA,aACA,YACA,KACA,MACA,OASP,YACEC,EACAC,EACAC,EACAC,EACA,CACA,KAAK,MAAQH,EAGb,MAAMI,EAAaN,EAAa,WAAW,EAAE,EAG7C,KAAK,OAASE,EAAM,QAAQ,IAAI,OAAOC,EAAGC,EAAGC,CAAU,EACvD,KAAK,OAAO,eAAeC,EAAYA,CAAU,EAEjD,KAAK,OAAO,MAAM,QAAQA,EAAYA,CAAU,EAGhD,KAAK,UAAY,IACjB,KAAK,OAAS,KAAK,UACnB,KAAK,MAAQ,IACb,KAAK,MAAQ,EACb,KAAK,WAAa,EAClB,KAAK,sBAAwB,GAC7B,KAAK,MAAQ,EACb,KAAK,SAAW,EAChB,KAAK,SAAW,EAChB,KAAK,YAAc,EACnB,KAAK,aAAe,EACpB,KAAK,YAAc,EACnB,KAAK,KAAO,EACZ,KAAK,OAAS,EAGdJ,EAAM,QAAQ,KAAK,YAAY,KAAK,MAAM,EAC1CA,EAAM,QAAQ,KAAK,QAAQF,EAAa,eAAe,CACzD,CAQO,OACLO,EACAC,EACAC,EACM,CAEN,KAAK,OAAO,YAAY,CAAC,EAGzB,IAAIC,EAAY,EACZC,EAAY,EAGZF,IAAkBA,EAAc,IAAM,GAAKA,EAAc,IAAM,IACjEC,EAAYD,EAAc,EAAI,KAAK,MACnCE,EAAYF,EAAc,EAAI,KAAK,QAG/BF,GAAS,KAAK,QAAUC,GAAM,GAAG,OACnCE,EAAY,CAAC,KAAK,OACTH,GAAS,MAAM,QAAUC,GAAM,GAAG,UAC3CE,EAAY,KAAK,OAGfH,GAAS,GAAG,QAAUC,GAAM,GAAG,OACjCG,EAAY,CAAC,KAAK,OACTJ,GAAS,KAAK,QAAUC,GAAM,GAAG,UAC1CG,EAAY,KAAK,OAIfD,IAAc,GAAKC,IAAc,IAEnCD,GAAa,KACbC,GAAa,OAKjB,KAAK,OAAO,YAAYD,EAAWC,CAAS,CAC9C,CAMO,WAAWC,EAAsB,CAEtC,MAAMC,EAAe,KAAK,IAAI,EAAGD,EAAS,KAAK,KAAK,EACpD,KAAK,QAAUC,EAGf,KAAK,OAAO,QAAQ,QAAQ,EAC5B,KAAK,MAAM,KAAK,YAAY,IAAK,IAAM,CACrC,KAAK,OAAO,UAAA,CACd,CAAC,EAGG,KAAK,QAAU,IACjB,KAAK,OAAS,EACd,KAAK,YAAA,EAET,CAKQ,aAAoB,CAE1B,GAAI,KAAK,YAAc,EAAG,CAExB,KAAK,aAAe,EAEpB,KAAK,OAAS,KAAK,UAGnB,KAAK,OAAO,QAAQ,QAAQ,EAC5B,KAAK,MAAM,KAAK,YAAY,IAAK,IAAM,CACrC,KAAK,OAAO,UAAA,CACd,CAAC,EACD,MACF,CAGA,KAAK,MAAM,SAAA,CACb,CAKO,cAAclH,EAAsB,CAEzC,MAAMmH,EAAY,KAAK,MAAMnH,GAAU,EAAI,KAAK,SAAS,EACzD,KAAK,YAAcmH,EAGf,KAAK,YAAc,KAAK,uBAC1B,KAAK,QAAA,CAET,CAKQ,SAAgB,CACtB,KAAK,QAGL,KAAK,YAAc,KAAK,sBAGxB,KAAK,sBAAwB,KAAK,MAAM,KAAK,sBAAwB,GAAG,EAGxE,KAAK,OAAS,KAAK,IAAI,KAAK,OAAS,GAAI,KAAK,SAAS,EAGvD,KAAK,MAAM,gBAAA,CACb,CAEO,QAAQpN,EAAwBqN,EAAeC,EAAiB,EAAG,CACxE,OAAQtN,EAAA,CACN,IAAK,SACH,KAAK,QAAUqN,EACf,KAAK,WAAaC,EAClB,MACF,IAAK,SACH,KAAK,QAAUD,EACf,MACF,IAAK,QACH,KAAK,OAASA,EACd,MACF,IAAK,OACH,KAAK,MAAQA,EACb,MACF,IAAK,QACH,KAAK,OAASA,EACd,MACF,IAAK,WACH,KAAK,UAAYA,EACjB,MACF,IAAK,WACH,KAAK,UAAYA,EACjB,MACF,IAAK,MAAO,CACV,MAAME,EAAQ,EAAIF,EAClB,KAAK,WAAaE,EAClB,KAAK,QAAU,KAAK,UAAYF,EAChC,KAAK,OAASE,EACd,KAAK,aAAeA,EACpB,KAAK,UAAYA,EACjB,KAAK,UAAYA,EACjB,KAAK,MAAQA,EACb,KAAK,OAASA,EACd,KAAK,QAAUA,EACf,KACF,CACA,IAAK,SACH,KAAK,aAAeF,EACpB,MACF,IAAK,cACH,KAAK,aAAeA,EACpB,MACF,IAAK,eACH,KAAK,cAAgBA,EACrB,KAAA,CAEN,CACF,CC7PO,MAAMG,EAAM,CACV,OACA,KACA,UACA,OACA,MACA,OACA,SACA,UACA,OACC,MASR,YAAYhB,EAAkBC,EAAWC,EAAWe,EAAsB,CACxE,KAAK,MAAQjB,EACb,KAAK,KAAOiB,EACZ,KAAK,OAAS,GAGd,MAAMC,EAAYxP,EAAauP,CAAS,EAGxC,KAAK,UAAYC,EAAU,OAC3B,KAAK,OAAS,KAAK,UACnB,KAAK,MAAQA,EAAU,MACvB,KAAK,OAASA,EAAU,OACxB,KAAK,SAAWA,EAAU,QAC1B,KAAK,UAAYA,EAAU,UAG3B,KAAK,OAASlB,EAAM,QAAQ,IAAI,OAAOC,EAAGC,EAAGe,CAAS,EAGtD,MAAMpB,EAAWlO,GAAWuP,EAAU,IAAI,EACpCC,EAAcrB,EAAa,WAAWD,CAAQ,EACpD,KAAK,OAAO,eAAesB,EAAaA,CAAW,EAGnD,KAAK,OAAO,MAAM,QAAQA,EAAaA,CAAW,CACpD,CAMO,OAAOC,EAA2B,CACvC,GAAI,KAAK,OAAQ,OAGjB,MAAMC,EAAKD,EAAU,EAAI,KAAK,OAAO,EAC/BE,EAAKF,EAAU,EAAI,KAAK,OAAO,EAC/BG,EAAW,KAAK,KAAKF,EAAKA,EAAKC,EAAKA,CAAE,EAGxCC,EAAW,GACb,KAAK,OAAO,YACTF,EAAKE,EAAY,KAAK,MACtBD,EAAKC,EAAY,KAAK,KAAA,CAG7B,CAOO,WAAWb,EAAyB,CACzC,OAAI,KAAK,OAAe,IAGxB,KAAK,QAAUA,EAGf,KAAK,OAAO,QAAQ,QAAQ,EAC5B,KAAK,MAAM,KAAK,YAAY,GAAI,IAAM,CAC/B,KAAK,QACR,KAAK,OAAO,UAAA,CAEhB,CAAC,EAGG,KAAK,QAAU,GACjB,KAAK,YAAA,EACE,IAEF,GACT,CAOO,YAAYT,EAAWC,EAAiB,CACzC,KAAK,OAAO,MAAQ,gBAAiB,KAAK,OAAO,MACnD,KAAK,OAAO,KAAK,YAAYD,EAAGC,CAAC,CAErC,CAKQ,aAAoB,CACtB,KAAK,SACT,KAAK,OAAS,GAGd,KAAK,MAAM,gBAAgB,KAAK,OAAO,EAAG,KAAK,OAAO,EAAG,KAAK,QAAQ,EAGtE,KAAK,OAAO,QAAA,EACd,CAKO,SAAgB,CACrB,KAAK,QAAQ,QAAA,CACf,CACF,CAKO,MAAMsB,EAAa,CAChB,MACA,QACA,WACA,cACA,kBACA,eACA,mBACA,gBACA,iBACA,iBACA,iBAOR,YAAYxB,EAAkByB,EAA+B,CAC3D,KAAK,MAAQzB,EACb,KAAK,QAAU,CAAA,EACf,KAAK,WAAa,EAClB,KAAK,kBAAoB,KACzB,KAAK,cAAgB,KAAK,kBAC1B,KAAK,eAAiB,EACtB,KAAK,mBAAqB,IAC1B,KAAK,gBAAkB,EACvB,KAAK,iBACHyB,EAAiB,OAAS,EAAIA,EAAmB,CAAC,aAAa,EAGjE,KAAK,iBAAmB,IACxB,KAAK,iBAAmB,GAC1B,CAQO,OAAOC,EAAeC,EAAeP,EAA2B,CAErE,KAAK,QAAQ,QAASQ,GAAU,CACzBA,EAAM,QACTA,EAAM,OAAOR,CAAS,CAE1B,CAAC,EAGD,KAAK,QAAU,KAAK,QAAQ,OAAQQ,GAAU,CAACA,EAAM,MAAM,EAGvD,KAAK,QAAQ,OAAS,KAAK,qBAC7B,KAAK,YAAcD,EACf,KAAK,YAAc,KAAK,gBAC1B,KAAK,WAAa,EAClB,KAAK,UAAUP,CAAS,IAK5B,KAAK,iBAAmBO,EACpB,KAAK,iBAAmB,MAE1B,KAAK,gBAAkB,EACvB,KAAK,mBAAA,EAET,CAKQ,oBAA2B,CAEjC,KAAK,eAAiB,KAAK,IAAI,GAAI,KAAK,eAAiB,CAAC,EAG1D,KAAK,cAAgB,KAAK,IAAI,IAAK,KAAK,cAAgB,GAAG,EAG3D,KAAK,mBAAqB,KAAK,IAAI,IAAK,KAAK,mBAAqB,EAAE,CACtE,CAMQ,UAAUP,EAA2B,CAE3C,MAAMS,EACJ,EAAI,KAAK,MAAM,KAAK,MAAM,YAAA,EAAgB,GAAK,EAG3CC,EAAa,KAAK,IACtB,KAAK,eAAiBD,EACtB,KAAK,mBAAqB,KAAK,QAAQ,MAAA,EAIzC,QAAShM,EAAI,EAAGA,EAAIiM,EAAYjM,IAC9B,KAAK,WAAWuL,CAAS,CAE7B,CAMQ,WAAWA,EAA2B,CAE5C,MAAMW,EAAQ,KAAK,OAAA,EAAW,KAAK,GAAK,EAGlCR,EACJ,KAAK,iBACL,KAAK,UAAY,KAAK,iBAAmB,KAAK,kBAG1CtB,EAAImB,EAAU,EAAI,KAAK,IAAIW,CAAK,EAAIR,EACpCrB,EAAIkB,EAAU,EAAI,KAAK,IAAIW,CAAK,EAAIR,EAGpCN,EAAY,KAAK,gBAAA,EAGjBW,EAAQ,IAAIZ,GAAM,KAAK,MAAOf,EAAGC,EAAGe,CAAS,EACnD,KAAK,QAAQ,KAAKW,CAAK,CACzB,CAMQ,iBAA6B,CAEnC,MAAMI,EAAc,KAAK,IAAI,GAAK,KAAK,MAAM,YAAA,EAAgB,GAAM,EAG7DC,EAAU,KAAK,iBAAiB,OACnCzO,GAAS9B,EAAa8B,CAAI,EAAE,OAAS,QAAA,EAElC0O,EAAS,KAAK,iBAAiB,OAClC1O,GAAS9B,EAAa8B,CAAI,EAAE,OAAS,OAAA,EAOlC2O,EAHaD,EAAO,OAAS,GAAK,KAAK,SAAWF,EAIpDE,EACAD,EAAQ,OAAS,EACfA,EACA,KAAK,iBAGX,OAAOE,EAAK,KAAK,MAAM,KAAK,SAAWA,EAAK,MAAM,CAAC,CACrD,CAMO,YAAsB,CAC3B,OAAO,KAAK,QAAQ,OAAQP,GAAU,CAACA,EAAM,MAAM,CACrD,CAKO,OAAc,CAEnB,KAAK,QAAQ,QAASA,GAAUA,EAAM,SAAS,EAE/C,KAAK,QAAU,CAAA,CACjB,CACF,CC9QO,MAAeQ,CAAO,CACjB,MACA,OACH,MACA,SACC,QACD,SACC,UACD,KACA,KAAkB,CAAA,EACf,gBACF,kBAA4B,EAC7B,gBAA0B,EAC1B,gBACA,SAAmB,EACnB,MAAiB,GACjB,cAAgB,EAChB,cAAgB,EAChB,eAAiB,EACjB,WAAa,EAQpB,YAAYpC,EAAkBqC,EAAgBC,EAAsB,CAClE,MAAMC,EAAa3Q,EAAQ0Q,EAAO,IAAI,GAClC,CAACtC,EAAM,SAAS,OAAOsC,EAAO,IAAI,GAAKC,IACzC,QAAQ,MACN,mBAAmBD,EAAO,IAAI,iEAAA,EAIlC,KAAK,MAAQtC,EACb,KAAK,OAASqC,EACd,KAAK,MAAQ,EACb,KAAK,SACHjQ,GAAiBmQ,EAAW,MAAM,GAAKnQ,GAAiB,OAC1D,KAAK,QAAUmQ,EAAW,YAAc,EACxC,KAAK,SAAWA,EAAW,aAAe,EAC1C,KAAK,UAAY,EACjB,KAAK,KAAOD,EAAO,KACnB,KAAK,gBAAkBtC,EAAM,QAAQ,IAAI,MAAA,EACzC,KAAK,gBAAkB9N,GAAaqQ,EAAW,MAAM,GAAK,EAC1D,KAAK,MAAQD,EAAO,OAAS,EAC/B,CAEA,IAAW,aAAkC,CAC3C,OAAQ,KAAK,iBAAiB,UAAU,SACtC,CAAA,CACJ,CAEA,IAAW,QAAiB,CAC1B,MAAME,EACJ,KAAK,OAAO,SAAW,GAAK,KAAK,OAAA,GAAY,KAAK,OAAO,SAErD9B,EAAS,KAAK,QAAU,KAAK,OAAO,OAI1C,OAFoB8B,EAAS9B,EAAS,IAAMA,IAEtB,EAAI,KAAK,WACjC,CAEA,IAAW,OAAOG,EAAe,CAC/B,KAAK,QAAUA,CACjB,CAOO,OAAO4B,EAAcC,EAAwB,CAClD,GAAI,KAAK,MAAO,CACd,KAAK,eAAiB,KAAK,cAAgB,KAC3C,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAEvBuB,EAAS7C,EAAa,WAAW,KAAK,cAAc,EAG1D,KAAK,KAAK,QAAS8C,GAAQ,CACzB,MAAMC,EAAgB,KAAK,cAAgBD,EAAI,OAC/CA,EAAI,OAAO,EAAIxB,EAAU,EAAI,KAAK,IAAIyB,CAAa,EAAIF,EACvDC,EAAI,OAAO,EAAIxB,EAAU,EAAI,KAAK,IAAIyB,CAAa,EAAIF,CACzD,CAAC,EACD,MACF,CAEIF,EAAO,KAAK,WAAa,KAAK,WAChC,KAAK,MAAM,oBAAA,EACX,KAAK,KAAKC,CAAO,EACjB,KAAK,UAAYD,EAErB,CAKO,SAAgB,CACjB,KAAK,MAAQ,KAAK,WACpB,KAAK,QACL,KAAK,SAAWtQ,GAAcP,EAAQ,KAAK,IAAI,EAAE,MAAM,EACvD,KAAK,aAAA,EAEL,KAAK,KAAK,QAASgR,GAAQ,CACzBA,EAAI,OAAO,OAAS,KAAK,MAC3B,CAAC,EACD,KAAK,YAAY,QAAStN,GAAS,CACjC,MAAMwN,EAAaxN,EACnBwN,EAAW,OAAS,KAAK,MAC3B,CAAC,EAEL,CAUU,kBAAkBJ,EAAkBK,EAAwB,CACpE,GAAIL,EAAQ,SAAW,EAAG,MAAO,CAAA,EAEjC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAE7B,OAAOsB,EAAQ,OAAQd,GACJpG,EAAO,KAAK,SAAS,QACpC4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,GAGImB,CACpB,CACH,CAOU,gBAAyB,CACjC,MAAMC,EAAW,KAAK,OAAO,OAAO,MAAM,SAC1C,OAAOA,IAAaA,EAAS,IAAM,GAAKA,EAAS,IAAM,GACnD,KAAK,MAAMA,EAAS,EAAGA,EAAS,CAAC,EACjC,CACN,CAEU,iBAAiB/C,EAA8B,CACvD,MAAMmB,EAAY,KAAK,MAAM,kBAAA,EAEvBmB,EAAa3Q,EAAQ,KAAK,IAAI,EAE9BqR,EAAiBnD,EAAa,WAClC9N,GAAYuQ,EAAW,MAAM,CAAA,EAG/B,IAAIO,EAEAvB,EAAW,GAEf,OAAI,KAAK,OACPA,EAAW,GACXuB,EAAa,KAAK,MAAM,QAAQ,IAAI,OAClC,EACA,EACA,KAAK,IAAA,GAGPA,EAAa,KAAK,gBAAgB,OAChC7C,GAAKmB,EAAU,EACfA,EAAU,EACV,KAAK,IAAA,EAIT0B,EAAW,UAAUG,EAAiB,CAAC,EACvCH,EAAW,eAAeG,EAAgBA,CAAc,EACxDH,EAAW,OAAS,KAAK,OACzBA,EAAW,SAAW,KAAK,SAC3BA,EAAW,SAAWvB,EAEfuB,CACT,CAEU,YAAmB,CAC3B,GAAI,KAAK,KAAK,SAAW,KAAK,gBAI9B,MAAK,MAAM,oBAAA,EAEX,KAAK,KAAK,QAASF,GAAQA,EAAI,OAAO,SAAS,EAC/C,KAAK,KAAO,CAAA,EAEZ,QAAS/M,EAAI,EAAGA,EAAI,KAAK,gBAAiBA,IAAK,CAC7C,MAAM+M,EAAM,KAAK,iBAAA,EACjB,KAAK,KAAK,KAAK,CACb,OAAQA,EACR,OAAU,KAAK,GAAK,EAAK,KAAK,gBAAmB/M,CAAA,CAClD,CACH,EACF,CAEU,wBAAwBqN,EAAgBtB,EAAuB,CACvE,GAAI,CAACA,EACH,MAAO,GAET,MAAMR,EAAY,KAAK,MAAM,kBAAA,EAC7B,OAAO5F,EAAO,KAAK,MAAM,QACvB4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,CAEjB,CAGU,KAAKc,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EACvBmB,EAAa3Q,EAAQ,KAAK,IAAI,EAC9BgC,EAAW3B,GAAgBsQ,EAAW,MAAM,EAElD,QAAS,EAAI,EAAG,EAAI,KAAK,gBAAiB,IAAK,CAC7C,MAAMR,EAAQ,KAAK,wBAAwB,EAAGW,EAAQ,CAAC,CAAC,EAClDI,EAAa,KAAK,iBACtB1B,EAAU,GAAK,IAAM,EAAI,IAAM,GAAA,EAGjC0B,EAAW,YACT,KAAK,IAAIf,CAAK,EAAI,KAAK,gBACvB,KAAK,IAAIA,CAAK,EAAI,KAAK,eAAA,EAEzBe,EAAW,YAAYf,CAAK,EAE5B,KAAK,MAAM,KAAK,YAAYnO,EAAU,IAAM,CACtCkP,EAAW,QAAQA,EAAW,QAAA,CACpC,CAAC,CACH,CACF,CAEU,oBAA2B,CACnC,KAAK,OAAO,cAAgB,KAAK,kBAEjC,KAAK,kBAAoBrQ,GAAsB,KAAK,MAEpD,KAAK,OAAO,cAAgB,KAAK,iBACnC,CAEO,SAAgB,CACrB,KAAK,gBAAgB,MAAM,GAAM,EAAI,EACrC,KAAK,KAAK,QAASmQ,GAAiBA,EAAI,OAAO,SAAS,CAC1D,CACF,CAMO,MAAMO,WAAoBf,CAAO,CACtC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,cAAA,CACP,CACH,CAKU,cAAqB,CAE7B,KAAK,SAAW,KAAK,IAAI,IAAK,KAAK,SAAW,GAAG,EAG7C,KAAK,OAAS,IAChB,KAAK,SAAW,GAEd,KAAK,OAAS,IAChB,KAAK,SAAW,EAEpB,CACF,CAMO,MAAMe,WAAuBhB,CAAO,CACzC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,kBACN,MAAO,EAAA,CACR,EACD,KAAK,eAAiB,GACtB,KAAK,cAAgB,EAGrB,KAAK,WAAA,CACP,CAKU,cAAqB,CAEzB,KAAK,QAAU,GAEjB,KAAK,gBAAkB,EACvB,KAAK,WAAA,GACI,KAAK,QAAU,EAExB,KAAK,eAAiB,IACb,KAAK,QAAU,GAExB,KAAK,gBAAkB,EACvB,KAAK,WAAA,GACI,KAAK,QAAU,IAExB,KAAK,cAAgB,EAEzB,CACF,CAOO,MAAMgB,WAAkBjB,CAAO,CACpC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,YAAA,CACP,EACD,KAAK,SAAW,CAClB,CAMU,cAAqB,CAE7B,KAAK,SAAW,KAAK,IAAI,IAAK,KAAK,SAAW,EAAE,EAG5C,KAAK,OAAS,IAAG,KAAK,gBAAkB,GAGxC,KAAK,OAAS,IAAG,KAAK,SAAW,EACvC,CACF,CAOO,MAAMiB,WAAkBlB,CAAO,CACpC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,YAAA,CACP,EACD,KAAK,SAAW,CAClB,CAMU,cAAqB,CAE7B,KAAK,SAAW,KAAK,IAAI,IAAK,KAAK,SAAW,GAAG,EAG7C,KAAK,OAAS,IAAG,KAAK,SAAW,GAGjC,KAAK,OAAS,IAAG,KAAK,gBAAkB,IAC9C,CACF,CAGO,MAAMkB,WAAkBnB,CAAO,CACpC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,aACN,MAAO,EAAA,CACR,EACD,KAAK,cAAgB,EACrB,KAAK,eAAiB,GACtB,KAAK,WAAA,CACP,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,cAAgB,GACtC,KAAK,OAAS,IAChB,KAAK,eAAiB,IAEpB,KAAK,OAAS,IAAG,KAAK,cAAgB,GACtC,KAAK,OAAS,IAChB,KAAK,gBAAkB,EACvB,KAAK,WAAA,EAET,CACF,CAGO,MAAMmB,WAAmBpB,CAAO,CACrC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,aAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,KAAKK,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EACvBqC,EAAS,CAAA,EAEf,QAAS5N,EAAI,EAAGA,EAAI,KAAK,gBAAiBA,IACxC4N,EAAO,KAAM,KAAK,GAAK,EAAI5N,EAAK,KAAK,eAAe,EAGtD4N,EAAO,QAAQ,IAAM,CACnB,MAAMC,EAAO,KAAK,MAAM,IAAI,OAC1BtC,EAAU,EACVA,EAAU,EACV,GACA,QACA,EAAA,EAGF,KAAK,MAAM,OAAO,IAAI,CACpB,QAASsC,EACT,OAAQ,IACR,MAAO,EACP,SAAU,IACV,KAAM,SACN,SAAU,IAAM,CACdhB,EAAQ,QAASd,GAAU,CACzB,MAAM+B,EAAOnI,EAAO,KAAK,SAAS,QAChCkI,EAAK,EACLA,EAAK,EACL9B,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAEX+B,GAAQD,EAAK,QAAUC,GAAQD,EAAK,OAAS,IAC/C9B,EAAM,WAAW,KAAK,MAAM,CAEhC,CAAC,CACH,EACA,WAAY,IAAM8B,EAAK,QAAA,CAAQ,CAChC,CACH,CAAC,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,SAAW,MACjC,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,SAAW,IACvC,CACF,CAGO,MAAME,WAAmBxB,CAAO,CACrC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,aAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,cAAqB,CAC7B,KAAK,SAAW,KAAK,IAAI,IAAK,KAAK,SAAW,GAAG,EAC7C,KAAK,OAAS,IAAG,KAAK,iBAAmB,IAC/C,CACF,CAGO,MAAMwB,WAAazB,CAAO,CAC/B,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,MAAA,CACP,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,SAAW,MACjC,KAAK,OAAS,IAAG,KAAK,QAAU,EACtC,CACF,CAGO,MAAMyB,WAAkB1B,CAAO,CAC5B,aAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,YAAA,CACP,EACD,KAAK,aAAe,GACtB,CAEU,KAAKK,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvB2C,EAAS,KAAK,MAAM,IAAI,OAC5B3C,EAAU,EACVA,EAAU,EACV,KAAK,aACL,QACA,EAAA,EAGF,KAAK,kBAAkBsB,EAAS,KAAK,YAAY,EAAE,QAASd,GAAU,CACpEA,EAAM,WAAW,KAAK,MAAM,EAC5B,MAAMG,EAAQvG,EAAO,KAAK,MAAM,QAC9B4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAEfA,EAAM,YAAY,KAAK,IAAIG,CAAK,EAAI,IAAK,KAAK,IAAIA,CAAK,EAAI,GAAG,CAChE,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAASgC,EACT,MAAO,EACP,SAAU,IACV,WAAY,IAAMA,EAAO,QAAA,CAAQ,CAClC,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,aAAe,KACrC,KAAK,OAAS,IAAG,KAAK,SAAW,KACjC,KAAK,OAAS,IAAG,KAAK,aAAe,KACrC,KAAK,OAAS,IAAG,KAAK,QAAU,EACtC,CACF,CAGO,MAAMC,WAAoB5B,CAAO,CACtC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,cAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,KAAKK,EAAwB,CACrBA,EACb,KAAK,IAAM,KAAK,SAAW,EAAG,EAC9B,MAAM,EAAG,KAAK,eAAe,EAExB,QAASuB,GAAW,CAE1B,MAAMC,EAAY,KAAK,MAAM,IAAI,MAC/BD,EAAO,OAAO,EACdA,EAAO,OAAO,EACd,KAAK,IAAA,EAGPC,EAAU,SAAS,CAAC,EAEpB,KAAK,MAAM,OAAO,IAAI,CACpB,QAASA,EACT,MAAO,EACP,SAAU,IACV,WAAY,IAAM,CAChBA,EAAU,QAAA,EACVD,EAAO,WAAW,KAAK,MAAM,CAC/B,CAAA,CACD,CACH,CAAC,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,SAAW,MACjC,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,QAAU,EACtC,CACF,CAGO,MAAME,WAAkB/B,CAAO,CACpC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,YAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,wBAAwBxM,EAAmB,CACnD,OAAS,KAAK,GAAK,EAAK,KAAK,gBAAmBA,CAClD,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,SAAW,KACjC,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,iBAAmB,IAC/C,CACF,CAGO,MAAMuO,WAAuBhC,CAAO,CACzC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,mBACN,MAAO,EAAA,CACR,EACD,KAAK,gBAAkB,EACvB,KAAK,eAAiB,GACtB,KAAK,cAAgB,EACrB,KAAK,WAAA,CACP,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,cAAgB,GACtC,KAAK,OAAS,IAAG,KAAK,eAAiB,IACvC,KAAK,OAAS,IAAG,KAAK,cAAgB,GACtC,KAAK,OAAS,IAAG,KAAK,gBAAkB,EAC9C,CACF,CAGO,MAAMgC,WAAyBjC,CAAO,CACnC,WACA,aAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,oBAAA,CACP,EACD,KAAK,WAAa,IAClB,KAAK,aAAe,GACtB,CAEU,KAAKK,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvBkD,EAAS,KAAK,MAAM,IAAI,OAC5BlD,EAAU,EACVA,EAAU,EACV,GACA,QACA,EAAA,EAGFsB,EAAQ,QAASd,GAAU,CACzB,MAAML,EAAW/F,EAAO,KAAK,SAAS,QACpC4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGf,GAAIL,EAAW,KAAK,WAAY,CAE9B,MAAMQ,EAAQvG,EAAO,KAAK,MAAM,QAC9BoG,EAAM,OAAO,EACbA,EAAM,OAAO,EACbR,EAAU,EACVA,EAAU,CAAA,EAGZQ,EAAM,YACJ,KAAK,IAAIG,CAAK,EAAI,KAAK,aACvB,KAAK,IAAIA,CAAK,EAAI,KAAK,YAAA,EAGrBR,EAAW,IACbK,EAAM,WAAW,KAAK,MAAM,CAEhC,CACF,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS0C,EACT,OAAQ,GACR,MAAO,EACP,SAAU,KACV,WAAY,IAAMA,EAAO,QAAA,CAAQ,CAClC,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,WAAa,KACnC,KAAK,OAAS,IAAG,KAAK,aAAe,KACrC,KAAK,OAAS,IAAG,KAAK,SAAW,MACjC,KAAK,OAAS,IAAG,KAAK,QAAU,EACtC,CACF,CAGO,MAAMC,WAAmBnC,CAAO,CACrC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,aAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,SAAW,IACvC,CACF,CAGO,MAAMmC,WAAoBpC,CAAO,CAC9B,SACA,SAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,cAAA,CACP,EACD,KAAK,SAAW,KAAK,GAAK,EAC1B,KAAK,SAAW,GAClB,CAEU,KAAKK,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAEvBqD,EAAU/B,EAAQ,CAAC,EACzB,GAAI,CAAC+B,EACH,OAGF,MAAMC,EAAclJ,EAAO,KAAK,MAAM,QACpC4F,EAAU,EACVA,EAAU,EACVqD,EAAQ,OAAO,EACfA,EAAQ,OAAO,CAAA,EAIXE,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,QAAU,EAAG,EAChCA,EAAS,MACPvD,EAAU,EACVA,EAAU,EACV,KAAK,SACLsD,EAAc,KAAK,SAAW,EAC9BA,EAAc,KAAK,SAAW,EAC9B,EAAA,EAEFC,EAAS,SAAA,EAETjC,EAAQ,QAASd,GAAU,CACzB,MAAML,EAAW/F,EAAO,KAAK,SAAS,QACpC4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAETG,EAAQvG,EAAO,KAAK,MAAM,QAC9B4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGTgD,EAAY,KAAK,IAAIpJ,EAAO,KAAK,MAAM,KAAKuG,EAAQ2C,CAAW,CAAC,EAElEnD,EAAW,KAAK,UAAYqD,EAAY,KAAK,SAAW,IAC1DhD,EAAM,WAAW,KAAK,MAAM,EAE5BA,EAAM,YAAY,KAAK,IAAIG,CAAK,EAAI,IAAK,KAAK,IAAIA,CAAK,EAAI,GAAG,EAElE,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS4C,EACT,MAAO,EACP,SAAU,IACV,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,SAAW,KAAK,GAAK,KAC3C,KAAK,OAAS,IAAG,KAAK,SAAW,KACjC,KAAK,OAAS,IAAG,KAAK,SAAW,MACjC,KAAK,OAAS,IAAG,KAAK,SAAW,KAAK,GAAK,EACjD,CACF,CAGO,MAAME,WAA0BzC,CAAO,CAC5C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,qBAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,wBAAwBxM,EAAmB,CACnD,OAAO,KAAK,kBAAqBA,EAAI,GAAK,KAAK,GAAM,CACvD,CAEU,cAAqB,CAC7B,KAAK,SAAW,KAAK,IAAI,IAAK,KAAK,SAAW,GAAG,EAC7C,KAAK,OAAS,IAAG,KAAK,gBAAkB,EAC9C,CACF,CAGO,MAAMiP,WAAsB1C,CAAO,CAChC,gBACA,aAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,iBAAA,CACP,EACD,KAAK,gBAAkBvC,EAAa,WAAW,GAAG,EAClD,KAAK,aAAe,GACtB,CAEU,KAAK4C,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvBuD,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,EAAG,SAAU,CAAC,EACjCA,EAAS,aAAa,EAAG,EAAG,KAAK,eAAe,EAChDA,EAAS,YAAYvD,EAAU,EAAGA,EAAU,CAAC,EAE7C,KAAK,kBAAkBsB,EAAS,KAAK,eAAe,EAAE,QAASd,GAAU,CACvEA,EAAM,WAAW,KAAK,MAAM,EAE5B,MAAMmD,EAAgBnD,EAAM,MAC5BA,EAAM,OAAS,GACf,KAAK,MAAM,KAAK,YAAY,KAAK,aAAc,IAAM,CACnDA,EAAM,MAAQmD,CAChB,CAAC,CACH,CAAC,EAGD,KAAK,MAAM,OAAO,IAAI,CACpB,QAASJ,EACT,OAAQ,IACR,OAAQ,IACR,MAAO,EACP,SAAU,IACV,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,CACH,CAEU,cAAqB,CAC7B,KAAK,iBAAmB7E,EAAa,WAAW,EAAE,EAC9C,KAAK,OAAS,IAAG,KAAK,aAAe,MACrC,KAAK,OAAS,IAAG,KAAK,SAAW,KACvC,CACF,CAGO,MAAMkF,WAAsB5C,CAAO,CACxC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,gBAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,wBAAwBxM,EAAmB,CACnD,OAAO,KAAK,kBAAqBA,EAAI,IAAO,KAAK,GAAM,CACzD,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,gBAAkB,EAC9C,CACF,CAGO,MAAMoP,WAAmB7C,CAAO,CAC7B,YACA,eAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,aAAA,CACP,EACD,KAAK,YAAcvC,EAAa,WAAW,GAAG,EAC9C,KAAK,eAAiB,GACxB,CAEU,KAAK4C,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvBuD,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,QAAU,EAAG,EAChCA,EAAS,WAAW,EAAG,EAAG,KAAK,WAAW,EAC1CA,EAAS,YAAYvD,EAAU,EAAGA,EAAU,CAAC,EAE7C,KAAK,kBAAkBsB,EAAS,KAAK,WAAW,EAAE,QAASd,GAAU,CACnEA,EAAM,WAAW,KAAK,MAAM,EAE5B,MAAMG,EAAQvG,EAAO,KAAK,MAAM,QAC9B4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAEfA,EAAM,YACJ,KAAK,IAAIG,CAAK,EAAI,KAAK,eACvB,KAAK,IAAIA,CAAK,EAAI,KAAK,cAAA,CAE3B,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS4C,EACT,OAAQ,IACR,OAAQ,IACR,MAAO,EACP,SAAU,IACV,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,CACH,CAEU,cAAqB,CAC7B,KAAK,aAAe7E,EAAa,WAAW,EAAE,EAC9C,KAAK,gBAAkB,GACnB,KAAK,OAAS,IAAG,KAAK,SAAW,KACvC,CACF,CAGO,MAAMoF,WAAuB9C,CAAO,CACzC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,mBACN,MAAO,EAAA,CACR,EACD,KAAK,gBAAkB,EACvB,KAAK,eAAiB,GACtB,KAAK,WAAA,CACP,CAEO,OAAOI,EAAoB,CAChC,MAAMrB,EAAY,KAAK,MAAM,kBAAA,EACvB+D,EAAY1C,EAAO,IAAQ,EAE3BE,EAAS7C,EAAa,WAAW,KAAK,cAAc,EAE1D,KAAK,KAAK,QAAS8C,GAAQ,CACzB,MAAMb,EAAQoD,EAAWvC,EAAI,OAC7BA,EAAI,OAAO,EAAIxB,EAAU,EAAI,KAAK,IAAIW,CAAK,EAAIY,EAC/CC,EAAI,OAAO,EAAIxB,EAAU,EAAI,KAAK,IAAIW,CAAK,EAAIY,EAC/CC,EAAI,OAAO,YAAYb,EAAQ,KAAK,GAAK,CAAC,CAC5C,CAAC,CACH,CACU,cAAqB,CAC7B,KAAK,gBAAkB,GACnB,KAAK,OAAS,IAChB,KAAK,gBAAkB,EACvB,KAAK,WAAA,GAEH,KAAK,OAAS,IAChB,KAAK,gBAAkB,EACvB,KAAK,WAAA,EAET,CACF,CAGO,MAAMqD,WAAqBhD,CAAO,CAC/B,WACA,eAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,eAAA,CACP,EACD,KAAK,WAAa,GAClB,KAAK,eAAiB,CACxB,CAEU,KAAKK,EAAwB,CAErC,MAAM2C,EAAgB,KAAK,OAAO,OAC5BC,EAAY,KAAK,OAAO,UACxBC,EAAY,KAAK,IAAIF,EAAgB,KAAK,WAAYC,CAAS,EACrE,KAAK,OAAO,OAASC,EAGrB,MAAMnE,EAAY,KAAK,MAAM,kBAAA,EACvBuD,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,QAAU,EAAG,EAChCA,EAAS,WAAW,EAAG,EAAG7E,EAAa,WAAW,EAAE,CAAC,EACrD6E,EAAS,YAAYvD,EAAU,EAAGA,EAAU,CAAC,EAE7C,KAAK,MAAM,OAAO,IAAI,CACpB,QAASuD,EACT,OAAQ,EACR,OAAQ,EACR,MAAO,EACP,SAAU,IACV,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,EAED,KAAK,kBAAkBjC,EAAS5C,EAAa,WAAW,GAAG,CAAC,EAAE,QAC3D8B,GAAU,CACTA,EAAM,WAAW,KAAK,MAAM,CAC9B,CAAA,CAEJ,CAEU,cAAqB,CAC7B,KAAK,YAAc,GACf,KAAK,OAAS,IAAG,KAAK,eAAiB,IACvC,KAAK,OAAS,IAAG,KAAK,SAAW,KACjC,KAAK,OAAS,IAAG,KAAK,eAAiB,IACvC,KAAK,OAAS,IAAG,KAAK,WAAa,KAGnC,KAAK,eAAiB,IACxB,KAAK,OAAO,UAAY,KAAK,OAAO,UAAY,KAAK,eACrD,KAAK,eAAiB,EAE1B,CACF,CAGO,MAAM4D,WAA0BpD,CAAO,CACpC,YACA,YAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,qBAAA,CACP,EACD,KAAK,YAAc,IACnB,KAAK,YAAc,GACrB,CAEU,MAAa,CACrB,MAAMqC,EAAc,KAAK,eAAA,EAEnBX,EAAS,KAAK,iBAAA,EAGpBA,EAAO,YACL,KAAK,IAAIW,CAAW,EAAI,KAAK,YAC7B,KAAK,IAAIA,CAAW,EAAI,KAAK,WAAA,EAI/B,KAAK,MAAM,KAAK,YAAY,KAAK,YAAa,IAAM,CAClD,GAAIX,EAAO,OAAQ,CACjB,MAAM0B,EAAc,IAAM,CACxB,GAAI,CAAC1B,EAAO,OAAQ,OAEpB,MAAM2B,EAAmB,KAAK,MAAM,kBAAA,EAC9BrE,EAAKqE,EAAiB,EAAI3B,EAAO,EACjCzC,EAAKoE,EAAiB,EAAI3B,EAAO,EAGvC,GAFiB,KAAK,KAAK1C,EAAKA,EAAKC,EAAKA,CAAE,EAE7B,GAAI,CACjByC,EAAO,QAAA,EACP,MACF,CAEA,MAAM4B,EAAc,KAAK,MAAMrE,EAAID,CAAE,EACrC0C,EAAO,YACL,KAAK,IAAI4B,CAAW,EAAI,KAAK,YAAc,IAC3C,KAAK,IAAIA,CAAW,EAAI,KAAK,YAAc,GAAA,EAG7C,KAAK,MAAM,KAAK,YAAY,GAAIF,CAAW,CAC7C,EACAA,EAAA,CACF,CACF,CAAC,EAED,KAAK,MAAM,KAAK,YAAY,IAAM,IAAM,CAClC1B,EAAO,QAAQA,EAAO,QAAA,CAC5B,CAAC,CACH,CAEU,cAAqB,CAC7B,KAAK,aAAe,GAChB,KAAK,OAAS,IAAG,KAAK,YAAc,KAC1C,CACF,CAGO,MAAM6B,WAAyBxD,CAAO,CAC3C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,oBAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,wBAAwBxM,EAAmB,CACnD,OAAO,KAAK,kBAAqBA,EAAI,GAAK,KAAK,GAAM,CACvD,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,gBAAkB,EAC9C,CACF,CAGO,MAAMgQ,WAAwBzD,CAAO,CAClC,aACA,eAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,mBAAA,CACP,EACD,KAAK,aAAevC,EAAa,WAAW,GAAG,EAC/C,KAAK,eAAiB,GACxB,CAEU,KAAK4C,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvBuD,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,EAAG,SAAU,CAAC,EACjCA,EAAS,aAAa,EAAG,EAAG,KAAK,YAAY,EAC7CA,EAAS,YAAYvD,EAAU,EAAGA,EAAU,CAAC,EAE7C,KAAK,kBAAkBsB,EAAS,KAAK,YAAY,EAAE,QAASd,GAAU,CACpEA,EAAM,WAAW,KAAK,MAAM,EAE5B,MAAMG,EAAQvG,EAAO,KAAK,MAAM,QAC9BoG,EAAM,OAAO,EACbA,EAAM,OAAO,EACbR,EAAU,EACVA,EAAU,CAAA,EAEZQ,EAAM,YAAY,KAAK,IAAIG,CAAK,EAAI,IAAK,KAAK,IAAIA,CAAK,EAAI,GAAG,CAChE,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS4C,EACT,OAAQ,GACR,OAAQ,GACR,MAAO,EACP,SAAU,KAAK,eACf,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,CACH,CAEU,cAAqB,CAC7B,KAAK,cAAgB7E,EAAa,WAAW,EAAE,EAC3C,KAAK,OAAS,IAAG,KAAK,eAAiB,MACvC,KAAK,OAAS,IAAG,KAAK,SAAW,MAGrC,KAAK,mBAAA,CACP,CACF,CAGO,MAAMgG,WAA2B1D,CAAO,CAC7C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,sBAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,gBAAkB,EAC9C,CACF,CAGO,MAAM0D,WAA6B3D,CAAO,CACvC,aAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,wBAAA,CACP,EACD,KAAK,aAAevC,EAAa,WAAW,GAAG,EAC/C,KAAK,WAAa,EACpB,CAEU,KAAK4C,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvBuD,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,EAAG,SAAU,CAAC,EACjCA,EAAS,aAAa,EAAG,EAAG,KAAK,YAAY,EAC7CA,EAAS,YAAYvD,EAAU,EAAGA,EAAU,CAAC,EAE7C,KAAK,kBAAkBsB,EAAS,KAAK,YAAY,EAAE,QAASd,GAAU,CACpEA,EAAM,WAAW,KAAK,MAAM,EAG5B,MAAMoE,EAAS,KAAK,MAAM,IAAI,SAAA,EAC9BA,EAAO,UAAU,EAAG,SAAU,CAAC,EAC/BA,EAAO,aAAa,EAAG,EAAG,EAAE,EAC5BA,EAAO,YAAYpE,EAAM,OAAO,EAAGA,EAAM,OAAO,EAAI,EAAE,EAEtD,KAAK,MAAM,OAAO,IAAI,CACpB,QAASoE,EACT,MAAO,EACP,EAAGpE,EAAM,OAAO,EAAI,GACpB,SAAU,IACV,WAAY,IAAMoE,EAAO,QAAA,CAAQ,CAClC,CACH,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAASrB,EACT,OAAQ,IACR,OAAQ,IACR,MAAO,EACP,SAAU,IACV,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,CACH,CAEU,cAAqB,CAC7B,KAAK,cAAgB7E,EAAa,WAAW,EAAE,EAC3C,KAAK,OAAS,IAAG,KAAK,WAAa,IACnC,KAAK,OAAS,IAAG,KAAK,WAAa,IACnC,KAAK,OAAS,IAAG,KAAK,WAAa,GACzC,CACF,CAGO,MAAMmG,WAAyB7D,CAAO,CACnC,WACA,WAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,oBAAA,CACP,EACD,KAAK,WAAavC,EAAa,WAAW,GAAG,EAC7C,KAAK,WAAa,KAAK,EACzB,CAEU,KAAK4C,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EACvBsD,EAAc,KAAK,eAAA,EAGnBC,EAAW,KAAK,MAAM,IAAI,SAAA,EAChCA,EAAS,UAAU,SAAU,EAAG,EAEhC,MAAMuB,EAAaxB,EAAc,KAAK,WAAa,EAC7CyB,EAAWzB,EAAc,KAAK,WAAa,EAE3C0B,EAAS,KAAK,OAAA,EAAW,GAE/BzB,EAAS,MACP,EACA,EACA,KAAK,WACLyB,EAAS,CAACF,EAAaA,EACvBE,EAAS,CAACD,EAAWA,EACrB,EAAA,EAEFxB,EAAS,SAAA,EACTA,EAAS,YAAYvD,EAAU,EAAGA,EAAU,CAAC,EAE7CsB,EAAQ,QAASd,GAAU,CACzB,MAAML,EAAW/F,EAAO,KAAK,SAAS,QACpC4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAETG,EAAQvG,EAAO,KAAK,MAAM,QAC9B4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGTgD,EAAY,KAAK,IAAIpJ,EAAO,KAAK,MAAM,KAAKuG,EAAQ2C,CAAW,CAAC,EAElEnD,EAAW,KAAK,YAAcqD,EAAY,KAAK,WAAa,IAC9DhD,EAAM,WAAW,KAAK,MAAM,EAE5BA,EAAM,YAAY,KAAK,IAAIG,CAAK,EAAI,IAAK,KAAK,IAAIA,CAAK,EAAI,GAAG,EAElE,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS4C,EACT,MAAO,EACP,OAAQ,IACR,OAAQ,IACR,SAAU,IACV,WAAY,IAAMA,EAAS,QAAA,CAAQ,CACpC,CACH,CAEU,cAAqB,CAC7B,KAAK,YAAc7E,EAAa,WAAW,EAAE,EACzC,KAAK,OAAS,IAAG,KAAK,WAAa,KAAK,GAAK,KAC7C,KAAK,OAAS,IAAG,KAAK,SAAW,KACvC,CACF,CAGO,MAAMuG,WAA6BjE,CAAO,CACvC,cACA,aACA,kBAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,wBAAA,CACP,EACD,KAAK,cAAgBvC,EAAa,WAAW,GAAG,EAChD,KAAK,aAAe,IACpB,KAAK,kBAAoB,CAC3B,CAEU,KAAK4C,EAAwB,CACrC,MAAMtB,EAAY,KAAK,MAAM,kBAAA,EAGvBkF,EAAkB,KAAK,MAAM,IAAI,SAAA,EACvCA,EAAgB,YAAYlF,EAAU,EAAGA,EAAU,CAAC,EAGpD,QAASvL,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAMkM,EAASlM,EAAI,KAAK,GAAM,EACxBoK,EAAI,KAAK,IAAI8B,CAAK,EAAI,KAAK,cAC3B7B,EAAI,KAAK,IAAI6B,CAAK,EAAI,KAAK,cAEjCuE,EAAgB,UAAU,SAAU,EAAG,EACvCA,EAAgB,WAAWrG,EAAGC,EAAG,EAAE,CACrC,CAGAoG,EAAgB,UAAU,SAAU,EAAG,EACvCA,EAAgB,WAAW,EAAG,EAAG,KAAK,aAAa,EAEnD,KAAK,kBAAkB5D,EAAS,KAAK,aAAa,EAAE,QAASd,GAAU,CACrEA,EAAM,WAAW,KAAK,MAAM,EAG5B,MAAM2E,EAAe,KAAK,MAAM,KAAK,aAAe,GAAG,EAEvD,KAAK,MAAM,KAAK,SAAS,CACvB,MAAO,IACP,OAAQA,EAAe,EACvB,SAAU,IAAM,CACd3E,EAAM,WAAW,KAAK,iBAAiB,CACzC,CAAA,CACD,CACH,CAAC,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS0E,EACT,MAAO,EACP,OAAQ,IACR,OAAQ,IACR,SAAU,KACV,WAAY,IAAMA,EAAgB,QAAA,CAAQ,CAC3C,CACH,CAEU,cAAqB,CAC7B,KAAK,mBAAqB,EACtB,KAAK,OAAS,SAAQ,cAAgBxG,EAAa,WAAW,GAAG,GACjE,KAAK,OAAS,IAAG,KAAK,aAAe,IAC3C,CACF,CAGO,MAAM0G,WAAoBpE,CAAO,CAC9B,cACA,aAER,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,cAAA,CACP,EACD,KAAK,cAAgBvC,EAAa,WAAW,GAAG,EAChD,KAAK,aAAe,GACtB,CAEU,KAAK4C,EAAwB,CACrC,MAAM+D,EAAe/D,EAAQ,CAAC,EAC9B,GAAI,CAAC+D,EAAc,OAEnB,MAAMC,EAAUD,EAAa,OAAO,EAC9BE,EAAUF,EAAa,OAAO,EAG9BG,EAAU,KAAK,MAAM,IAAI,SAAA,EAC/BA,EAAQ,YAAYF,EAASC,CAAO,EAGpC,QAAS9Q,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAMkM,EAASlM,EAAI,KAAK,GAAM,EAAI,KAAK,MAAM,KAAK,IAAM,IAClD8M,EAAS,KAAK,eAAiB,EAAI9M,EAAI,IACvCoK,EAAI,KAAK,IAAI8B,CAAK,EAAIY,EACtBzC,EAAI,KAAK,IAAI6B,CAAK,EAAIY,EAE5BiE,EAAQ,UAAU,MAAU,GAAM/Q,EAAI,GAAI,EAC1C+Q,EAAQ,WAAW3G,EAAGC,EAAG,EAAE,CAC7B,CAGA,MAAM2G,EAAkB,IAClBC,EAAiB,IACjBC,EAAcF,EAAkBC,EAEtC,KAAK,MAAM,KAAK,SAAS,CACvB,MAAOA,EACP,OAAQC,EAAc,EACtB,SAAU,IAAM,CACdrE,EAAQ,QAASd,GAAU,CAQzB,GAPiBpG,EAAO,KAAK,SAAS,QACpCkL,EACAC,EACA/E,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGA,KAAK,cAAe,CACjCA,EAAM,WAAW,KAAK,OAASmF,CAAW,EAG1C,MAAMhF,EAAQvG,EAAO,KAAK,MAAM,QAC9BoG,EAAM,OAAO,EACbA,EAAM,OAAO,EACb8E,EACAC,CAAA,EAGF/E,EAAM,YACJ,KAAK,IAAIG,CAAK,EAAI,KAAK,aACvB,KAAK,IAAIA,CAAK,EAAI,KAAK,YAAA,CAE3B,CACF,CAAC,CACH,CAAA,CACD,EAED,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS6E,EACT,SAAU,KAAK,GAAK,EACpB,MAAO,EACP,SAAUC,EACV,WAAY,IAAMD,EAAQ,QAAA,CAAQ,CACnC,CACH,CAEU,cAAqB,CAC7B,KAAK,eAAiB9G,EAAa,WAAW,EAAE,EAC5C,KAAK,OAAS,IAAG,KAAK,aAAe,KACrC,KAAK,OAAS,IAAG,KAAK,SAAW,KACvC,CACF,CAGO,MAAMkH,WAA0B5E,CAAO,CAC5C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,qBAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,SAAW,KACvC,CACF,CAGO,MAAM4E,WAA6B7E,CAAO,CAC/C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,wBAAA,CACP,CACH,CAEU,KAAKK,EAAwB,CACrC,IAAIuB,EAAgBvB,EAAQ,CAAC,EAC7B,UAAWpN,KAAQoN,EACbpN,EAAK,OAAS2O,EAAO,SACvBA,EAAS3O,GAIR2O,GAEL,MAAM,KAAK,CAACA,CAAM,CAAC,CACrB,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,SAAW,IACvC,CACF,CAGO,MAAMiD,WAAqB9E,CAAO,CACvC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,eAAA,CACP,EACD,KAAK,WAAa,EACpB,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,WAAa,IACnC,KAAK,OAAS,IAAG,KAAK,WAAa,IACnC,KAAK,OAAS,IAAG,KAAK,WAAa,GAEvC,KAAK,mBAAA,CACP,CACF,CAGO,MAAM8E,WAAwB/E,CAAO,CAC1C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,kBAAA,CACP,CACH,CAEU,cAAqB,CACzB,KAAK,OAAS,IAAG,KAAK,gBAAkB,KACxC,KAAK,OAAS,IAAG,KAAK,gBAAkB,EAC9C,CACF,CAGO,MAAM+E,WAAsBhF,CAAO,CACxC,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,iBAAA,CACP,EACD,KAAK,gBAAkB,CACzB,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACxB,KAAK,gBAAkB,KAAK,MAAQ,EAChC,KAAK,OAAS,IAAG,KAAK,SAAW,KACvC,CACF,CAGO,MAAMgF,WAAyBjF,CAAO,CAC3C,YAAYpC,EAAkBqC,EAAgB,CAC5C,MAAMrC,EAAOqC,EAAQ,CACnB,KAAM,oBAAA,CACP,CACH,CAEU,cAAqB,CAC7B,KAAK,iBAAmB,GACpB,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAAG,KAAK,gBAAkB,GACxC,KAAK,OAAS,IAChB,KAAK,gBAAkB,EACvB,KAAK,SAAW,IAEpB,CACF,CA+CO,MAAMiF,GAA8C,CACzD,aAAcnE,GACd,gBAAiBC,GACjB,WAAYC,GACZ,WAAYC,GACZ,WAAYC,GACZ,YAAaC,GACb,YAAaI,GACb,KAAMC,GACN,WAAYC,GACZ,aAAcE,GACd,WAAYG,GACZ,iBAAkBC,GAClB,mBAAoBC,GACpB,YAAaE,GACb,aAAcC,GACd,oBAAqBK,GACrB,gBAAiBC,GACjB,eAAgBE,GAChB,YAAaC,GACb,iBAAkBC,GAClB,cAAeE,GACf,oBAAqBI,GACrB,mBAAoBI,GACpB,kBAAmBC,GACnB,qBAAsBC,GACtB,uBAAwBC,GACxB,mBAAoBE,GACpB,uBAAwBI,GACxB,aAAcG,GACd,oBAAqBQ,GACrB,uBAAwBC,GACxB,cAAeC,GACf,iBAAkBC,GAClB,gBAAiBC,GACjB,mBAAoBC,EACtB,EAGO,MAAME,EAAc,CACjB,MACA,OACA,QAER,YAAYvH,EAAkBqC,EAAgB,CAC5C,KAAK,MAAQrC,EACb,KAAK,OAASqC,EACd,KAAK,QAAU,CAAA,CACjB,CAEO,OAAOI,EAAcC,EAAwB,CAClD,MAAMtB,EAAY,KAAK,OAAO,OAExBoG,EADO9E,EAAQ,OAAQzP,GAAM,CAACA,EAAE,MAAM,EACjB,KAAK,CAACwU,EAAGC,IAAM,CACxC,MAAMC,EAAQnM,EAAO,KAAK,SAAS,QACjC4F,EAAU,EACVA,EAAU,EACVqG,EAAE,OAAO,EACTA,EAAE,OAAO,CAAA,EAELG,EAAQpM,EAAO,KAAK,SAAS,QACjC4F,EAAU,EACVA,EAAU,EACVsG,EAAE,OAAO,EACTA,EAAE,OAAO,CAAA,EAEX,OAAOC,EAAQC,CACjB,CAAC,EACD,KAAK,QAAQ,QAASC,GAAW,CAC/BA,EAAO,OAAOpF,EAAM+E,CAAa,CACnC,CAAC,CACH,CAEO,UAAUM,EAAkC,CACjD,MAAMD,EAAS,IAAIC,EAAY,KAAK,MAAO,KAAK,MAAM,EACtD,YAAK,QAAQ,KAAKD,CAAM,EACpBrQ,IACF,QAAQ,IAAI,YAAaqQ,CAAM,EAG1BA,CACT,CAEO,UAAUC,EAAmC,CAClD,OAAO,KAAK,QAAQ,KAAMD,GAAWA,aAAkBC,CAAW,CACpE,CAEO,UAAUA,EAA8C,CAC7D,OAAO,KAAK,QAAQ,KAAMD,GAAWA,aAAkBC,CAAW,CACpE,CAEO,cAAczS,EAA6B,CAChD,OAAOiS,GAAWjS,CAAE,GAAK8N,EAC3B,CAMO,YAAuB,CAC5B,OAAO,KAAK,OACd,CAEO,mBAAqC,CAC1C,MAAM4E,EAA2B,CAAA,EAGjC,YAAK,QAAQ,QAASF,GAAW,CAC/B,GAAIA,EAAO,MAAQA,EAAO,SAAU,CAClC,MAAMG,EAAO9U,EAAK,EAAE,WAAW2U,EAAO,IAAI,OAAO,EACjDE,EAAQ,KAAK,CACX,KAAM,UACN,OAAAF,EACA,KAAM3U,EAAK,EAAE,yBAA0B,CACrC,KAAA8U,EACA,MAAOH,EAAO,MAAQ,CAAA,CACvB,EACD,YAAa3U,EAAK,EAAE,kBAAmB,CAAE,KAAA8U,EAAM,CAAA,CAChD,CACH,CACF,CAAC,EAGD,OAAO,QAAQV,EAAU,EAAE,QAAQ,CAAC,CAAC9T,EAAMyU,CAAW,IAAM,CACrD,KAAK,UAAUA,CAAW,GAC7BF,EAAQ,KAAK,CACX,KAAM,MACN,YAAAE,EACA,KAAM/U,EAAK,EAAE,WAAWM,CAAI,OAAO,EACnC,YAAaN,EAAK,EAAE,WAAWM,CAAI,cAAc,CAAA,CAClD,CAEL,CAAC,EAGgBuU,EAAQ,KAAK,IAAM,KAAK,OAAA,EAAW,EAAG,EACvC,MAAM,EAAGxQ,CAAe,CAC1C,CAEO,OAAc,CACnB,KAAK,QAAQ,QAASsQ,GAAW,CAC/BA,EAAO,QAAA,CACT,CAAC,EACD,KAAK,QAAU,CAAA,CACjB,CACF,CCnxDO,MAAMK,EAAgB,CACpB,OACA,KACA,MACC,MACA,WACA,cACA,aAER,YACElI,EACAC,EACAC,EACA1M,EACAqN,EAAgB,EAChB,CACA,KAAK,MAAQb,EACb,KAAK,KAAOxM,EACZ,KAAK,MAAQqN,EACb,KAAK,WAAa,GAClB,KAAK,cAAgBvO,GACrB,KAAK,aAAeC,GAGpB,IAAI4V,EACA3U,IAAS,OACX2U,EAAc9V,EAAQ,KAGlBwO,GAAS,EACXsH,EAAc9V,EAAQ,QACbwO,GAAS,EAClBsH,EAAc9V,EAAQ,UAEtB8V,EAAc9V,EAAQ,OAK1B,MAAM+V,EAAWtI,EAAa,WAAWtN,EAAmB,EAC5D,KAAK,OAASwN,EAAM,QAAQ,IAAI,OAAOC,EAAGC,EAAGiI,CAAW,EACxD,KAAK,OAAO,eAAeC,EAAUA,CAAQ,EAE7C,KAAK,OAAO,MAAM,QAAQA,EAAUA,CAAQ,CAC9C,CAEO,OACLhH,EACAiH,EAA4B,EAC5BC,EAAsB,EACb,CACT,MAAMjH,EAAKD,EAAU,EAAI,KAAK,OAAO,EAC/BE,EAAKF,EAAU,EAAI,KAAK,OAAO,EAC/BG,EAAW,KAAK,KAAKF,EAAKA,EAAKC,EAAKA,CAAE,EAEtCiH,EAAqB,EAAIF,EACzBG,EAAoB,EAAIF,EAGxBG,EAAwB3I,EAAa,WACzC,KAAK,cAAgByI,CAAA,EAEjBG,EAAuB5I,EAAa,WACxC,KAAK,aAAe0I,CAAA,EAItB,OAAIjH,EAAWkH,EACN,IAILlH,EAAWmH,IACb,KAAK,WAAa,IAGhB,KAAK,YAEP,KAAK,OAAO,YAAarH,EAAKE,EAAY,IAAQD,EAAKC,EAAY,GAAK,EAGnE,GACT,CAEO,SAAgB,CAErB,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS,KAAK,OACd,MAAO,EACP,MAAO,IACP,SAAU,IACV,WAAY,IAAM,CAChB,KAAK,OAAO,QAAA,CACd,CAAA,CACD,EAGG,KAAK,OAAS,QAChB5J,EAAa,SAAA,EAAW,QAAQ,KAAK,KAAK,CAE9C,CAEO,SAAgB,CACrB,KAAK,QAAQ,QAAA,CACf,CACF,CAGO,MAAMgR,EAAkB,CACrB,MACA,OACA,aAAkC,CAAA,EAE1C,YAAY3I,EAAkBqC,EAAgB,CAC5C,KAAK,MAAQrC,EACb,KAAK,OAASqC,CAChB,CAGO,QAAe,CACpB,MAAMjB,EAAY,KAAK,MAAM,kBAAA,EACvBiH,EAAoB,KAAK,QAAQ,cAAgB,EACjDC,EAAc,KAAK,QAAQ,aAAe,EAChD,QAASzS,EAAI,KAAK,aAAa,OAAS,EAAGA,GAAK,EAAGA,IAAK,CACtD,MAAM+S,EAAc,KAAK,aAAa/S,CAAC,EACnC+S,EAAY,OAAOxH,EAAWiH,EAAmBC,CAAW,IAE1DM,EAAY,OAAS,OACvB,KAAK,OAAO,cAAcA,EAAY,KAAK,EAE7CA,EAAY,QAAA,EACZ,KAAK,aAAa,OAAO/S,EAAG,CAAC,EAEjC,CACF,CAGO,SAASoK,EAAWC,EAAWW,EAAqB,CACzD,MAAMgI,EAAM,IAAIX,GAAgB,KAAK,MAAOjI,EAAGC,EAAG,MAAOW,CAAK,EAC9D,KAAK,aAAa,KAAKgI,CAAG,CAC5B,CAGO,UAAU5I,EAAWC,EAAWW,EAAqB,CAC1D,MAAMiI,EAAO,IAAIZ,GAAgB,KAAK,MAAOjI,EAAGC,EAAG,OAAQW,CAAK,EAChE,KAAK,aAAa,KAAKiI,CAAI,CAC7B,CAGO,OAAc,CACnB,UAAWF,KAAe,KAAK,aAC7BA,EAAY,QAAA,EAEd,KAAK,aAAe,CAAA,CACtB,CAGO,iBAAiC,CACtC,GAAI,KAAK,aAAa,SAAW,EAC/B,OAAO,QAAQ,QAAA,EAGjB,IAAIG,EAAiB,EACrB,MAAMC,EAAoB,KAAK,aAAa,OAE5C,OAAO,IAAI,QAASC,GAAY,CAC9B,UAAWL,KAAe,KAAK,aAAc,CAC3C,MAAMxH,EAAY,KAAK,MAAM,kBAAA,EAC7B,KAAK,MAAM,OAAO,IAAI,CACpB,QAASwH,EAAY,OACrB,EAAGxH,EAAU,EACb,EAAGA,EAAU,EACb,MAAO,IACP,SAAU,IACV,KAAM5F,EAAO,KAAK,OAAO,UAAU,MACnC,WAAY,IAAM,CAEZoN,EAAY,OAAS,OACvB,KAAK,OAAO,cAAcA,EAAY,KAAK,EAE7CA,EAAY,QAAA,EAGZG,IACIA,IAAmBC,GACrBC,EAAA,CAEJ,CAAA,CACD,CACH,CACF,CAAC,CACH,CACF,CC/MO,IAAKC,GAAAA,IACVA,EAAA,WAAa,aACbA,EAAA,aAAe,eACfA,EAAA,YAAc,cACdA,EAAA,SAAW,WACXA,EAAA,cAAgB,gBALNA,IAAAA,GAAA,CAAA,CAAA,EAYL,MAAMC,EAAa,CAChB,MACA,qBAAuB,GACvB,MAAuC,KAE/C,YAAYnJ,EAAkB,CAC5B,KAAK,MAAQA,CACf,CAKA,OAAc,aAAaA,EAAwB,CACjD,UAAWrJ,KAAO,OAAO,OAAOuS,CAAW,EACzClJ,EAAM,KAAK,MAAMrJ,EAAK,gBAAgBA,CAAG,MAAM,CAEnD,CAKO,QAAQyS,EAA2B,CACxC,KAAM,CAAE,aAAAC,EAAc,YAAAC,GAAgBlO,EAAgB,SAAA,EAEtD,GAAI,GAACiO,GAAgB,KAAK,sBAAwBC,IAAgB,GAClE,MAAK,qBAAuB,GAE5B,GAAI,CACF,KAAK,MAAQ,KAAK,MAAM,MAAM,IAAIF,EAAQ,CACxC,OAAQE,CAAA,CACT,EACD,KAAK,MAAM,KAAA,EAGX,KAAK,MAAM,KAAK,WAAY,IAAM,CAChC,KAAK,UAAA,CACP,CAAC,EACD,KAAK,MAAM,KAAK,QAAUC,GAAiB,CACzC,QAAQ,KAAK,uBAAuBH,CAAM,GAAIG,CAAK,EACnD,KAAK,UAAA,CACP,CAAC,CACH,OAASA,EAAO,CACd,KAAK,UAAA,EACL,QAAQ,KAAK,gCAAgCH,CAAM,GAAIG,CAAK,CAC9D,EACF,CAEO,WAAkB,CACnB,KAAK,QACP,KAAK,MAAM,KAAA,EACX,KAAK,MAAM,QAAA,EACX,KAAK,MAAQ,MAEf,KAAK,qBAAuB,EAC9B,CACF,CCvDO,MAAMC,EAAgB,CACnB,MACA,KACA,MACA,UACA,WACA,YACA,YACA,SAAoB,GACpB,aAA8B,CAAE,EAAG,EAAG,EAAG,CAAA,EACzC,QAAuC,KAE/C,YAAYxJ,EAAkBC,EAAWC,EAAW,CAClD,KAAK,MAAQF,EAGb,KAAK,WAAaF,EAAa,aAAa,EAAE,EAC9C,KAAK,YAAcA,EAAa,aAAa,EAAE,EAC/C,KAAK,YAAc,KAAK,WAAa,KAAK,YAG1C,KAAK,UAAYE,EAAM,IACpB,UAAUC,EAAGC,CAAC,EACd,gBAAgB,CAAC,EACjB,SAASJ,EAAa,UAAA,CAAW,EACjC,SAAS,EAAG,EAGf,KAAK,KAAOE,EAAM,IAAI,SAAA,EACtB,KAAK,KAAK,UAAU,EAAG,SAAU,EAAG,EACpC,KAAK,KAAK,UAAU,EAAU,EAAG,EACjC,KAAK,KAAK,WAAW,EAAG,EAAG,KAAK,UAAU,EAC1C,KAAK,KAAK,aAAa,EAAG,EAAG,KAAK,UAAU,EAG5C,KAAK,MAAQA,EAAM,IAAI,SAAA,EACvB,KAAK,MAAM,UAAU,EAAG,SAAU,EAAG,EACrC,KAAK,MAAM,UAAU,SAAU,EAAG,EAClC,KAAK,MAAM,WAAW,EAAG,EAAG,KAAK,WAAW,EAC5C,KAAK,MAAM,aAAa,EAAG,EAAG,KAAK,WAAW,EAE9C,KAAK,UAAU,IAAI,CAAC,KAAK,KAAM,KAAK,KAAK,CAAC,EAG1C,KAAK,WAAA,EAGL,KAAK,UAAU,WAAW,EAAK,CACjC,CAEQ,YAAmB,CAEzB,MAAMyJ,EAAU,IAAIjO,EAAO,KAAK,OAAO,EAAG,EAAG,KAAK,UAAU,EAC5D,KAAK,UAAU,eAAeiO,EAASjO,EAAO,KAAK,OAAO,QAAQ,EAGlE,KAAK,UAAU,GAAG,cAAgBkO,GAAkC,CAClE,KAAK,SAAW,GAChB,KAAK,QAAUA,EACf,KAAK,oBAAoBA,CAAO,EAChC,KAAK,UAAU,SAAS,EAAG,CAC7B,CAAC,EAGD,KAAK,MAAM,MAAM,GAAG,cAAgBA,GAAkC,CAChE,KAAK,UAAY,KAAK,UAAYA,GACpC,KAAK,oBAAoBA,CAAO,CAEpC,CAAC,EAGD,KAAK,MAAM,MAAM,GAAG,YAAcA,GAAkC,CAC9D,KAAK,UAAYA,IACnB,KAAK,SAAW,GAChB,KAAK,QAAU,KACf,KAAK,WAAA,EACL,KAAK,UAAU,SAAS,EAAG,EAE/B,CAAC,CACH,CAEQ,oBAAoBA,EAAqC,CAE/D,MAAMC,EAASD,EAAQ,EAAI,KAAK,UAAU,EACpCE,EAASF,EAAQ,EAAI,KAAK,UAAU,EAGpCnI,EAAW,KAAK,KAAKoI,EAASA,EAASC,EAASA,CAAM,EACtD7H,EAAQ,KAAK,MAAM6H,EAAQD,CAAM,EAGjCE,EAAkB,KAAK,IAAItI,EAAU,KAAK,WAAW,EAGrDuI,EAAS,KAAK,IAAI/H,CAAK,EAAI8H,EAC3BE,EAAS,KAAK,IAAIhI,CAAK,EAAI8H,EAGjC,KAAK,MAAM,MAAA,EACX,KAAK,MAAM,UAAU,EAAG,SAAU,EAAG,EACrC,KAAK,MAAM,UAAU,SAAU,EAAG,EAClC,KAAK,MAAM,WAAWC,EAAQC,EAAQ,KAAK,WAAW,EACtD,KAAK,MAAM,aAAaD,EAAQC,EAAQ,KAAK,WAAW,EAGxD,KAAK,aAAa,EAAID,EAAS,KAAK,YACpC,KAAK,aAAa,EAAIC,EAAS,KAAK,WACtC,CAEQ,YAAmB,CAEzB,KAAK,MAAM,MAAA,EACX,KAAK,MAAM,UAAU,EAAG,SAAU,EAAG,EACrC,KAAK,MAAM,UAAU,SAAU,EAAG,EAClC,KAAK,MAAM,WAAW,EAAG,EAAG,KAAK,WAAW,EAC5C,KAAK,MAAM,aAAa,EAAG,EAAG,KAAK,WAAW,EAG9C,KAAK,aAAa,EAAI,EACtB,KAAK,aAAa,EAAI,CACxB,CAEO,UAA0B,CAC/B,OAAO,KAAK,YACd,CAEO,WAAqB,CAC1B,OAAO,KAAK,QACd,CAEO,MAAa,CAClB,KAAK,UAAU,WAAW,EAAI,CAChC,CAEO,MAAa,CAClB,KAAK,UAAU,WAAW,EAAK,EAC3B,KAAK,WACP,KAAK,WAAA,EACL,KAAK,SAAW,GAEpB,CAEO,YAAY9J,EAAWC,EAAiB,CAC7C,KAAK,UAAU,YAAYD,EAAGC,CAAC,CACjC,CAEO,YAAmB,CAExB,MAAM8J,EAAgB,KAAK,WAC3B,KAAK,WAAalK,EAAa,aAAa,EAAE,EAC9C,KAAK,YAAcA,EAAa,aAAa,EAAE,EAC/C,KAAK,YAAc,KAAK,WAAa,KAAK,YAG1C,KAAK,KAAK,MAAA,EACV,KAAK,KAAK,UAAU,EAAG,SAAU,EAAG,EACpC,KAAK,KAAK,UAAU,EAAU,EAAG,EACjC,KAAK,KAAK,WAAW,EAAG,EAAG,KAAK,UAAU,EAC1C,KAAK,KAAK,aAAa,EAAG,EAAG,KAAK,UAAU,EAE5C,KAAK,WAAA,EAGL,MAAM2J,EAAU,IAAIjO,EAAO,KAAK,OAAO,EAAG,EAAG,KAAK,UAAU,EAC5D,KAAK,UAAU,eAAeiO,EAASjO,EAAO,KAAK,OAAO,QAAQ,EAGlE,MAAMyO,EAAQ,KAAK,WAAaD,EAChC,KAAK,UAAU,GAAKC,EACpB,KAAK,UAAU,GAAKA,CACtB,CAEO,SAAgB,CACrB,KAAK,UAAU,QAAA,CACjB,CACF,CCpLO,MAAMC,EAAkB,CACrB,MACA,WAA8C,CAAA,EAC9C,QAA+C,KAC/C,YAAsB,GACtB,iBAER,YAAYlK,EAAqB,CAC/B,KAAK,MAAQA,CACf,CAEO,KAAKmK,EAAiD,CAC3D,GAAI,CAACA,EACH,OAIF,MAAMpC,EAAU,KAAK,gBAAA,EAErB,GAAIA,EAAQ,SAAW,EACrB,OAGE,KAAK,aACP,KAAK,KAAA,EAGP,KAAK,iBAAmBoC,EAGxB,KAAK,MAAM,QAAQ,MAAA,EAEnB,MAAMC,EAAU,KAAK,MAAM,QAAQ,KAAK,MAAQ,EAC1CC,EAAU,KAAK,MAAM,QAAQ,KAAK,OAAS,EAGjD,KAAK,QAAU,KAAK,MAAM,IACvB,UACCD,EACAC,EACA,KAAK,MAAM,QAAQ,KAAK,MACxB,KAAK,MAAM,QAAQ,KAAK,OACxB,EACA,GAAA,EAED,gBAAgB,CAAC,EACjB,SAASvK,EAAa,WAAW,EAEpC,KAAK,WAAW,KAAK,KAAK,OAAO,EAGjC,MAAMwK,EAAQ,KAAK,MAAM,IACtB,KACCF,EACAC,EAAUvK,EAAa,aAAa,GAAG,EACvC5M,EAAK,EAAE,eAAe,EACtB,CACE,SAAU4M,EAAa,aAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,OACX,OAAQ,UACR,gBAAiB,CAAA,CACnB,EAED,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASA,EAAa,WAAW,EAEpC,KAAK,WAAW,KAAKwK,CAAK,EAG1B,KAAK,oBAAoBF,EAASC,EAAStC,CAAO,EAGlD,KAAK,oBAAoBqC,EAASC,CAAO,EAGzC,KAAK,gBAAgBD,EAASC,CAAO,CACvC,CAEQ,iBAAkB,CACxB,MAAMtC,EAA0B,CAAA,EAEhC,OAAI,KAAK,OAAA,EAAW,GAEI7R,GAAiBqB,CAAe,EACxC,QAASkB,GAAa,CAClCsP,EAAQ,KAAK,CACX,KAAM,SACN,KAAM,CAAE,GAAGnW,EAAQ6G,CAAQ,CAAA,CAAE,CAC9B,CACH,CAAC,EAGqBtC,GAAiBoB,CAAe,EACxC,QAASgT,GAAa,CAClCxC,EAAQ,KAAK,CACX,KAAM,SACN,KAAM,CAAE,GAAGlW,GAAQ0Y,CAAQ,CAAA,CAAE,CAC9B,CACH,CAAC,EAIHxC,EAAQ,KAAK,IAAM,KAAK,OAAA,EAAW,EAAG,EAE/BA,CACT,CAEQ,oBACNqC,EACAC,EACAtC,EACM,CACN,MAAMyC,EAAW,KAAK,OACnB,KAAK,MAAM,QAAQ,KAAK,MAAQ,IAAMjT,CAAA,EAGnCkT,EAAc,KAAK,IAAID,EAAU1K,EAAa,aAAa,GAAG,CAAC,EAC/D4K,EAAe5K,EAAa,aAAa,GAAG,EAC5C6K,EAAU7K,EAAa,aAAa,EAAE,EACtC8K,EACJR,GACCK,EAAc1C,EAAQ,OAAS4C,GAAW5C,EAAQ,OAAS,IAAM,EAC9D8C,EAAQ/K,EAAa,UAAA,EAS3B,GAPAiI,EAAQ,QAAQ,CAAC+C,EAAQC,IAAU,CACjC,MAAM9K,EAAI2K,EAASG,GAASN,EAAcE,GAAWF,EAAc,EAC7DvK,EAAImK,EAAUvK,EAAa,aAAa,EAAE,EAEhD,KAAK,mBAAmBgL,EAAQ7K,EAAGC,EAAGuK,EAAaC,EAAcG,CAAK,CACxE,CAAC,EAEGzP,EAAgB,SAAA,EAAW,iBAAkB,CAC/C,MAAM2P,EAAQ,KAAK,MAAM,KAAK,OAAA,EAAWhD,EAAQ,MAAM,EACvD,KAAK,aAAaA,EAAQgD,CAAK,CAAC,CAClC,CACF,CAEQ,mBACND,EACA7K,EACAC,EACA8K,EACAC,EACAJ,EACA,CAEA,MAAM7V,EAAS8V,EAAO,KAAK,OACrBI,EAAQnZ,GAAciD,CAAM,EAG5BmW,EAAa,KAAK,MAAM,IAC3B,UAAUlL,EAAGC,EAAG8K,EAAOC,EAAQ,OAAQ,EACvC,eAAe,EAAGC,CAAK,EACvB,gBAAgB,CAAC,EACjB,SAASL,CAAK,EACd,eAAe,CAAE,cAAe,EAAA,CAAM,EAEzC,KAAK,WAAW,KAAKM,CAAU,EAE/B,MAAMC,EAAWN,EAAO,OAAS,SAG3BO,EAAO,KAAK,MAAM,IACrB,KAAKpL,EAAGC,EAAIJ,EAAa,aAAa,EAAE,EAAGsL,EAAW,KAAO,KAAM,CAClE,SAAUtL,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,CAAe,CACzC,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAAS+K,EAAQ,CAAC,EAErB,KAAK,WAAW,KAAKQ,CAAI,EAEzB,MAAMrD,EAAOoD,EACTlY,EAAK,EAAE,WAAW4X,EAAO,KAAK,EAAE,OAAO,EACvC5X,EAAK,EAAE,WAAW4X,EAAO,KAAK,EAAE,OAAO,EAErCQ,EAAcF,EAChBlY,EAAK,EAAE,WAAW4X,EAAO,KAAK,EAAE,cAAc,EAC9C5X,EAAK,EAAE,WAAW4X,EAAO,KAAK,EAAE,cAAc,EAG5CS,EAAW,KAAK,MAAM,IACzB,KAAKtL,EAAGC,EAAIJ,EAAa,aAAa,EAAE,EAAGkI,EAAM,CAChD,SAAUlI,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,OACX,MAAO,SACP,SAAU,CAAE,MAAOkL,EAAQ,EAAA,CAAG,CAC/B,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASH,EAAQ,CAAC,EAErB,KAAK,WAAW,KAAKU,CAAQ,EAE7B,IAAIC,EAA2C,KAE1C1L,EAAa,aAEhB0L,EAAW,KAAK,MAAM,IACnB,KAAKvL,EAAGC,EAAIJ,EAAa,aAAa,EAAE,EAAGwL,EAAa,CACvD,SAAUxL,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,MAAO,SACP,SAAU,CAAE,MAAOkL,EAAQ,EAAA,CAAG,CAC/B,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASH,EAAQ,CAAC,EAErB,KAAK,WAAW,KAAKW,CAAQ,GAI/B,MAAMC,EAAa,KAAK,MAAM,IAC3B,KACCxL,EACAC,EAAIJ,EAAa,aAAa,EAAE,EAChC5M,EAAK,EAAE,kBAAkB8B,CAAM,EAAE,EACjC,CACE,SAAU8K,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,IAAIoL,EAAM,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAAC,GAC9C,UAAW,MAAA,CACb,EAED,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASL,EAAQ,CAAC,EAErB,KAAK,WAAW,KAAKY,CAAU,EAI/B,MAAMC,EAAc,CAACP,EAAYE,EAAME,EAAUE,CAAU,EAEvDD,GACFE,EAAY,KAAKF,CAAQ,EAI3BL,EAAW,GAAG,cAAe,IAAM,CACjCA,EAAW,aAAa,OAAQ,EAChC,KAAK,MAAM,OAAO,IAAI,CACpB,QAASO,EACT,OAAQ,KACR,OAAQ,KACR,SAAU,IACV,KAAM,QAAA,CACP,CACH,CAAC,EAEDP,EAAW,GAAG,aAAc,IAAM,CAChCA,EAAW,aAAa,OAAQ,EAChC,KAAK,MAAM,OAAO,IAAI,CACpB,QAASO,EACT,OAAQ,EACR,OAAQ,EACR,SAAU,IACV,KAAM,QAAA,CACP,CACH,CAAC,EAEDP,EAAW,GAAG,cAAe,IAAM,CACjC,KAAK,aAAaL,CAAM,CAC1B,CAAC,CACH,CAEQ,oBAAoBV,EAAiBC,EAAuB,CAElE,MAAMsB,EADOhU,EAAa,SAAA,EAAW,WACV,KAAK,YAE1BiU,EAAUvB,EAAUvK,EAAa,aAAa,GAAG,EACjD2K,EAAc3K,EAAa,aAAa,GAAG,EAC3C4K,EAAe5K,EAAa,aAAa,EAAE,EAE3C+L,EAAY,KAAK,MAAM,IAC1B,UACCzB,EACAwB,EACAnB,EACAC,EACAiB,EAAa,QAAW,OAAA,EAEzB,eAAe,EAAGA,EAAa,SAAW,OAAQ,EAClD,gBAAgB,CAAC,EACjB,SAAS7L,EAAa,WAAW,EAEpC,KAAK,WAAW,KAAK+L,CAAS,EAE9B,MAAMC,EAAc,KAAK,MAAM,IAC5B,KACC1B,EACAwB,EACA1Y,EAAK,EAAE,sBAAuB,CAAE,KAAM,KAAK,YAAa,EACxD,CACE,SAAU4M,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO6L,EAAa,UAAY,UAChC,UAAW,MAAA,CACb,EAED,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAAS7L,EAAa,WAAW,EAEpC,KAAK,WAAW,KAAKgM,CAAW,EAE5BH,IACFE,EAAU,eAAe,CAAE,cAAe,EAAA,CAAM,EAEhDA,EAAU,GAAG,cAAe,IAAM,CAChCA,EAAU,aAAa,OAAQ,CACjC,CAAC,EAEDA,EAAU,GAAG,aAAc,IAAM,CAC/BA,EAAU,aAAa,OAAQ,CACjC,CAAC,EAEDA,EAAU,GAAG,cAAe,IAAM,CAChC,KAAK,QAAA,CACP,CAAC,EAEL,CAEQ,gBAAgBzB,EAAiBC,EAAuB,CAE9D,MAAMhU,EAAegC,EAAY,SAAA,EAAW,cAAgB,CAAA,EACtD0T,EAAkBtV,GAAmBJ,CAAY,EAEvD,GAAI0V,EAAgB,OAAS,EAAG,CAC9B,MAAMC,EAAW,KAAK,MAAM,IACzB,KACC5B,EACAC,EAAUvK,EAAa,aAAa,GAAG,EACvC5M,EAAK,EAAE,oBAAqB,CAAE,MAAO6Y,EAAgB,OAAQ,EAC7D,CACE,SAAUjM,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,QAAA,CACb,EAED,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASA,EAAa,WAAW,EAEpC,KAAK,WAAW,KAAKkM,CAAQ,CAC/B,CACF,CAEQ,SAAgB,CACtB,GAAIrU,EAAa,SAAA,EAAW,UAAU,KAAK,WAAW,EAAG,CAIvD,MAAMsU,EAAU,KAAK,YAAc,EAEnC,KAAK,KAAA,EAGL,KAAK,YAAcA,EACnB,KAAK,KAAK,KAAK,gBAAgB,CACjC,CACF,CAEQ,aAAanB,EAA4B,CAE/C,KAAK,MAAM,OAAO,IAAI,CACpB,QAAS,KAAK,WACd,MAAO,EACP,SAAU,IACV,KAAM,SACN,WAAY,IAAM,CAChB,KAAK,KAAA,EAEL,KAAK,mBAAmBA,CAAM,EAG9B,KAAK,MAAM,QAAQ,OAAA,CACrB,CAAA,CACD,CACH,CAEO,MAAa,CAClB,KAAK,SAAS,QAAA,EACd,KAAK,QAAU,KAGf,KAAK,WAAW,QAASxW,GAAY,CAC/BA,GAAWA,EAAQ,QACrBA,EAAQ,QAAA,CAEZ,CAAC,EAED,KAAK,WAAa,CAAA,EAClB,KAAK,YAAc,EACrB,CAEO,WAAqB,CAC1B,MAAO,GAAQ,KAAK,SAAW,KAAK,WAAW,OAAS,EAC1D,CACF,CClaA,MAAM4X,EAAW,IAAI1Q,EAAO,OAAO,aCoC7B2Q,GAA4B,GAG3B,MAAMC,WAAkB5Q,EAAO,KAAM,CAClC,OACA,QACA,KACA,aACA,cACA,kBACA,SACA,aACA,YACA,UACA,SACA,OACA,UACA,SACA,SACA,YACA,gBACA,qBAA+B,EAC/B,uBAAiC2Q,GACjC,SAAoB,GACpB,WAAsB,GACtB,qBAA+B,EAC/B,UAAY,EACZ,SAAW,EACX,gBAER,aAAc,CACZ,MAAM,CAAE,IAAK,YAAa,CAC5B,CAEO,aAAc,CACnB,OAAO,KAAK,MAAM/Q,EAAgB,WAAW,SAAW,KAAK,QAAQ,CACvE,CAEO,oBAAsB,IAAM,CACjC,KAAK,cAAc,QAAQ8N,EAAY,WAAW,CACpD,EAEO,mBAAoB,CACzB,MAAO,CACL,EAAG,KAAK,OAAO,OAAO,EACtB,EAAG,KAAK,OAAO,OAAO,CAAA,CAE1B,CAEA,SAAgB,CAEdC,GAAa,aAAa,IAAI,EAE9B,MAAMkD,EAAavM,EAAa,WAAWtN,EAAmB,EAG9D,OAAO,OAAOH,CAAO,EAAE,QAASwW,GAAQ,CACtC,KAAK,KAAK,IAAIA,EAAK,UAAUA,CAAG,OAAQ,CACtC,MAAOwD,EACP,OAAQA,CAAA,CACT,CACH,CAAC,EAED,MAAMzT,EAAoBP,EAAY,SAAA,EAAW,mBAAA,EAE3CiU,EAAgBxM,EAAa,WACjCrO,GAAemH,EAAkB,IAAI,CAAA,EAGvC,KAAK,KAAK,IACRA,EAAkB,GAClB7C,GAAsB6C,EAAkB,EAAE,EAC1C,CACE,MAAO0T,EACP,OAAQA,CAAA,CACV,EAGF,MAAMC,EAAYlU,EAAY,SAAA,EAAW,aAAA,EAEzC,OAAO,OAAO3G,CAAY,EAAE,QAASkQ,GAAU,CAC7C,GAAIA,EAAM,UAAY2K,EAAU,GAAI,CAClC,MAAMC,EAAO1M,EAAa,WAAWnO,GAAWiQ,EAAM,IAAI,CAAC,EAC3D,KAAK,KAAK,IAAIA,EAAM,GAAI5L,GAAkB4L,EAAM,EAAE,EAAG,CACnD,MAAO4K,EACP,OAAQA,CAAA,CACT,CACH,CACF,CAAC,EAED,OAAO,OAAO5a,CAAO,EAAE,QAASiW,GAAW,CACzC,KAAK,KAAK,IAAIA,EAAO,GAAI/R,GAAmB+R,EAAO,EAAE,EAAG,CACtD,MAAOwE,EACP,OAAQA,CAAA,CACT,CACH,CAAC,EAED,MAAMI,EAAY3M,EAAa,WAAW1I,EAAU,EAEpD,KAAK,KAAK,IAAImV,EAAU,GAAItW,GAAgBsW,EAAU,EAAE,EAAG,CACzD,MAAOE,EACP,OAAQA,CAAA,CACT,CACH,CAEO,QAAe,CAEpB,KAAK,aAAe,IAAItD,GAAa,IAAI,EAEzCuD,EAAS,GAAGrV,EAAU,oBAAqB,IAAM,CAC/C,KAAK,QAAA,CACP,CAAC,EAED,MAAMoV,EAAY3M,EAAa,WAAW1I,EAAU,EAE9CuV,EAAS,KAAK,MAAMF,EAAY,CAAC,EAGvC,KAAK,QAAQ,MAAM,UAAU,CAACE,EAAQ,CAACA,EAAQF,EAAWA,CAAS,EAGnE,MAAM5T,EAAcR,EAAY,SAAA,EAAW,aAAA,EAGrCuU,EAAW,KAAK,IAAI,MAAM,EAAG,EAAG/T,EAAY,EAAE,EACpD+T,EAAS,UAAU,GAAK,EAAG,EAC3BA,EAAS,SAAS,EAAE,EAGpB,MAAM1O,EAAY7F,EAAY,SAAA,EAAW,mBAAA,EAGzC,KAAK,OAAS,IAAI0H,GAAO,KAAM,EAAG,EAAG7B,EAAU,EAAE,EAGjD,KAAK,OAAO,UAAYA,EAAU,MAAM,WACxC,KAAK,OAAO,OAASA,EAAU,MAAM,WACrC,KAAK,OAAO,MAAQA,EAAU,MAAM,UACpC,KAAK,OAAO,KAAOA,EAAU,MAAM,SACnC,KAAK,OAAO,MAAQA,EAAU,MAAM,UACpC,KAAK,OAAO,OAASA,EAAU,MAAM,WAGrC,MAAMxG,EAAQC,EAAa,SAAA,EAC3BT,EAAmB,QAAS2C,GAAY,CACtC,MAAMhD,EAAQa,EAAMmC,EAAQ,EAAE,GAAK,EACnC,GAAIhD,EAAQ,EAAG,CACb,MAAMuS,EAASvP,EAAQ,OAAOhD,CAAK,EACnC,KAAK,OAAO,QAAQgD,EAAQ,GAAIuP,EAAQA,CAAM,CAChD,CACF,CAAC,EAGD,MAAMyD,EAAgB,KAAK,IAAI,KAAK,OAAO,MAAM,MAG3CxM,EAAU,KAAK,MAAM,UAAU,iBAAA,EAYrC,GAXIA,IACF,KAAK,QAAUA,GAEjB,KAAK,KAAO,CACV,EAAG,KAAK,MAAM,UAAU,OAAO,GAAG,EAClC,EAAG,KAAK,MAAM,UAAU,OAAO,GAAG,EAClC,EAAG,KAAK,MAAM,UAAU,OAAO,GAAG,EAClC,EAAG,KAAK,MAAM,UAAU,OAAO,GAAG,CAAA,EAIhCwM,EAAe,CACjB,MAAMC,EAAUhN,EAAa,aAAa,EAAE,EACtCiN,EAAiBjN,EAAa,aAAa,EAAE,EACnD,KAAK,gBAAkB,IAAI0J,GACzB,KACAsD,EAAUC,EACV,KAAK,QAAQ,KAAK,OAASD,EAAUC,CAAA,EAEvC,KAAK,gBAAgB,KAAA,CACvB,CAGA,KAAK,aAAe,IAAIvL,GAAa,KAAM3I,EAAY,gBAAgB,EAGvE,KAAK,cAAgB,IAAI0O,GAAc,KAAM,KAAK,MAAM,EAGxD,MAAMyF,EAAmB9O,EAAU,eAG7B+O,EACJ,KAAK,cAAc,cAAcD,CAAgB,EACnD,KAAK,cAAc,UAAUC,CAAmB,EAEhD5U,EAAY,SAAA,EAAW,UAAU2U,CAAgB,EAGjD,KAAK,kBAAoB,IAAIrE,GAAkB,KAAM,KAAK,MAAM,EAGhE,KAAK,SAAW,IAAIuB,GAAkB,IAAI,EAG1C,KAAK,SAAA,EAGL,KAAK,SAAW9O,EAAgB,SAAA,EAAW,SAC3C,KAAK,SAAW,GAChB,KAAK,WAAa,GAGlB,KAAK,qBAAuB,EAG5B,KAAK,MAAM,GAAG,SAAU,KAAK,aAAc,IAAI,CACjD,CAEQ,aAAa8R,EAAqC,CACxD,MAAMlC,EAAQkC,EAAS,MACjBjC,EAASiC,EAAS,OAGxBpN,EAAa,YAAA,EAGb,MAAM2M,EAAY3M,EAAa,WAAW1I,EAAU,EAC9CuV,EAAS,KAAK,MAAMF,EAAY,CAAC,EACvC,KAAK,QAAQ,KAAK,UAAU,CAACE,EAAQ,CAACA,EAAQF,EAAWA,CAAS,EAClE,KAAK,QAAQ,KAAK,QAAQ3M,EAAa,eAAe,EAGtD,KAAK,eAAekL,CAAK,EAEzB,MAAM6B,EAAgB,KAAK,IAAI,KAAK,OAAO,MAAM,MAGjD,GAAI,KAAK,iBAAmBA,EAAe,CACzC,KAAK,gBAAgB,WAAA,EACrB,MAAMC,EAAUhN,EAAa,aAAa,EAAE,EACtCiN,EAAiBjN,EAAa,aAAa,EAAE,EACnD,KAAK,gBAAgB,YACnBgN,EAAUC,EACV9B,EAAS6B,EAAUC,CAAA,CAEvB,CACF,CAEQ,eAAe/B,EAAqB,CAC1C,MAAM8B,EAAUhN,EAAa,aAAa,EAAE,EACtCqN,EAAWrN,EAAa,aAAa,GAAG,EACxCsN,EAAYtN,EAAa,aAAa,EAAE,EACxCuN,EAAevN,EAAa,aAAa,EAAE,EAG7C,KAAK,aAAe,KAAK,YAC3B,KAAK,YAAY,YAAYgN,EAASA,CAAO,EAC7C,KAAK,YAAY,QAAQK,EAAUC,CAAS,EAC5C,KAAK,UAAU,YAAYN,EAASA,CAAO,EAC3C,KAAK,UAAU,OAASM,GAItB,KAAK,UAAY,KAAK,SACxB,KAAK,SAAS,YACZN,EACAA,EAAUM,EAAYtN,EAAa,aAAa,CAAC,CAAA,EAEnD,KAAK,SAAS,QAAQqN,EAAUE,CAAY,EAC5C,KAAK,OAAO,YACVP,EACAA,EAAUM,EAAYtN,EAAa,aAAa,CAAC,CAAA,EAEnD,KAAK,OAAO,OAASuN,GAInB,KAAK,YACP,KAAK,UAAU,YACbP,EAAUK,EAAWrN,EAAa,aAAa,EAAE,EACjDgN,CAAA,EAEF,KAAK,UAAU,YAAYhN,EAAa,YAAA,CAAa,GAGvD,MAAMwN,EAAQxN,EAAa,SAAA,EACvBkL,EAAQ8B,EAAUhN,EAAa,aAAa,EAAE,EAC9CkL,EAAQ,EAGZ,KAAK,UAAU,YACbsC,EACAR,EAAUhN,EAAa,aAAa,EAAE,EAAI,CAAA,EAE5C,KAAK,UAAU,YAAYA,EAAa,YAAA,CAAa,EAGrD,MAAMyN,EAAYT,EAAUM,EAAYtN,EAAa,aAAa,CAAC,EACnE,KAAK,UAAU,YAAYwN,EAAOC,CAAS,EAC3C,KAAK,UAAU,YAAYzN,EAAa,YAAA,CAAa,EAErD,MAAM4K,EAAe5K,EAAa,aAAa,EAAE,EAC3C2K,EAAc3K,EAAa,aAAa,EAAE,EAC1CG,EAAIH,EAAa,SAAA,EACnBwN,EACA,KAAK,QAAQ,KAAK,MAAQR,EAAUrC,EAAc,EAChDvK,EAAIJ,EAAa,SAAA,EACnByN,EAAYF,EAAe,EAAIP,EAC/BA,EAAUpC,EAAe,EAE7B,KAAK,aAAa,YAAYzK,EAAGC,CAAC,EAClC,KAAK,iBAAiB,YAAYD,EAAGC,CAAC,CACxC,CAEQ,UAAiB,CAEvB,MAAMsN,EAAc,KAAK,IACtB,UAAU,EAAG,CAAC,EACd,gBAAgB,CAAC,EACjB,SAAS1N,EAAa,WAAW,EAG9BqN,EAAWrN,EAAa,aAAa,GAAG,EACxCsN,EAAYtN,EAAa,aAAa,EAAE,EACxCuN,EAAevN,EAAa,aAAa,EAAE,EAC3CgN,EAAUhN,EAAa,aAAa,EAAE,EAG5C,KAAK,YAAc,KAAK,IAAI,UAC1BgN,EACAA,EACAK,EACAC,EACA,EACA,EAAA,EAGF,KAAK,YAAY,UAAU,EAAG,CAAC,EAC/B,KAAK,UAAY,KAAK,IAAI,UACxBN,EACAA,EACAK,EACAC,EACA,QAAA,EAEF,KAAK,UAAU,UAAU,EAAG,CAAC,EAG7B,KAAK,SAAW,KAAK,IAAI,UACvBN,EACAA,EAAUM,EAAYtN,EAAa,aAAa,CAAC,EACjDqN,EACAE,EACA,EACA,EAAA,EAEF,KAAK,SAAS,UAAU,EAAG,CAAC,EAC5B,KAAK,OAAS,KAAK,IAAI,UACrBP,EACAA,EAAUM,EAAYtN,EAAa,aAAa,CAAC,EACjDqN,EACAE,EACA,KAAA,EAEF,KAAK,OAAO,UAAU,EAAG,CAAC,EAG1B,KAAK,UAAY,KAAK,IAAI,KACxBP,EAAUK,EAAWrN,EAAa,aAAa,EAAE,EACjDgN,EACA5Z,EAAK,EAAE,aAAc,CAAE,MAAO,EAAG,EACjC,CACE,SAAU4M,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,OACX,OAAQ,UACR,gBAAiB,CAAA,CACnB,EAIF,MAAMwN,EAAQxN,EAAa,SAAA,EACvB,KAAK,QAAQ,KAAK,MAAQgN,EAAUhN,EAAa,aAAa,EAAE,EAChE,KAAK,QAAQ,KAAK,MAAQ,EAC9B,KAAK,SAAW,KAAK,IAAI,KACvBwN,EACAR,EAAUhN,EAAa,aAAa,EAAE,EAAI,EAC1C,QACA,CACE,SAAUA,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,OACX,OAAQ,UACR,gBAAiB,CAAA,CACnB,EAEF,KAAK,SAAS,UAAU,GAAK,CAAC,EAE9B,MAAMyN,EAAYT,EAAUM,EAAYtN,EAAa,aAAa,CAAC,EAGnE,KAAK,SAAW,KAAK,IAAI,KACvBwN,EACAC,EACA,GAAGra,EAAK,EAAE,YAAY,CAAC,KAAKyE,EAAa,WAAW,SAAS,GAC7D,CACE,SAAUmI,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,OAAQ,UACR,gBAAiB,CAAA,CACnB,EAEF,KAAK,SAAS,UAAU,GAAK,CAAC,EAE9B,KAAK,UAAY,EAEjB,MAAM4K,EAAe5K,EAAa,aAAa,EAAE,EAC3C2K,EAAc3K,EAAa,aAAa,EAAE,EAC1CG,EAAIH,EAAa,SAAA,EACnBwN,EACA,KAAK,QAAQ,KAAK,MAAQR,EAAUrC,EAAc,EAChDvK,EAAIJ,EAAa,SAAA,EACnByN,EAAYF,EAAe,EAAI3C,EAAe,EAC9CoC,EAAUpC,EAAe,EAE7B,KAAK,YAAc,KAAK,IACrB,UAAUzK,EAAGC,EAAGuK,EAAaC,EAAc,QAAU,EAAG,EACxD,eAAe,EAAG,QAAQ,EAC1B,eAAe,CAAE,cAAe,EAAA,CAAM,EACtC,gBAAgB,CAAC,EACjB,SAAS5K,EAAa,UAAA,CAAW,EAEpC,KAAK,gBAAkB,KAAK,IACzB,KAAKG,EAAGC,EAAG,IAAK,CACf,SAAUJ,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,MAAA,CACZ,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASA,EAAa,WAAW,EAEpC,KAAK,YAAY,GAAG,cAAe,IAAM,CACvC,KAAK,aAAa,aAAa,OAAQ,CACzC,CAAC,EAED,KAAK,YAAY,GAAG,aAAc,IAAM,CACtC,KAAK,aAAa,aAAa,OAAQ,CACzC,CAAC,EAED,KAAK,YAAY,GAAG,cAAe,IAAM,CACvC,KAAK,QAAA,CACP,CAAC,EAED0N,EAAY,IAAI,CACd,KAAK,YACL,KAAK,UACL,KAAK,SACL,KAAK,OACL,KAAK,UACL,KAAK,SACL,KAAK,SACL,KAAK,YACL,KAAK,eAAA,CACN,EAGDd,EAAS,KAAKrV,EAAU,gBAAgB,CAC1C,CAEQ,SAAgB,CAEtBM,EAAa,SAAA,EAAW,SAAS,KAAK,SAAS,EAC/CA,EAAa,SAAA,EAAW,eAAe,KAAK,aAAa,EAEzD,KAAK,UAAU,CACb,MAAOzE,EAAK,EAAE,mBAAmB,EACjC,WAAY,UACZ,YAAaA,EAAK,EAAE,kBAAkB,EACtC,WAAYA,EAAK,EAAE,aAAa,EAChC,SAAU,IAAM,CACd,KAAK,cAAc,UAAA,EACnB,KAAK,OAAA,CACP,EACA,OAAQA,EAAK,EAAE,cAAc,EAC7B,KAAM,IAAM,CACV,KAAK,cAAc,UAAA,EACnBwZ,EAAS,KAAKrV,EAAU,YAAY,CACtC,CAAA,CACD,CACH,CAEQ,UAAiB,CAEvB,MAAMoW,EAAgB,KAAK,OAAO,OAAS,KAAK,OAAO,UACjDN,EAAWrN,EAAa,aAAa,GAAG,EAC1C,KAAK,YACP,KAAK,UAAU,MAAQqN,EAAWM,GAIpC,MAAMC,EACJ,KAAK,OAAO,WAAa,KAAK,OAAO,sBAEnC,KAAK,SACP,KAAK,OAAO,MAAQP,EAAWO,GAIjC,KAAK,WAAW,QACdxa,EAAK,EAAE,aAAc,CAAE,MAAO,KAAK,QAAQ,MAAO,CAAA,EAIpD,KAAK,UAAU,QAAQyB,GAAW,KAAK,QAAQ,CAAC,EAG5C,KAAK,SAAW,GAClB,KAAK,UAAU,SAAS,SAAS,EACxB,KAAK,SAAW,IACzB,KAAK,UAAU,SAAS,SAAS,EAEjC,KAAK,UAAU,SAAS,SAAS,EAInC,KAAK,UAAU,QACb,GAAGzB,EAAK,EAAE,YAAY,CAAC,KAAKyE,EAAa,SAAA,EAAW,SAAS,EAAA,CAEjE,CAEO,OAAO8K,EAAcd,EAAqB,CAC/C,GAAI,KAAK,UAAY,KAAK,WAAY,OAOtC,GAHA,KAAK,UAAYA,EAAQ,IAGrB,KAAK,UAAY,EAAG,CACtB,KAAK,YAAA,EACL,MACF,CAGA,MAAMpB,EAAgB,KAAK,iBAAiB,SAAA,EAC5C,KAAK,OAAO,OAAO,KAAK,QAAS,KAAK,KAAMA,CAAa,EAGzD,MAAMa,EAAY,KAAK,kBAAA,EACvB,KAAK,cAAc,OAAOqB,EAAMd,EAAOP,CAAS,EAGhD,MAAMsB,EAAU,KAAK,cAAc,WAAA,GAAgB,CAAA,EACnD,KAAK,eAAe,OAAOD,EAAMC,CAAO,EAGxC,KAAK,mBAAmB,OAAA,EAGxB,KAAK,gBAAgBf,CAAK,EAG1B,KAAK,SAAA,CACP,CAEQ,gBAAgBA,EAAqB,CAC3C,MAAMe,EAAU,KAAK,cAAc,WAAA,GAAgB,CAAA,EAGnD,KAAK,qBAAuB,KAAK,IAAI,EAAG,KAAK,qBAAuBf,CAAK,EAEzE,MAAMP,EAAY,KAAK,kBAAA,EAEvBsB,EAAQ,QAASd,GAAU,CACzB,GAAIA,EAAM,OAAQ,OAEDpG,EAAO,KAAK,SAAS,QACpC4F,EAAU,EACVA,EAAU,EACVQ,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGA,IAAM,KAAK,sBAAwB,IAChD,KAAK,OAAO,WAAWA,EAAM,MAAM,EACnC,KAAK,cAAc,QAAQsH,EAAY,UAAU,EACjD,KAAK,qBAAuB,IAEhC,CAAC,EAGD,UAAWrB,KAAU,KAAK,eAAe,WAAA,GAAgB,CAAA,EAEvDA,EAAO,YAAY,QAAS/E,GAAe,CACpCA,EAAW,QAEhBJ,EAAQ,QAASd,GAAU,CACzB,GAAIA,EAAM,OAAQ,OAEDpG,EAAO,KAAK,SAAS,QACpCsH,EAAW,EACXA,EAAW,EACXlB,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGAkB,EAAW,WACTlB,EAAM,WAAWkB,EAAW,MAAM,IAE/C,KAAK,YACL,KAAK,uBACL,KAAK,mBAAA,EACL,KAAK,cACHlB,EAAM,OAAO,EACbA,EAAM,OAAO,EACbA,EAAM,SAAA,GAIVkB,EAAW,WACPA,EAAW,UAAY,GACzBA,EAAW,QAAA,EAGjB,CAAC,CACH,CAAC,EAID+E,EAAO,KAAK,QAAQ,CAAC,CAAE,OAAQjF,KAAU,CACvCF,EAAQ,QAASd,GAAU,CACzB,GAAIA,EAAM,OAAQ,OAEDpG,EAAO,KAAK,SAAS,QACpCoH,EAAI,EACJA,EAAI,EACJhB,EAAM,OAAO,EACbA,EAAM,OAAO,CAAA,EAGAgB,EAAI,UACFhB,EAAM,WAAWgB,EAAI,MAAM,IAExC,KAAK,YACL,KAAK,uBACL,KAAK,mBAAA,EACL,KAAK,cACHhB,EAAM,OAAO,EACbA,EAAM,OAAO,EACbA,EAAM,SAAA,EAId,CAAC,CACH,CAAC,CAEL,CAEQ,cAAc3B,EAAWC,EAAWW,EAAqB,CAC/D,MAAM8M,EAAW,GAAM,KAAK,OAAO,KAAO,IACtC,KAAK,OAAA,EAAWA,GAClB,KAAK,mBAAmB,UAAU1N,EAAGC,EAAGW,CAAK,CAEjD,CAEO,gBAAgBZ,EAAWC,EAAWW,EAAqB,CAChE,KAAK,mBAAmB,SAASZ,EAAGC,EAAGW,CAAK,CAC9C,CAEQ,oBAA2B,CAC7B,KAAK,sBAAwB,KAAK,yBACpC,KAAK,qBAAuB,EAE5B,KAAK,uBAAyB,KAAK,IACjC,GACA,KAAK,uBAAyBsL,EAAA,EAEhC,KAAK,oBAAA,EAET,CAEO,OAAQ,CACb,KAAK,SAAW,GAChB,KAAK,QAAQ,MAAA,CACf,CAEO,QAAS,CACd,KAAK,SAAW,GAChB,KAAK,QAAQ,OAAA,CACf,CAEQ,qBAA4B,CAC9B,KAAK,YAAc,KAAK,UAAU,cACtC,KAAK,cAAc,QAAQjD,EAAY,QAAQ,EAC/C,KAAK,MAAA,EAEL,KAAK,UAAU,KAAM4B,GAAyB,CAC5C,KAAK,sBAAsBA,CAAM,EACjC,KAAK,OAAA,CACP,CAAC,EACH,CAEQ,sBAAsBA,EAA4B,CACxD,GAAIA,EAAO,OAAS,SAAU,CAC5B,MAAMvI,EAAauI,EAAO,KAEpBhD,EAAc,KAAK,eAAe,cAAcvF,EAAW,EAAE,EACnE,GAAI,CAACuF,EACH,OAIG,KAAK,eAAe,UAAUA,CAAW,EAM7B,KAAK,eAAe,UAAUA,CAAW,GAChD,QAAA,GANR,KAAK,eAAe,UAAUA,CAAW,EAEzCzP,EAAY,SAAA,EAAW,UAAUkK,EAAW,EAAE,GAOhD,MACF,CAEA,GAAIuI,EAAO,OAAS,SAAU,CAE5B,MAAM8C,EAAS9C,EAAO,KAEhB1B,EACJwE,EAAO,KAAO,WACV,KAAK,IACH,KAAK,OAAO,UACZ,KAAK,OAAO,OAAS,KAAK,OAAO,UAAYA,EAAO,OAAO,KAAA,EAE7DA,EAAO,OAAO,MAEpB,KAAK,OAAO,QAAQA,EAAO,OAAO,KAAMxE,EAAQ,KAAK,OAAO,SAAS,CACvE,CACF,CAEO,iBAAwB,CAC7B,GAAI,KAAK,WACP,OAGF,MAAMrB,EAAU,KAAK,eAAe,kBAAA,GAAuB,CAAA,EAE3D,GAAIA,EAAQ,SAAW,EACrB,OAGF,KAAK,cAAc,QAAQmB,EAAY,QAAQ,EAC/C,KAAK,MAAA,EACL,MAAM2E,EAAa/N,EAAa,UAAA,EAC1BgO,EAAYhO,EAAa,UAAA,EACzBiO,EAAWjO,EAAa,UAAA,EAGxBsK,EAAU,KAAK,QAAQ,KAAK,MAAQ,EACpCC,EAAU,KAAK,QAAQ,KAAK,OAAS,EAGrC2D,EAAU,KAAK,IAClB,UACC5D,EACAC,EACA,KAAK,QAAQ,KAAK,MAClB,KAAK,QAAQ,KAAK,OAClB,EACA,EAAA,EAED,gBAAgB,CAAC,EACjB,SAASwD,CAAU,EAGhBvD,EAAQ,KAAK,IAChB,KACCF,EACAC,EAAUvK,EAAa,aAAa,GAAG,EACvC5M,EAAK,EAAE,cAAc,EACrB,CACE,SAAU4M,EAAa,aAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,OACX,OAAQ,UACR,gBAAiB,CAAA,CACnB,EAED,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASgO,CAAS,EAGfG,EAA2B,CAAA,EAE3BC,EAAgBpD,GAA0B,CAC9C,KAAK,cAAcA,CAAM,EAEzBkD,EAAQ,QAAA,EACR1D,EAAM,QAAA,EACN2D,EAAQ,QAASE,GAAQ,CACvBA,EAAI,OAAO,QAAA,EACXA,EAAI,SAAS,QAAA,EACbA,EAAI,SAAS,QAAA,CACf,CAAC,CACH,EAEMnD,EAAQ,KAAK,IACjBlL,EAAa,aAAa,GAAG,EAC7B,KAAK,QAAQ,KAAK,MAAQ,EAAA,EAqD5B,GAlDAiI,EAAQ,QAAQ,CAAC+C,EAAQC,IAAU,CACjC,MAAM7K,EACJmK,EACAvK,EAAa,aAAa,EAAE,EAC5BiL,EAAQjL,EAAa,aAAa,GAAG,EAEjCsO,EAAS,KAAK,IACjB,UAAUhE,EAASlK,EAAG8K,EAAOlL,EAAa,aAAa,EAAE,EAAG,OAAQ,EACpE,eAAe,EAAG,QAAQ,EAC1B,eAAe,CAAE,cAAe,EAAA,CAAM,EACtC,gBAAgB,CAAC,EACjB,SAASgO,CAAS,EAEfvC,EAAW,KAAK,IACnB,KAAKnB,EAASlK,EAAIJ,EAAa,aAAa,EAAE,EAAGgL,EAAO,KAAM,CAC7D,SAAUhL,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,UAAW,MAAA,CACZ,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASiO,CAAQ,EAEdvC,EAAW,KAAK,IACnB,KAAKpB,EAASlK,EAAIJ,EAAa,aAAa,EAAE,EAAGgL,EAAO,YAAa,CACpE,SAAUhL,EAAa,YAAA,EACvB,WAAYA,EAAa,eAAA,EACzB,MAAO,UACP,SAAU,CAAE,MAAOkL,EAAQ,EAAA,CAAG,CAC/B,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAAS+C,CAAQ,EAEpBK,EAAO,GAAG,cAAe,IAAM,CAC7BA,EAAO,aAAa,OAAQ,CAC9B,CAAC,EAEDA,EAAO,GAAG,aAAc,IAAM,CAC5BA,EAAO,aAAa,OAAQ,CAC9B,CAAC,EAEDA,EAAO,GAAG,cAAe,IAAM,CAC7BF,EAAapD,CAAM,CACrB,CAAC,EAEDmD,EAAQ,KAAK,CAAE,OAAAG,EAAQ,SAAA7C,EAAU,SAAAC,EAAU,CAC7C,CAAC,EAEGpQ,EAAgB,SAAA,EAAW,iBAAkB,CAC/C,MAAM2P,EAAQ,KAAK,MAAM,KAAK,OAAA,EAAWhD,EAAQ,MAAM,EACvDmG,EAAanG,EAAQgD,CAAK,CAAC,CAC7B,CACF,CAEO,cAAcD,EAA6B,CAC5CA,EAAO,OAAS,WAAaA,EAAO,OACtCA,EAAO,OAAO,QAAA,EACLA,EAAO,OAAS,OAASA,EAAO,aACzC,KAAK,eAAe,UAAUA,EAAO,WAAW,EAGlD,KAAK,OAAA,CACP,CAEQ,UAAU,CAChB,MAAAR,EACA,WAAA+D,EACA,YAAA/C,EACA,WAAAgD,EACA,SAAAC,EACA,OAAAC,EACA,KAAAC,CAAA,EASC,CACD,MAAMC,EAEF,CAAA,EACJ,KAAK,MAAA,EAEL,MAAMtE,EAAU,KAAK,QAAQ,KAAK,MAAQ,EACpCC,EAAU,KAAK,QAAQ,KAAK,OAAS,EAErCwD,EAAa/N,EAAa,UAAA,EAC1BgO,EAAYhO,EAAa,UAAA,EACzBiO,EAAWjO,EAAa,UAAA,EAExBhM,EAAY,KAAK,IACpB,UACCsW,EACAC,EACA,KAAK,QAAQ,KAAK,MAClB,KAAK,QAAQ,KAAK,OAClB,EACA,EAAA,EAED,gBAAgB,CAAC,EACjB,SAASwD,CAAU,EAEtBa,EAAO,KAAK5a,CAAS,EAErB,MAAM6a,EAAY,KAAK,IACpB,KAAKvE,EAASC,EAAUvK,EAAa,aAAa,GAAG,EAAGwK,EAAO,CAC9D,SAAUxK,EAAa,aAAA,EACvB,MAAOuO,EACP,UAAW,OACX,OAAQ,UACR,gBAAiB,EACjB,WAAYvO,EAAa,eAAA,CAAe,CACzC,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASgO,CAAS,EAIrB,GAFAY,EAAO,KAAKC,CAAS,EAEjBrD,EAAa,CACf,MAAME,EAAW,KAAK,IACnB,KAAKpB,EAASC,EAASiB,EAAa,CACnC,SAAUxL,EAAa,YAAA,EACvB,MAAO,UACP,MAAO,SACP,OAAQ,UACR,gBAAiB,EACjB,WAAYA,EAAa,eAAA,CAAe,CACzC,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASgO,CAAS,EACrBY,EAAO,KAAKlD,CAAQ,CACtB,CAEA,MAAMoD,EAAW9O,EAAa,aAAa,GAAG,EAExC+O,EAAW,KAAK,IACnB,UACCzE,EAAUtK,EAAa,aAAa,GAAG,EACvCuK,EAAUuE,EACV9O,EAAa,aAAa,GAAG,EAC7BA,EAAa,aAAa,EAAE,EAC5B,OAAA,EAED,eAAe,EAAG,QAAQ,EAC1B,eAAe,CAAE,cAAe,EAAA,CAAM,EACtC,gBAAgB,CAAC,EACjB,SAASgO,CAAS,EAErBY,EAAO,KAAKG,CAAQ,EAEpB,MAAMC,EAAWhP,EAAa,aAAa,GAAG,EAExCiP,GAAQ,KAAK,IAChB,KAAK3E,EAAU0E,EAAUzE,EAAUuE,EAAUJ,EAAQ,CACpD,SAAU1O,EAAa,YAAA,EACvB,MAAO,UACP,UAAW,OACX,WAAYA,EAAa,eAAA,CAAe,CACzC,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASiO,CAAQ,EAEpBW,EAAO,KAAKK,EAAK,EAEjBF,EAAS,GAAG,cAAe,IAAM,CAC/BA,EAAS,aAAa,OAAQ,CAChC,CAAC,EAEDA,EAAS,GAAG,aAAc,IAAM,CAC9BA,EAAS,aAAa,OAAQ,CAChC,CAAC,EAEDA,EAAS,GAAG,cAAe,IAAM,CAC/BJ,EAAA,CACF,CAAC,EAED,MAAMO,EAAe,KAAK,IACvB,UACC5E,EAAU0E,EACVzE,EAAUuE,EACV9O,EAAa,aAAa,GAAG,EAC7BA,EAAa,aAAa,EAAE,EAC5B,OAAA,EAED,eAAe,EAAG,QAAQ,EAC1B,eAAe,CAAE,cAAe,EAAA,CAAM,EACtC,gBAAgB,CAAC,EACjB,SAASgO,CAAS,EAErBY,EAAO,KAAKM,CAAY,EAExB,MAAMC,GAAgB,KAAK,IACxB,KAAK7E,EAAU0E,EAAUzE,EAAUuE,EAAUN,EAAY,CACxD,SAAUxO,EAAa,YAAA,EACvB,MAAO,UACP,UAAW,OACX,WAAYA,EAAa,eAAA,CAAe,CACzC,EACA,UAAU,EAAG,EACb,gBAAgB,CAAC,EACjB,SAASiO,CAAQ,EAEpB,OAAAW,EAAO,KAAKO,EAAa,EAEzBD,EAAa,GAAG,cAAe,IAAM,CACnCA,EAAa,aAAa,OAAQ,CACpC,CAAC,EAEDA,EAAa,GAAG,aAAc,IAAM,CAClCA,EAAa,aAAa,OAAQ,CACpC,CAAC,EAEDA,EAAa,GAAG,cAAe,IAAM,CACnCN,EAAO,QAASpZ,GAAS,CACvBA,EAAK,QAAA,CACP,CAAC,EACDiZ,EAAA,CACF,CAAC,EAEMG,CACT,CAEQ,gBAAiB,CACvB,MAAO,GAAGxb,EAAK,EAAE,oBAAoB,CAAC,KAAK,KAAK,aAAa;AAAA,EAAKA,EAAK,EACrE,aAAA,CACD,KAAK,KAAK,SAAS;AAAA,EAAKA,EAAK,EAAE,aAAa,CAAC,KAAK,KAAK,OAAO,KAAK;AAAA,EAAKA,EAAK,EAAE,YAAY,CAAC,KAAKyE,EAAa,SAAA,EAAW,SAAS,EACrI,CAEA,MAAa,aAA6B,CACxC,GAAI,KAAK,WAAY,OACrB,KAAK,WAAa,GAElB,KAAK,cAAc,QAAQuR,EAAY,aAAa,EAGpD,MAAM,KAAK,mBAAmB,gBAAA,EAG9BvR,EAAa,SAAA,EAAW,SAAS,KAAK,SAAS,EAC/CA,EAAa,SAAA,EAAW,eAAe,KAAK,aAAa,EAGzD,MAAMkB,EAAcR,EAAY,SAAA,EAAW,aAAA,EAC3CV,EAAa,WAAW,gBAAgB,CAACkB,EAAY,EAAE,CAAC,EAExD,KAAK,UAAU,CACb,MAAO3F,EAAK,EAAE,sBAAsB,EACpC,WAAY,UACZ,YAAa,KAAK,eAAA,EAClB,WAAYA,EAAK,EAAE,iBAAiB,EACpC,SAAU,IAAM,CACd,KAAK,cAAc,UAAA,EACnBwZ,EAAS,KAAKrV,EAAU,YAAY,CACtC,EACA,OAAQnE,EAAK,EAAE,cAAc,EAC7B,KAAM,IAAM,CACV,KAAK,WAAa,GAClB,KAAK,cAAc,UAAA,EACnB,KAAK,MAAM,QAAA,CACb,CAAA,CACD,CACH,CAEO,UAAiB,CAClB,KAAK,aACT,KAAK,WAAa,GAElB,KAAK,cAAc,QAAQgW,EAAY,YAAY,EAGnDvR,EAAa,SAAA,EAAW,SAAS,KAAK,SAAS,EAC/CA,EAAa,SAAA,EAAW,eAAe,KAAK,aAAa,EAEzD,KAAK,UAAU,CACb,MAAOzE,EAAK,EAAE,eAAe,EAC7B,WAAY,UACZ,YAAa,KAAK,eAAA,EAClB,WAAYA,EAAK,EAAE,iBAAiB,EACpC,SAAU,IAAM,CACd,KAAK,cAAc,UAAA,EACnBwZ,EAAS,KAAKrV,EAAU,YAAY,CACtC,EACA,OAAQnE,EAAK,EAAE,cAAc,EAC7B,KAAM,IAAM,CACV,KAAK,cAAc,UAAA,EAEnB,KAAK,MAAM,QAAA,CACb,CAAA,CACD,EACH,CACF,CCtnCA,MAAMgc,GAAaC,IAC4B,CAC3C,MAAO,OAAO,WACd,OAAQ,OAAO,YACf,KAAM3T,EAAO,KACb,OAAA2T,EACA,QAAS,CACP,QAAS,SACT,OAAQ,CACN,QAAS,CAAE,EAAG,EAAG,EAAG,CAAA,EACpB,MAAO3X,EAAA,CACT,EAEF,MAAO,CAAC4U,EAAS,EACjB,MAAO,CACL,KAAM5Q,EAAO,MAAM,OACnB,WAAYA,EAAO,MAAM,YACzB,MAAO,OACP,OAAQ,MAAA,EAEV,OAAQ,CACN,SAAU,GACV,UAAW,EAAA,CACb,GAME4T,GAA0C,CAAC,CAAE,OAAAtR,KAAa,CAC9D,MAAMuR,EAAUC,EAAAA,OAA2B,IAAI,EACzCC,EAAeD,EAAAA,OAAuB,IAAI,EAC1C,CAACE,EAAWC,CAAY,EAAI1Q,EAAAA,SAAS,EAAI,EAE/C2Q,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAI,GAACH,EAAa,SAAWF,EAAQ,SAErC,OAAAA,EAAQ,QAAU,IAAI7T,EAAO,KAAK0T,GAAUK,EAAa,OAAO,CAAC,EAE1D,IAAM,CACPF,EAAQ,UACVA,EAAQ,QAAQ,QAAQ,EAAI,EAC5BA,EAAQ,QAAU,KAEtB,CACF,EAAG,CAAA,CAAE,EAELK,EAAAA,UAAU,IAAM,CACdxD,EAAS,GAAG7U,EAAU,aAAcyG,CAAM,EAC1C,MAAM6R,EAAwB,IAAM,CAClCF,EAAa,EAAK,CACpB,EAEA,SAASG,EAAcC,EAAsB,CAC3C,OAAIA,EAAM,MAAQ,UAChB3D,EAAS,KAAK7U,EAAU,mBAAmB,EAGtC,EACT,CAEA,cAAO,iBAAiB,UAAWuY,CAAa,EAChD1D,EAAS,GAAG7U,EAAU,iBAAkBsY,CAAqB,EAEtD,IAAM,CACX,OAAO,oBAAoB,UAAWC,CAAa,EACnD1D,EAAS,IAAI7U,EAAU,aAAcyG,CAAM,EAC3CoO,EAAS,IAAI7U,EAAU,iBAAkBsY,CAAqB,CAChE,CACF,EAAG,CAAA,CAAE,EAGHvR,EAAAA,KAAA0R,WAAA,CACE,SAAA,CAAA/c,EAAAA,IAAC,MAAA,CACC,UAAWC,GAAO,cAClB,IAAKuc,EACL,cAAY,gBAAA,CAAA,EAEbC,GACCzc,EAAAA,IAAC,MAAA,CAAI,UAAWC,GAAO,eAAgB,cAAY,kBACjD,SAAAD,EAAAA,IAAC,MAAA,CACC,UAAWC,GAAO,eAClB,cAAY,iBAAA,CAAA,CACb,CACH,CAAA,EAEJ,CAEJ,EC1Fa+c,GAAO,CAAC,CAAE,aAAAC,KAA8B,CACnD,KAAM,CAACrd,CAAC,EAAIC,EAAA,EAENqd,EAAkB,IAAM,CACxB9b,GAAaxB,EAAE,yBAAyB,CAAC,IAC3CgF,EAAa,SAAA,EAAW,SAAA,EACxB,OAAO,SAAS,OAAA,EAEpB,EAEA,OACEyG,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,MAAC,KAAA,CAAG,cAAY,aAAc,SAAAJ,EAAE,YAAY,EAAE,EAC9CI,EAAAA,IAAC,SAAA,CACC,UAAU,gBACV,QAAS,IAAMid,EAAa,iBAAiB,EAC7C,cAAY,eAEX,WAAE,YAAY,CAAA,CAAA,EAEjBjd,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS,IAAM,CACbid,EAAa,MAAM,CACrB,EACA,cAAY,cAEX,WAAE,YAAY,CAAA,CAAA,EAGjBjd,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS,IAAM,CACbid,EAAa,OAAO,CACtB,EACA,cAAY,eAEX,WAAE,aAAa,CAAA,CAAA,EAGlBjd,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS,IAAM,CACbid,EAAa,UAAU,CACzB,EACA,cAAY,kBAEX,WAAE,gBAAgB,CAAA,CAAA,EAGrBjd,EAAAA,IAAC,SAAA,CACC,UAAU,aACV,QAAS,IAAM,CACbid,EAAa,MAAM,CACrB,EACA,cAAY,cAEX,WAAE,YAAY,CAAA,CAAA,EAGjBjd,EAAAA,IAAC,SAAA,CACC,UAAU,cACV,QAASkd,EACT,cAAY,oBAEX,WAAE,gBAAgB,CAAA,CAAA,CACrB,EACF,CAEJ,qHChEaC,GAAW,CAAC,CAAE,OAAApS,KAAqC,CAC9D,KAAM,CAACnL,CAAC,EAAIC,EAAA,EACNud,EAAmBnU,GAAA,EACnBoU,EAAkBnU,GAAA,EAClBoN,EAAenN,GAAA,EACfoN,EAAcnN,GAAA,EACdb,EAAW,KAAK,MAAMc,GAAA,EAAgB,EAAE,EACxCiU,EAAmBhU,GAAA,EACzB,OACE+B,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,EAAAA,IAAC,SAAA,CACC,UAAW,0BAA0BC,EAAO,WAAW,GACvD,QAAS8K,EACT,cAAY,sBACb,SAAA,GAAA,CAAA,QAGA,KAAA,CAAG,cAAY,aAAc,SAAAnL,EAAE,gBAAgB,EAAE,EAClDyL,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,MAAC,QAAA,CAAM,QAAQ,kBAAmB,SAAAJ,EAAE,yBAAyB,EAAE,QAC9DD,GAAA,CAAA,CAAe,CAAA,EAClB,EACA0L,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,MAAC,QAAA,CAAM,QAAQ,cAAe,SAAAJ,EAAE,qBAAqB,EAAE,EACvDI,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,GAAG,cACH,KAAK,cACL,QAASod,EACT,SAAWld,GACTmI,EACG,SAAA,EACA,qBAAqB,EAAQnI,EAAE,OAAO,OAAQ,CAAA,CAAA,CAErD,EACF,EACAmL,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,MAAC,QAAA,CAAM,QAAQ,aAAc,SAAAJ,EAAE,oBAAoB,EAAE,EACrDI,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,GAAG,aACH,KAAK,aACL,QAASqd,EACT,SAAWnd,GACTmI,EACG,SAAA,EACA,oBAAoB,EAAQnI,EAAE,OAAO,OAAQ,CAAA,CAAA,CAEpD,EACF,EACAmL,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,MAAC,QAAA,CAAM,QAAQ,cAAe,SAAAJ,EAAE,2BAA2B,EAAE,EAC7DI,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,GAAG,cACH,KAAK,cACL,QAASsd,EACT,SAAWpd,GAAM,CACf,MAAMyB,EAAS,EAAQzB,EAAE,OAAO,QAChCmI,EAAgB,SAAA,EAAW,qBAAqB1G,CAAM,EACtDD,GAAiBC,CAAM,CACzB,CAAA,CAAA,CACF,EACF,EACA0J,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,EAAAA,IAAC,QAAA,CAAM,QAAQ,YACZ,SAAAJ,EAAE,oBAAqB,CAAE,MAAO2I,CAAA,CAAU,CAAA,CAC7C,EACAvI,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,GAAG,YACH,KAAK,YACL,IAAI,IACJ,IAAI,MACJ,MAAOuI,EACP,KAAK,IACL,SAAWrI,GAAM,CACf,MAAM4N,EAAQ,OAAO5N,EAAE,OAAO,KAAK,EAAI,GACvCmI,EAAgB,SAAA,EAAW,YAAYyF,CAAK,CAC9C,CAAA,CAAA,CACF,EACF,EACAzC,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,MAAC,QAAA,CAAM,QAAQ,eAAgB,SAAAJ,EAAE,sBAAsB,EAAE,EACzDI,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,GAAG,eACH,KAAK,eACL,QAASsW,EACT,SAAWpW,GACTmI,EACG,SAAA,EACA,gBAAgB,EAAQnI,EAAE,OAAO,OAAQ,CAAA,CAAA,CAEhD,EACF,EACAmL,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAD,EAAAA,IAAC,QAAA,CAAM,QAAQ,eAAgB,SAAA,GAAGJ,EAAE,sBAAsB,CAAC,KAAK2W,CAAW,EAAA,CAAG,EAC9EvW,EAAAA,IAAC,QAAA,CACC,KAAK,QACL,GAAG,eACH,KAAK,eACL,IAAI,IACJ,IAAI,IACJ,MAAOuW,EACP,KAAK,OACL,SAAWrW,GAAM,CACf,MAAM4N,EAAQ,OAAO5N,EAAE,OAAO,KAAK,EACnCmI,EAAgB,SAAA,EAAW,eAAeyF,CAAK,CACjD,CAAA,CAAA,CACF,EACF,EACA9N,EAAAA,IAAC,SAAA,CACC,UAAW,eAAeC,EAAO,WAAW,GAC5C,QAAS,IAAM,CACTmB,GAAaxB,EAAE,uBAAuB,CAAC,GACzCyI,EAAgB,SAAA,EAAW,SAAA,CAE/B,EACA,cAAY,uBAEX,WAAE,uBAAuB,CAAA,CAAA,CAC5B,EACF,CAEJ,uJC5HMkV,GAAc,OAAO,KAAK9e,CAAe,EAEzC+e,GAA0C,CAAC,CAAE,OAAAzS,KAAa,CAC9D,KAAM,CAACnL,CAAC,EAAIC,EAAA,EACNmL,EAAqB1E,GAAA,EACrBzB,EAAoBqD,GAAA,EACpB+D,EAAYnE,GAAA,EACZ2V,EAAa1V,GAAA,EACb2V,EAAmB1V,GAAA,EACnB2V,EAAgB1V,GAAA,EAEtB,OACEoD,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,EAAAA,IAAC,SAAA,CACC,UAAW,0BAA0BC,EAAO,WAAW,GACvD,QAAS8K,EACT,cAAY,sBACb,SAAA,GAAA,CAAA,QAGA,KAAA,CAAG,cAAY,aAAc,SAAAnL,EAAE,aAAa,EAAE,EAC/CyL,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UAAW,SAAA,CAAA,MAAIL,EAAE,YAAY,EAAE,GAAA,EAAC,EACxDI,EAAAA,IAAC,OAAA,CAAK,UAAWC,EAAO,UAAY,SAAAgM,CAAA,CAAU,CAAA,EAChD,EACAZ,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KAErB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UAAW,SAAA,CAAA,MAAIL,EAAE,kBAAkB,EAAE,GAAA,EAAC,EAC9DI,EAAAA,IAAC,OAAA,CAAK,UAAWC,EAAO,UAAY,SAAAwd,CAAA,CAAW,CAAA,EACjD,EACApS,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KAErB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UAAW,SAAA,CAAA,MAAIL,EAAE,oBAAoB,EAAE,GAAA,EAAC,QAC/D,OAAA,CAAK,UAAWK,EAAO,UAAY,SAAA2B,GAAW8b,CAAgB,CAAA,CAAE,CAAA,EACnE,EACArS,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UAAW,SAAA,CAAA,MAAIL,EAAE,qBAAqB,EAAE,GAAA,EAAC,QAChE,OAAA,CAAK,UAAWK,EAAO,UAAY,SAAA2B,GAAW+b,CAAa,CAAA,CAAE,CAAA,EAChE,EACAtS,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UACrB,SAAA,CAAAL,EAAE,4BAA4B,EAAE,GAAA,EACnC,EACAyL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UACrB,SAAA,CAAA+K,EAAmB,OAAO,IAAEuS,GAAY,MAAA,CAAA,CAC3C,CAAA,EACF,EACAlS,EAAAA,KAAC,MAAA,CAAI,UAAWpL,EAAO,KACrB,SAAA,CAAAoL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UAAY,SAAA,CAAAL,EAAE,uBAAuB,EAAE,GAAA,EAAC,EAChEyL,EAAAA,KAAC,OAAA,CAAK,UAAWpL,EAAO,UACrB,SAAA,CAAA4E,EAAkB,OAAO,IAAEb,EAAK,MAAA,CAAA,CACnC,CAAA,CAAA,CACF,CAAA,EACF,CAEJ,EAEA4Z,GAAerd,GAAM,KAAKid,EAAK,uKC9DzBK,GAAa,OAAO,OAAOpf,CAAe,EAC1Cqf,GAAU,OAAO,OAAOjf,CAAO,EAC/Bkf,GAAU,OAAO,OAAOjf,EAAO,EAC/B6Q,GAAU,OAAO,OAAOhR,CAAY,EAEpCqf,GAAO,CAAC,CAAE,OAAAjT,KAAqC,CACnD,KAAM,CAACnL,CAAC,EAAIC,EAAA,EACZ,OACEwL,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAArL,EAAAA,IAAC,SAAA,CACC,UAAW,0BAA0BC,EAAO,WAAW,GACvD,QAAS8K,EACT,cAAY,sBACb,SAAA,GAAA,CAAA,QAGA,KAAA,CAAG,cAAY,aAAc,SAAAnL,EAAE,YAAY,EAAE,SAE7C,UAAA,CAAQ,UAAWK,EAAO,QAAS,cAAY,oBAC9C,SAAA,CAAAD,MAAC,WAAQ,UAAWC,EAAO,MAAQ,SAAAL,EAAE,YAAY,EAAE,EAClDoE,EAAK,IAAKia,UACR,MAAA,CAAe,UAAWhe,EAAO,KAChC,SAAA,CAAAD,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,MAAQ,WAAE,QAAQge,EAAE,EAAE,OAAO,CAAA,CAAE,EACtDje,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,KAAO,WAAE,QAAQge,EAAE,EAAE,cAAc,CAAA,CAAE,CAAA,CAAA,EAFpDA,EAAE,EAGZ,CACD,CAAA,EACH,SAEC,UAAA,CAAQ,UAAWhe,EAAO,QAAS,cAAY,0BAC9C,SAAA,CAAAD,MAAC,WAAQ,UAAWC,EAAO,MAAQ,SAAAL,EAAE,kBAAkB,EAAE,EACxDie,GAAW,IAAKI,UACd,MAAA,CAAe,UAAWhe,EAAO,KAChC,SAAA,CAAAD,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,MAAQ,WAAE,cAAcge,EAAE,EAAE,OAAO,CAAA,CAAE,EAC5Dje,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,KACpB,WAAE,cAAcge,EAAE,EAAE,cAAc,CAAA,CACrC,CAAA,CAAA,EAJQA,EAAE,EAKZ,CACD,CAAA,EACH,SAEC,UAAA,CAAQ,UAAWhe,EAAO,QAAS,cAAY,uBAC9C,SAAA,CAAAD,MAAC,WAAQ,UAAWC,EAAO,MAAQ,SAAAL,EAAE,eAAe,EAAE,EACrDke,GAAQ,IAAKG,UACX,MAAA,CAAe,UAAWhe,EAAO,KAChC,SAAA,CAAAD,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,MAAQ,WAAE,WAAWge,EAAE,EAAE,OAAO,CAAA,CAAE,EACzDje,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,KACpB,WAAE,WAAWge,EAAE,EAAE,cAAc,CAAA,CAClC,CAAA,CAAA,EAJQA,EAAE,EAKZ,CACD,CAAA,EACH,SAEC,UAAA,CAAQ,UAAWhe,EAAO,QAAS,cAAY,uBAC9C,SAAA,CAAAD,MAAC,WAAQ,UAAWC,EAAO,MAAQ,SAAAL,EAAE,eAAe,EAAE,EACrDme,GAAQ,IAAKE,UACX,MAAA,CAAe,UAAWhe,EAAO,KAChC,SAAA,CAAAD,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,MAAQ,WAAE,WAAWge,EAAE,EAAE,OAAO,CAAA,CAAE,EACzDje,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,KACpB,WAAE,WAAWge,EAAE,EAAE,cAAc,CAAA,CAClC,CAAA,CAAA,EAJQA,EAAE,EAKZ,CACD,CAAA,EACH,SAEC,UAAA,CAAQ,UAAWhe,EAAO,QAAS,cAAY,uBAC9C,SAAA,CAAAD,MAAC,WAAQ,UAAWC,EAAO,MAAQ,SAAAL,EAAE,eAAe,EAAE,EACrD+P,GAAQ,IAAKsO,SACX,MAAA,CAAe,UAAWhe,EAAO,KAChC,SAAAD,EAAAA,IAAC,MAAA,CAAI,UAAWC,EAAO,MAAQ,SAAAL,EAAE,WAAWqe,EAAE,EAAE,EAAE,CAAA,CAAE,GAD5CA,EAAE,EAEZ,CACD,CAAA,CAAA,CACH,CAAA,EACF,CAEJ,ECvEMC,GAAgB,IAAM,CAC1B,KAAM,CAACC,EAAeC,CAAgB,EAAIpS,EAAAA,SAAiB,MAAM,EACjE2Q,EAAAA,UAAU,IAAM,CACdrX,EAAY,SAAA,EAAW,aAAA,CACzB,EAAG,CAAC6Y,CAAa,CAAC,EAElB,MAAME,EAAaC,EAAAA,YAAY,IAAM,CACnCF,EAAiB,MAAM,CACzB,EAAG,CAAA,CAAE,EAECG,EAAaD,EAAAA,YAAY,IAAM,CACnCF,EAAiB,MAAM,CACzB,EAAG,CAAA,CAAE,EAECI,EAAYF,EAAAA,YAAY,IAAM,CAClCF,EAAiB,WAAW,CAC9B,EAAG,CAAA,CAAE,EAECK,EAAkBH,EAAAA,YAAY,IAAM,CACxCF,EAAiB,iBAAiB,CACpC,EAAG,CAAA,CAAE,EAECM,EAAmB,CACvB,UAAW1e,EAAAA,IAACyL,GAAA,CAAU,UAAW4S,EAAY,OAAQI,EAAiB,EACtE,KAAMze,EAAAA,IAAC8L,GAAA,CAAK,OAAQyS,CAAA,CAAY,EAChC,KAAMve,EAAAA,IAAC2e,GAAA,CAAK,OAAQJ,CAAA,CAAY,EAChC,gBACEve,EAAAA,IAAC6K,GAAA,CAAgB,UAAW2T,EAAW,OAAQD,EAAY,EAE7D,SAAUve,EAAAA,IAACmd,GAAA,CAAS,OAAQoB,CAAA,CAAY,EACxC,MAAOve,EAAAA,IAACwd,GAAA,CAAM,OAAQe,CAAA,CAAY,EAClC,KAAMve,EAAAA,IAACge,GAAA,CAAK,OAAQO,CAAA,CAAY,EAChC,KAAMve,EAAAA,IAACgd,GAAA,CAAK,aAAcoB,CAAA,CAAkB,CAAA,EAG9C,OAAOM,EAAiBP,CAAa,GAAKO,EAAiB,IAC7D,ECxCA,eAAeE,IAAO,CACpB,MAAMze,EAAK,eAAA,EACXkI,EAAgB,SAAA,EAAW,qBAAqB5G,GAAA,CAAc,EACjDR,GAAAA,WAAW,SAAS,eAAe,MAAM,CAAE,EACnD,OAAOjB,EAAAA,IAACke,GAAA,CAAA,CAAI,CAAE,CACrB,CAEAU,GAAA"}